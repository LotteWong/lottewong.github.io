<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LotteWong</title>
  
  <subtitle>åœ¨ä»£ç ç¬¦å·è¡¨è±¡ä¸­é¿éš¾ã€‚</subtitle>
  <link href="http://yoursite.com/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2022-02-07T14:45:44.179Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>LotteWong</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>#Issue# è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢tricks</title>
    <link href="http://yoursite.com/2022/01/30/%E8%81%94%E8%A1%A8%E5%A4%9A%E5%AD%97%E6%AE%B5%E7%9A%84%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2tricks/"/>
    <id>http://yoursite.com/2022/01/30/%E8%81%94%E8%A1%A8%E5%A4%9A%E5%AD%97%E6%AE%B5%E7%9A%84%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2tricks/</id>
    <published>2022-01-29T23:00:21.000Z</published>
    <updated>2022-02-07T14:45:44.179Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®¨è®º<strong>è”è¡¨å¤šå­—æ®µæ¨¡ç³ŠæŸ¥è¯¢çš„å¯èƒ½æ€§</strong>ï¼Œåˆ†ä¸ºä¸¤ç§æ€è·¯ï¼š</p><ol><li>äº¤ç»™ <code>dao layer</code> å¤„ç†</li><li>äº¤ç»™ <code>service layer</code> å¤„ç†</li></ol><hr><a id="more"></a><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a><strong>éœ€æ±‚</strong></h1><blockquote><p>ä»Šå¤©è®¨è®ºä¸€ä¸‹çœ‹ä¼¼ç®€å•å®åˆ™ç¹ççš„å°éœ€æ±‚â€”â€”<strong>è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢</strong>ã€‚ä¸¾ä¸ªğŸŒ°ï¼šç°åœ¨æˆ‘è¦å¯¹<strong>è¶…çº§ç®¡ç†å‘˜</strong>åˆ—è¡¨è¿›è¡Œ<strong>åå­—æˆ–æè¿°</strong>çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ€ä¹ˆå®ç°ï¼Ÿè¿™é‡Œé˜»ç¢æˆ‘ä»¬çŸ­å¹³å¿«åœ°å®ç°åŠŸèƒ½çš„ç‚¹åœ¨äºï¼Œè¶…çº§ç®¡ç†å‘˜æ¶‰åŠä¸‰ä¸ªè¡¨ï¼ˆç”¨æˆ·è¡¨ã€è§’è‰²è¡¨ã€ç”¨æˆ·-è§’è‰²è¡¨ï¼‰ï¼Œæ¯ä¸ªè¡¨è¿˜å¯èƒ½å¯¹å¤šå­—æ®µè¿›è¡Œç²¾ç¡®æˆ–æ¨¡ç³ŠåŒ¹é…ï¼Œå¦‚æœä¸å…ˆæƒ³æ¸…æ¥šå°±å¼€å§‹åŠ¨å·¥ï¼Œéå¸¸å®¹æ˜“å‡ºç°<strong>åŠŸèƒ½ç¼ºé™·</strong>å’Œ<strong>æ€§èƒ½ç“¶é¢ˆ</strong>ğŸ¤¦â€ã€‚</p></blockquote><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a><strong>å®ç°</strong></h1><h2 id="äº¤ç»™-dao-layer-å¤„ç†"><a href="#äº¤ç»™-dao-layer-å¤„ç†" class="headerlink" title="äº¤ç»™ dao layer å¤„ç†"></a>äº¤ç»™ <code>dao layer</code> å¤„ç†</h2><h3 id="MySQL-Rational"><a href="#MySQL-Rational" class="headerlink" title="MySQL (Rational)"></a>MySQL (<u>Rational</u>)</h3><h4 id="è”è¡¨æŸ¥è¯¢"><a href="#è”è¡¨æŸ¥è¯¢" class="headerlink" title="è”è¡¨æŸ¥è¯¢"></a>è”è¡¨æŸ¥è¯¢</h4><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-string">`user_role`</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">`ur`</span> </span><br><span class="line"><span class="hljs-keyword">FULL</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">`users`</span> <span class="hljs-keyword">on</span> ur.user_id = users.user_id</span><br><span class="line"><span class="hljs-keyword">FULL</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">`roles`</span> <span class="hljs-keyword">on</span> ur.role_id = roles.role_id</span><br></pre></td></tr></table></figure><h4 id="æ¨¡ç³ŠæŸ¥è¯¢"><a href="#æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢"></a>æ¨¡ç³ŠæŸ¥è¯¢</h4><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-string">`users`</span> <span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">IFNULL</span>(<span class="hljs-string">`user_name`</span>,<span class="hljs-string">''</span>),<span class="hljs-keyword">IFNULL</span>(<span class="hljs-string">`user_desc`</span>,<span class="hljs-string">''</span>)) <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%keyword%'</span></span><br></pre></td></tr></table></figure><h4 id="è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢"><a href="#è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢"></a>è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢</h4><figure class="highlight sql hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># tipsï¼šæ»¡è¶³å…³ç³»å‹çš„æ•°æ®ä½¿ç”¨è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢å¯åšåˆ° SQL or ORM ä¸€æŠŠæ¢­</span></span><br><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-string">`user_role`</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">`ur`</span> </span><br><span class="line"><span class="hljs-keyword">FULL</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">`users`</span> <span class="hljs-keyword">on</span> ur.user_id = users.user_id</span><br><span class="line"><span class="hljs-keyword">FULL</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">`roles`</span> <span class="hljs-keyword">on</span> ur.role_id = roles.role_id</span><br><span class="line"><span class="hljs-keyword">WHERE</span> role_name=<span class="hljs-keyword">admin</span></span><br><span class="line"><span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">IFNULL</span>(<span class="hljs-string">`user_name`</span>,<span class="hljs-string">''</span>),<span class="hljs-keyword">IFNULL</span>(<span class="hljs-string">`user_desc`</span>,<span class="hljs-string">''</span>)) <span class="hljs-keyword">LIKE</span> â€˜%keyword%â€™</span><br></pre></td></tr></table></figure><h3 id="MongoDB-Irrational"><a href="#MongoDB-Irrational" class="headerlink" title="MongoDB (Irrational)"></a>MongoDB (<u>Irrational</u>)</h3><h4 id="è”è¡¨æŸ¥è¯¢-1"><a href="#è”è¡¨æŸ¥è¯¢-1" class="headerlink" title="è”è¡¨æŸ¥è¯¢"></a>è”è¡¨æŸ¥è¯¢</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">db.users.aggregate(&#123;</span><br><span class="line">    <span class="hljs-string">"$lookup"</span>: &#123;</span><br><span class="line">        <span class="hljs-keyword">from</span>:<span class="hljs-string">'roles'</span>,</span><br><span class="line">        localField: <span class="hljs-string">'role_id'</span>,</span><br><span class="line">        foreignField: <span class="hljs-string">'_id'</span>,</span><br><span class="line">        <span class="hljs-keyword">as</span>: <span class="hljs-string">'user_role'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="æ¨¡ç³ŠæŸ¥è¯¢-1"><a href="#æ¨¡ç³ŠæŸ¥è¯¢-1" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢"></a>æ¨¡ç³ŠæŸ¥è¯¢</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.users.find(&#123;</span><br><span class="line">    <span class="hljs-string">"$or"</span>: [</span><br><span class="line">        <span class="hljs-string">"user_name"</span>: &#123;</span><br><span class="line">    <span class="hljs-string">"$regex"</span>: <span class="hljs-string">"keyword"</span></span><br><span class="line">&#125;,</span><br><span class="line">        <span class="hljs-string">"user_desc"</span>: &#123;</span><br><span class="line">        <span class="hljs-string">"$regex"</span>: <span class="hljs-string">"keyword"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢-1"><a href="#è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢-1" class="headerlink" title="è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢"></a>è”è¡¨å¤šå­—æ®µçš„æ¨¡ç³ŠæŸ¥è¯¢</h4><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// tipsï¼šä¸æ¨èéå…³ç³»å‹ç”¨è”è¡¨æ–¹æ³•å› ä¸ºæ€§èƒ½ååˆ†å ªå¿§ï¼Œæ›´åº”è¯¥å…³æ³¨åˆç†çš„æ•°æ®ç»“æ„è®¾è®¡</span></span><br><span class="line">db.users.aggregate(&#123;</span><br><span class="line">    <span class="hljs-string">"$lookup"</span>: &#123;</span><br><span class="line">        <span class="hljs-keyword">from</span>:<span class="hljs-string">'roles'</span>,</span><br><span class="line">        localField: <span class="hljs-string">'role_id'</span>,</span><br><span class="line">        foreignField: <span class="hljs-string">'_id'</span>,</span><br><span class="line">        <span class="hljs-keyword">as</span>: <span class="hljs-string">'user_role'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"$match"</span>: &#123;</span><br><span class="line">        <span class="hljs-string">"$or"</span>: [</span><br><span class="line">            <span class="hljs-string">"user_name"</span>: &#123;</span><br><span class="line">                <span class="hljs-string">"$regex"</span>: <span class="hljs-string">"keyword"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="hljs-string">"user_desc"</span>: &#123;</span><br><span class="line">                <span class="hljs-string">"$regex"</span>: <span class="hljs-string">"keyword"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;             </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="äº¤ç»™-service-layer-å¤„ç†"><a href="#äº¤ç»™-service-layer-å¤„ç†" class="headerlink" title="äº¤ç»™ service layer å¤„ç†"></a>äº¤ç»™ <code>service layer</code> å¤„ç†</h2><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// æ•°æ®åº“ I/Oï¼š3 times</span></span><br><span class="line"><span class="hljs-comment">// ç©ºé—´å¤æ‚åº¦ï¼šO(k)</span></span><br><span class="line"><span class="hljs-comment">// æ—¶é—´å¤æ‚åº¦ï¼šO(k Ã— f)</span></span><br><span class="line"><span class="hljs-comment">// å…¶ä¸­ï¼Œk ä»£è¡¨æ¨¡ç³Šæœç´¢åçš„è®°å½•æ•°é‡ï¼Œf ä»£è¡¨æ¡ä»¶è¿‡æ»¤åçš„è®°å½•æ•°é‡ï¼Œk å’Œ f åœ¨ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å¾ˆå°çš„</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">FuzzySearch</span><span class="hljs-params">(keyword <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">([]rbac.User, error)</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">var</span> result []rbac.User</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// æ¨¡ç³Šæœç´¢</span></span><br><span class="line">    <span class="hljs-comment">// ç©ºé—´å¤æ‚åº¦â†“ï¼Œæ•°æ®åº“ I/O ++</span></span><br><span class="line">    users, err := rbac.GetUserList(keyword)</span><br><span class="line">    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// æ—¶é—´å¤æ‚åº¦â†‘ï¼ŒO(k)</span></span><br><span class="line">    <span class="hljs-keyword">var</span> userIds []<span class="hljs-keyword">string</span></span><br><span class="line">    <span class="hljs-keyword">for</span> _, user := <span class="hljs-keyword">range</span> users &#123;</span><br><span class="line">        userIds = <span class="hljs-built_in">append</span>(userIds, user.UserId)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ç²¾å‡†åŒ¹é…</span></span><br><span class="line">    <span class="hljs-comment">// ç©ºé—´å¤æ‚åº¦=ï¼Œæ•°æ®åº“ I/O ++</span></span><br><span class="line">    role, err := rbac.GetRoleDetail(RoleNameAdmin)</span><br><span class="line">    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// æ—¶é—´å¤æ‚åº¦â†‘ï¼ŒO(1)</span></span><br><span class="line">    <span class="hljs-keyword">var</span> roleIds []<span class="hljs-keyword">string</span></span><br><span class="line">    roleIds = <span class="hljs-built_in">append</span>(roleIds, role.RoleId)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// æ¡ä»¶è¿‡æ»¤</span></span><br><span class="line">    <span class="hljs-comment">// ç©ºé—´å¤æ‚åº¦â†“ï¼Œæ•°æ®åº“ I/O ++</span></span><br><span class="line">    urs, err := rbac.GetUserRoleList(userIds, roleIds)</span><br><span class="line">    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// æ—¶é—´å¤æ‚åº¦â†‘ï¼ŒO(k Ã— f)</span></span><br><span class="line">    <span class="hljs-keyword">for</span> _, user := <span class="hljs-keyword">range</span> users &#123;</span><br><span class="line">        <span class="hljs-keyword">for</span> _, ur := <span class="hljs-keyword">range</span> urs &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> user.UserId == ur.UserId &#123;</span><br><span class="line">                result = <span class="hljs-built_in">append</span>(result, user)</span><br><span class="line">                <span class="hljs-keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> result, <span class="hljs-literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡è®¨è®º&lt;strong&gt;è”è¡¨å¤šå­—æ®µæ¨¡ç³ŠæŸ¥è¯¢çš„å¯èƒ½æ€§&lt;/strong&gt;ï¼Œåˆ†ä¸ºä¸¤ç§æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;äº¤ç»™ &lt;code&gt;dao layer&lt;/code&gt; å¤„ç†&lt;/li&gt;
&lt;li&gt;äº¤ç»™ &lt;code&gt;service layer&lt;/code&gt; å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Issue" scheme="http://yoursite.com/categories/Issue/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>#Issue# Best Practice on Token-Refresh Implementation</title>
    <link href="http://yoursite.com/2022/01/23/Best%20Practice%20on%20Token-Refresh%20Implementation/"/>
    <id>http://yoursite.com/2022/01/23/Best%20Practice%20on%20Token-Refresh%20Implementation/</id>
    <published>2022-01-22T23:00:21.000Z</published>
    <updated>2022-02-07T10:50:52.903Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®¨è®º<strong>æœåŠ¡ç«¯è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œè¿‡æœŸæ—¶é—´çš„</strong>æœ€ä½³å®è·µã€‚</p><hr><a id="more"></a><h1 id="åœºæ™¯å¼•å…¥"><a href="#åœºæ™¯å¼•å…¥" class="headerlink" title="åœºæ™¯å¼•å…¥"></a><strong>åœºæ™¯å¼•å…¥</strong></h1><blockquote><p>åœ¨ä½¿ç”¨ <code>Token</code> æœºåˆ¶è¿›è¡Œ <code>Auth</code> æ—¶ï¼Œå‡ºäº<strong>å®‰å…¨æ€§çš„è€ƒè™‘</strong>æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°éœ€è¦ä¸ºä»¤ç‰Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œç„¶è€Œå°èœå¦‚æˆ‘å¾€å¾€ä¹Ÿå¿½ç•¥äº†<strong>ä½“éªŒæ€§çš„é—®é¢˜</strong>å³â€œè‡ªåŠ¨å»¶é•¿è¿‡æœŸæ—¶é—´â€ä»¥ä¿æŒæ´»è·ƒç”¨æˆ·åœ¨çº¿ï¼Œå¼•ç”¨ <a href="https://docs.auth0.com/refresh-token" target="_blank" rel="noopener">Auth0</a> çš„ä¸€æ®µè¯æ„ä¼šä¸€å“ˆâ€”â€”</p><p><em>â€œä¸€ä¸ªå¥½çš„æ¨¡å¼æ˜¯åœ¨å®ƒè¿‡æœŸä¹‹å‰åˆ·æ–°ä»¤ç‰Œã€‚å°†ä»¤ç‰Œè¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸€å‘¨ï¼Œå¹¶åœ¨æ¯æ¬¡ç”¨æˆ·æ‰“å¼€Webåº”ç”¨ç¨‹åºå¹¶æ¯éš”ä¸€å°æ—¶åˆ·æ–°ä»¤ç‰Œã€‚å¦‚æœç”¨æˆ·è¶…è¿‡ä¸€å‘¨æ²¡æœ‰æ‰“å¼€è¿‡åº”ç”¨ç¨‹åºï¼Œé‚£ä»–ä»¬å°±éœ€è¦å†æ¬¡ç™»å½•ï¼Œè¿™æ˜¯å¯æ¥å—çš„Webåº”ç”¨ç¨‹åºUX(ç”¨æˆ·ä½“éªŒ)ã€‚è¦åˆ·æ–°ä»¤ç‰Œï¼ŒAPIéœ€è¦ä¸€ä¸ªæ–°çš„ç«¯ç‚¹ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæœ‰æ•ˆçš„ï¼Œæ²¡æœ‰è¿‡æœŸçš„JWTï¼Œå¹¶è¿”å›ä¸æ–°çš„åˆ°æœŸå­—æ®µç›¸åŒçš„ç­¾åçš„JWTã€‚ç„¶åWebåº”ç”¨ç¨‹åºä¼šå°†ä»¤ç‰Œå­˜å‚¨åœ¨æŸå¤„ã€‚â€</em></p><p>æˆ‘ä»¬æŠŠé—®é¢˜æ‹†åˆ†ä¸º<u>ä¸¤ä¸ªç»´åº¦</u>ï¼š</p><ol><li><strong>å•ç‚¹ç™»å½•</strong>ï¼šå•ç‚¹ç™»å½• (Single Sign On, SSO)ï¼Œåœ¨åº”ç”¨åœºæ™¯ä¸Šåˆ†ä¸º<strong>åŒåŸŸå•ç‚¹ç™»å½•</strong>å’Œ<strong>è·¨åŸŸå•ç‚¹ç™»å½•</strong>ï¼Œåœ¨å®ç°æ–¹æ¡ˆä¸Šåˆ†ä¸º <code>OAuth</code> å’Œ <code>CAS</code>ï¼Œetcâ€¦å•ç‚¹ç™»å½•ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„éœ€æ±‚åœºæ™¯ï¼Œä»¥åæœ‰æœºä¼šè€ƒè™‘å¼€ä¸“æ è®¨è®ºä¸‹ä¸ªäººçš„ä¸€äº›æµ…è§ï¼Œç°åœ¨å‡è®¾æˆ‘ä»¬å·²ç»ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œ<strong><code>Token</code> åŠ å¯†å†…å®¹çš„ç”Ÿæˆå’ŒéªŒè¯å°†ä½œä¸ºå…ˆéªŒçŸ¥è¯†ä¸ä¼šåœ¨æœ¬æ–‡ä¸­è¿‡å¤šåœ°è§£é‡Š</strong>ã€‚</li><li><strong>ä»¤ç‰Œåˆ·æ–°</strong>ï¼š<strong>æœ¬æ–‡é‡ç‚¹åœ¨äºæ€è€ƒâ€œå¦‚ä½•ä¼˜é›…åœ°è®¾ç½® <code>Token</code> æœ‰æ•ˆæ—¶é—´â€ã€‚</strong>åœ¨çœŸæ­£åŠ¨æ‰‹å‰éœ€è¦è€ƒé‡å‡ ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”è¦ååˆ†æ³¨æ„å®é™…ç”Ÿäº§ä¸­å®¹æ˜“è¸©åˆ°çš„å‘ï¼Œå›åˆ°ç®—æ³•æœ¬èº«è€Œè¨€å¯»æ±‚ä»é™æ€åˆ°åŠ¨æ€çš„ä¼˜åŒ–ä¸æå‡ã€‚</li></ol></blockquote><h1 id="çµé­‚ä¸‰é—®"><a href="#çµé­‚ä¸‰é—®" class="headerlink" title="çµé­‚ä¸‰é—®"></a><strong>çµé­‚ä¸‰é—®</strong></h1><h2 id="ä¸»ä½“æ˜¯è°ï¼Ÿ"><a href="#ä¸»ä½“æ˜¯è°ï¼Ÿ" class="headerlink" title="ä¸»ä½“æ˜¯è°ï¼Ÿ"></a>ä¸»ä½“æ˜¯è°ï¼Ÿ</h2><blockquote><p>ä»¤ç‰Œåˆ·æ–°çš„ä¸»ä½“ï¼Œå¯ä»¥æ˜¯<u>æœåŠ¡ç«¯</u>ï¼Œå¯ä»¥æ˜¯<u>å®¢æˆ·ç«¯</u>ï¼Œæ€ä¹ˆåšé€‰æ‹©é¢˜â… ï¼Ÿ</p></blockquote><ul><li><strong>æœåŠ¡ç«¯</strong>ï¼šæ§åˆ¶ä»¤ç‰Œä¿¡æ¯æ›´çµæ´»ï¼Œå®ç°è¾ƒç®€å•</li><li><strong>å®¢æˆ·ç«¯</strong>ï¼šæ§åˆ¶äº¤äº’ä½“éªŒæ›´çµæ´»ï¼Œå®ç°è¾ƒç¹ç</li></ul><h2 id="å®¢ä½“æ˜¯è°ï¼Ÿ"><a href="#å®¢ä½“æ˜¯è°ï¼Ÿ" class="headerlink" title="å®¢ä½“æ˜¯è°ï¼Ÿ"></a>å®¢ä½“æ˜¯è°ï¼Ÿ</h2><blockquote><p>ä»¤ç‰Œåˆ·æ–°çš„å®¢ä½“ï¼Œå¯ä»¥æ˜¯<u>åŠ å¯†å†…å®¹</u>ï¼Œå¯ä»¥æ˜¯<u>è¿‡æœŸæ—¶é—´</u>ï¼Œæ€ä¹ˆåšé€‰æ‹©é¢˜â…¡ï¼Ÿ</p></blockquote><ul><li><strong>åŠ å¯†å†…å®¹</strong>ï¼šä¼˜ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨ <code>JWT</code> è€Œæ— éœ€å­˜å‚¨ï¼›ç¼ºç‚¹æ˜¯é¢‘ç¹ç”Ÿæˆæ–°çš„ä»¤ç‰Œæµªè´¹ç©ºé—´ï¼Œç»´æŠ¤å¤šä¸ªä»¤ç‰Œå®¹æ˜“å‡ºç°å®‰å…¨é—®é¢˜å’Œå¹¶å‘é—®é¢˜ï¼Œå¸¸è§è§£å†³æ–¹æ¡ˆæœ‰ <a href="https://www.zhihu.com/question/309815576/answer/579255324" target="_blank" rel="noopener"><code>refresh token</code> æ–¹æ¡ˆ</a>å’Œ <a href="https://www.v2ex.com/t/306017" target="_blank" rel="noopener"><code>middleware</code> æ–¹æ¡ˆ</a>ã€‚</li><li><strong>è¿‡æœŸæ—¶é—´</strong>ï¼šä¼˜ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨ <code>Random Ticket</code> ç±»ä¼¼äºâ€œå•ä¾‹â€è€Œæ²¡æœ‰ç©ºé—´ã€å®‰å…¨ã€å¹¶å‘ç­‰çš„é—®é¢˜ï¼›ç¼ºç‚¹æ˜¯éœ€è¦ç»´æŠ¤é¢å¤–çš„æ•°æ®åº“å­˜å‚¨ï¼Œä¸€èˆ¬æ¥è¯´è€ƒè™‘åˆ°ä»¤ç‰Œå°†è¢«çƒ­ç‚¹è®¿é—®å’Œå®šæœŸåˆ é™¤ï¼Œ<code>Redis</code> æ˜¯æœ€ä½³çš„å®è·µï¼Œä½¿ç”¨ <code>MySQL / MongoDB</code> åœ¨å•æœºå’Œä½å¹¶å‘çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</li></ul><h2 id="åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Ÿ"><a href="#åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Ÿ" class="headerlink" title="åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Ÿ"></a>åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Ÿ</h2><ul><li><strong>&lt; ä¸´ç•Œè¿‡æœŸæ—¶é—´</strong>ï¼šæ— éœ€ç™»å½•ï¼Œä»¤ç‰Œä¸ä¼šåˆ·æ–°</li><li><strong>ä¸´ç•Œè¿‡æœŸæ—¶é—´ ~ é¢„è®¾è¿‡æœŸæ—¶é—´</strong>ï¼šæ— éœ€ç™»å½•ï¼Œä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°</li><li><strong>&gt; é¢„è®¾è¿‡æœŸæ—¶é—´</strong>ï¼šéœ€è¦ç™»å½•ï¼Œæ–°çš„ä»¤ç‰Œå‘¨æœŸ</li></ul><h1 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a><strong>å…·ä½“å®ç°</strong></h1><blockquote><p>ç»¼åˆä»¥ä¸Šï¼Œä¸‹é¢æä¾›<strong>æœåŠ¡ç«¯</strong>è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œ<strong>è¿‡æœŸæ—¶é—´</strong>çš„ç®€è¦è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h2 id="é™æ€åˆ·æ–°"><a href="#é™æ€åˆ·æ–°" class="headerlink" title="é™æ€åˆ·æ–°"></a>é™æ€åˆ·æ–°</h2><p><img src="/images/statically_refresh.png" alt="statically refresh"></p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šå®ç°æ–¹å¼ç®€å•ç²—æš´ï¼Œæ¯éªŒè¯ä¸€æ¬¡å°±æ›´æ–°ä¸€æ¬¡ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šæ›´æ–°å¤ªè¿‡é¢‘ç¹ï¼Œæ€§èƒ½å—æŸï¼Œä»¤ç‰Œå¯èƒ½å‡ºç°â€œå‡ ä¹ä¸ä¼šè¿‡æœŸâ€æœ‰æ‚–è®¾è®¡åˆè¡·ã€‚</li></ul><h2 id="åŠ¨æ€åˆ·æ–°"><a href="#åŠ¨æ€åˆ·æ–°" class="headerlink" title="åŠ¨æ€åˆ·æ–°"></a>åŠ¨æ€åˆ·æ–°</h2><p><img src="/images/dynamically_refresh.png" alt="dynamically refresh"></p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šè®¾ç½®è¿‡æœŸä¸´ç•Œï¼Œå¯¹æ›´æ–°çš„æ¡ä»¶åšäº†é™åˆ¶ï¼Œæå‡æ€§èƒ½ï¼Œä½¿ç”¨åˆç†ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šç»´æŠ¤ä¸¤ä¸ªè¿‡æœŸæ—¶é—´â€”â€”ä¸´ç•Œè¿‡æœŸæ—¶é—´å’Œé¢„è®¾è¿‡æœŸæ—¶é—´ã€‚</li></ul><h1 id="è¸©å‘è­¦å‘Š"><a href="#è¸©å‘è­¦å‘Š" class="headerlink" title="è¸©å‘è­¦å‘Š"></a><strong>è¸©å‘è­¦å‘Š</strong></h1><ol><li>æ³¨æ„<strong>é‡ç½®å¯†ç æ—¶åŒæ­¥åœ°å¤„ç†ä»¤ç‰Œ</strong>ã€‚</li><li>æ³¨æ„<strong>æµè§ˆå™¨å¤šé€‰é¡¹å¡å¹¶å‘æ“ä½œçš„å½±å“</strong>ã€‚</li><li>æ³¨æ„<strong>è¿‡æœŸä»¤ç‰Œå¦¥å–„å¤„ç†</strong>ï¼Œå¯ä»¥æ”¾ç€ä¸ç®¡ or å®šæœŸåˆ é™¤ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¦†ç›–ï¼ˆğŸ‘‰<a href="https://lottewong.github.io/2020/10/01/Golang%20Microservice%20%E5%B7%A5%E7%A8%8B%E5%BC%80%E5%8F%91%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B%E8%AE%BE%E8%AE%A1" target="_blank" rel="noopener">#Microservice# Golang Microservice å·¥ç¨‹å¼€å‘è¸©å‘è®°å½•</a>ğŸ‘ˆï¼‰</li></ol><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a><strong>å‚è€ƒé“¾æ¥</strong></h1><ol><li><a href="https://vimsky.com/article/3601.html" target="_blank" rel="noopener">JWT(JSON Web Token)è‡ªåŠ¨å»¶é•¿åˆ°æœŸæ—¶é—´</a></li><li><a href="https://www.zhihu.com/question/309815576/answer/579255324" target="_blank" rel="noopener">å¯¹äºtokençš„è®¤è¯ï¼Œå¦‚ä½•ä¿è¯tokençš„åŠæ—¶åˆ·æ–°ï¼Ÿ</a></li><li><a href="https://www.sundayfine.com/shiro-jwt/" target="_blank" rel="noopener">Shiroæ•´åˆJWT+Tokenè¿‡æœŸåˆ·æ–°ï¼Œå…¨éƒ½å¸®ä½ æ•´å¥½äº†</a></li><li><a href="https://www.sundayfine.com/jwt-refresh-token/" target="_blank" rel="noopener">é‡‡ç”¨JWTæœ‰æ•ˆæœŸå†…åˆ·æ–°Tokenæ–¹æ¡ˆï¼Œè§£å†³å¹¶å‘è¯·æ±‚é—®é¢˜</a></li><li><a href="https://www.v2ex.com/t/306017" target="_blank" rel="noopener">Token è¿‡æœŸçš„é—®é¢˜</a></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡è®¨è®º&lt;strong&gt;æœåŠ¡ç«¯è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œè¿‡æœŸæ—¶é—´çš„&lt;/strong&gt;æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Issue" scheme="http://yoursite.com/categories/Issue/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>#Issue# æµçš„å…³é—­â€”â€”è¸©å‘ä¹‹æˆ‘è§</title>
    <link href="http://yoursite.com/2022/01/16/%E6%B5%81%E7%9A%84%E5%85%B3%E9%97%AD%E2%80%94%E2%80%94%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%88%91%E8%A7%81/"/>
    <id>http://yoursite.com/2022/01/16/%E6%B5%81%E7%9A%84%E5%85%B3%E9%97%AD%E2%80%94%E2%80%94%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%88%91%E8%A7%81/</id>
    <published>2022-01-15T23:00:21.000Z</published>
    <updated>2022-02-07T10:56:55.040Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®¨è®º <code>defer</code> + <code>xxx.Close()</code> æ—¥å¸¸ä½¿ç”¨çš„åé¢æ•™æï¼ˆç¬‘</p><hr><a id="more"></a><h1 id="èƒŒæ™¯-amp-æè¿°"><a href="#èƒŒæ™¯-amp-æè¿°" class="headerlink" title="èƒŒæ™¯&amp;æè¿°"></a><strong>èƒŒæ™¯&amp;æè¿°</strong></h1><blockquote><p>æœ€è¿‘åœ¨<strong>å‘ç¬¬ä¸‰æ–¹æ¥å£ä¸Šä¼ æ–‡ä»¶</strong>çš„æ—¶å€™é‡åˆ°äº†ç‚¹é—®é¢˜ï¼Œå¤§è‡´æµç¨‹ï¼š</p><ol><li>ä»æœ¬åœ°æ‰“å¼€æˆ–ä»è¯·æ±‚è§£ææ–‡ä»¶ <code>I/O</code> æµ</li><li>åˆ›å»º <code>multipart/form-data</code> æ ¼å¼ç½‘ç»œ <code>I/O</code> æµ</li><li>å°†æ–‡ä»¶ <code>I/O</code> æµå¤åˆ¶åˆ°ç½‘ç»œ <code>I/O</code> æµ</li><li>è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£</li></ol><p>æœ€åå´è¿”å›äº†é”™è¯¯æç¤ºâ€”â€”<strong>å¤šåª’ä½“çš„æ•°æ®ä¸ºç©º</strong>ï¼Œé‚å¼€å§‹æ„æ–™ä¹‹å¤–çš„æ¼«æ¼« <code>debug</code> ä¹‹è·¯â€¦</p></blockquote><h2 id="æ–‡ä»¶-I-O-æµ"><a href="#æ–‡ä»¶-I-O-æµ" class="headerlink" title="æ–‡ä»¶ I/O æµ"></a>æ–‡ä»¶ I/O æµ</h2><h3 id="ä»æœ¬åœ°æ‰“å¼€"><a href="#ä»æœ¬åœ°æ‰“å¼€" class="headerlink" title="ä»æœ¬åœ°æ‰“å¼€"></a>ä»æœ¬åœ°æ‰“å¼€</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fileWriter, err := os.Open(filename)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> fileWriter.Close() <span class="hljs-comment">// better to use defer</span></span><br></pre></td></tr></table></figure><h3 id="ä»è¯·æ±‚è§£æ"><a href="#ä»è¯·æ±‚è§£æ" class="headerlink" title="ä»è¯·æ±‚è§£æ"></a>ä»è¯·æ±‚è§£æ</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fileWriter, _, err := ctx.Request.FormFile(<span class="hljs-string">"key"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> fileWriter.Close() <span class="hljs-comment">// better to use defer</span></span><br></pre></td></tr></table></figure><h2 id="ç½‘ç»œ-I-O-æµ"><a href="#ç½‘ç»œ-I-O-æµ" class="headerlink" title="ç½‘ç»œ I/O æµ"></a>ç½‘ç»œ I/O æµ</h2><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buffer := &amp;bytes.Buffer&#123;&#125; <span class="hljs-comment">// request body</span></span><br><span class="line">writer := multipart.NewWriter(buffer)</span><br><span class="line">header := writer.FormDataContentType() <span class="hljs-comment">// request header</span></span><br><span class="line">connWriter, err := writer.CreateFormFile(filetype, filepath.Base(filename))</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> writer.Close() <span class="hljs-comment">// do not use defer</span></span><br></pre></td></tr></table></figure><h2 id="å°†æ–‡ä»¶æµå¤åˆ¶åˆ°ç½‘ç»œæµ"><a href="#å°†æ–‡ä»¶æµå¤åˆ¶åˆ°ç½‘ç»œæµ" class="headerlink" title="å°†æ–‡ä»¶æµå¤åˆ¶åˆ°ç½‘ç»œæµ"></a>å°†æ–‡ä»¶æµå¤åˆ¶åˆ°ç½‘ç»œæµ</h2><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_, err = io.Copy(connWriter, fileWriter)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£"><a href="#è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£" class="headerlink" title="è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£"></a>è°ƒç”¨ç¬¬ä¸‰æ–¹çš„æ¥å£</h2><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">res, err := CallThirdPartyApi(header, buffer)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a><strong>é—®é¢˜å®šä½</strong></h1><blockquote><p>æ’æŸ¥çš„æ•´ä½“æ€è·¯æ˜¯<strong>ç”±å¤–åŠå†…</strong>ï¼Œå…·ä½“æ­¥éª¤ï¼š</p><ol><li>æ’é™¤ç¬¬ä¸‰æ–¹çš„æ¥å£é”™è¯¯</li><li>æ’é™¤è¯·æ±‚æ ¼å¼ä¸å¯¹</li><li>æ’é™¤è¯·æ±‚æ•°æ®ä¸ºç©º</li><li>æ’é™¤ä»£ç é€»è¾‘å­˜åœ¨ç¼ºé™·</li></ol><p>æœ€åå‘ç°æ˜¯ <strong>â€œå®Œç¾â€çš„ <code>defer xxx.Close()</code></strong> å‡ºäº†é—®é¢˜ï¼Œç™¾æ€ä¸å¾—å…¶è§£ingâ€¦ _(:3ã€âˆ )_</p></blockquote><h2 id="æ’é™¤ç¬¬ä¸‰æ–¹çš„å› ç´ "><a href="#æ’é™¤ç¬¬ä¸‰æ–¹çš„å› ç´ " class="headerlink" title="æ’é™¤ç¬¬ä¸‰æ–¹çš„å› ç´ "></a>æ’é™¤ç¬¬ä¸‰æ–¹çš„å› ç´ </h2><ul><li>âˆš  ä½¿ç”¨ Postman å·¥å…·æŒ‰ç…§æ–‡æ¡£æ„å»ºè¯·æ±‚</li></ul><h2 id="æ’é™¤è¯·æ±‚æ ¼å¼é—®é¢˜"><a href="#æ’é™¤è¯·æ±‚æ ¼å¼é—®é¢˜" class="headerlink" title="æ’é™¤è¯·æ±‚æ ¼å¼é—®é¢˜"></a>æ’é™¤è¯·æ±‚æ ¼å¼é—®é¢˜</h2><ul><li>âˆš  é‡ç‚¹æ£€æŸ¥è¯·æ±‚å¤´çš„ <code>Content-Type</code> å’Œ <code>Content-Disposition</code></li></ul><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Content-Type: multipart/form-data; boundary=<span class="hljs-variable">$&#123;random_boundary&#125;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="hljs-variable">$&#123;random_boundary&#125;</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="hljs-variable">$&#123;name&#125;</span>; filename=<span class="hljs-variable">$&#123;filename&#125;</span>; filelength=<span class="hljs-variable">$&#123;filelength&#125;</span></span><br><span class="line">Content-Disposition: application/octet-stream</span><br><span class="line"></span><br><span class="line">[data]</span><br><span class="line"><span class="hljs-variable">$&#123;random_boundary&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ’é™¤è¯·æ±‚æ•°æ®é—®é¢˜"><a href="#æ’é™¤è¯·æ±‚æ•°æ®é—®é¢˜" class="headerlink" title="æ’é™¤è¯·æ±‚æ•°æ®é—®é¢˜"></a>æ’é™¤è¯·æ±‚æ•°æ®é—®é¢˜</h2><ul><li>âˆš  æ‰“äº†æ–­ç‚¹ç¡®è®¤åœ¨å‘é€è¯·æ±‚å‰å·²ç»åŒ…å«æ•°æ®</li></ul><h2 id="æ’é™¤ä»£ç é€»è¾‘é”™è¯¯"><a href="#æ’é™¤ä»£ç é€»è¾‘é”™è¯¯" class="headerlink" title="æ’é™¤ä»£ç é€»è¾‘é”™è¯¯"></a>æ’é™¤ä»£ç é€»è¾‘é”™è¯¯</h2><ul><li>Ã— é€è¡Œå¯¹æ¯”åˆ«äººå†™çš„ç±»ä¼¼ä»£ç ï¼Œå‘ç°æµçš„å…³é—­å†™æ³•å­˜åœ¨å·®å¼‚</li></ul><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">buffer := &amp;bytes.Buffer&#123;&#125; <span class="hljs-comment">// request body</span></span><br><span class="line">writer := multipart.NewWriter(buffer)</span><br><span class="line">header := writer.FormDataContentType() <span class="hljs-comment">// request header</span></span><br><span class="line">connWriter, err := writer.CreateFormFile(filetype, filepath.Base(filename))</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// defer writer.Close()</span></span><br><span class="line"></span><br><span class="line">_, err = io.Copy(connWriter, fileWriter)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">writer.Close()</span><br></pre></td></tr></table></figure><h1 id="åŸå› -amp-éªŒè¯"><a href="#åŸå› -amp-éªŒè¯" class="headerlink" title="åŸå› &amp;éªŒè¯"></a><strong>åŸå› &amp;éªŒè¯</strong></h1><blockquote><p>â€œBut this idiom is actually harmful for writable files because deferring a function call ignores its return value, and the <code>Close()</code> method can return errors. <strong>For writable files, Go programmers should avoid the <code>defer</code> idiom or very infrequent, maddening bugs will occur.</strong>â€œ</p></blockquote><h2 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h2><h3 id="Write-å¼‚æ­¥ç¼“å†²"><a href="#Write-å¼‚æ­¥ç¼“å†²" class="headerlink" title="Write() å¼‚æ­¥ç¼“å†²"></a>Write() å¼‚æ­¥ç¼“å†²</h3><ul><li><p><code>Write()</code> è¿”å› <code>err</code>ï¼šä»£è¡¨å†™å…¥ç¼“å†²å·²ç»å‡ºé”™</p></li><li><p><code>Write()</code> è¿”å› <code>nil</code>ï¼šä»£è¡¨å†™å…¥ç¼“å†²å·²ç»æˆåŠŸ</p></li></ul><h3 id="Close-åŒæ­¥å…³é—­"><a href="#Close-åŒæ­¥å…³é—­" class="headerlink" title="Close() åŒæ­¥å…³é—­"></a>Close() åŒæ­¥å…³é—­</h3><ul><li><p><code>Close()</code> è¿”å› <code>err</code>ï¼šä»£è¡¨ä»ç¼“å†²åˆ°è½ç›˜ä¸­é—´å¥‡æ€ªçš„bugå¢åŠ äº†â€”â€”<code>[EIO]    A previously-uncommitted write(2) encountered an input/output error.</code></p></li><li><p><code>Close()</code> è¿”å› <code>nil</code>ï¼šè™½ç„¶æ–‡ä»¶ä¼šè¢«åŒæ­¥å…³é—­ï¼Œä½†æ˜¯ç¼“å†²ä»åœ¨å¼‚æ­¥è¿›è¡Œ</p></li></ul><h3 id="Sync-å¼ºåˆ¶è½ç›˜"><a href="#Sync-å¼ºåˆ¶è½ç›˜" class="headerlink" title="Sync() å¼ºåˆ¶è½ç›˜"></a>Sync() å¼ºåˆ¶è½ç›˜</h3><ul><li><p>ä½¿ç”¨ <code>Sync()</code> ä¼˜ç‚¹ï¼šç¨‹åºèƒ½å¤ŸçŸ¥é“æœ€åè½ç›˜ç»“æœï¼ˆæˆåŠŸ or å¤±è´¥ï¼‰</p></li><li><p>ä½¿ç”¨ <code>Sync()</code> ç¼ºç‚¹ï¼šå¼‚æ­¥å˜åŒæ­¥ï¼Œæ€§èƒ½ä¼šä¸‹é™</p></li></ul><h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><ul><li><p><code>defer writer.Close()</code> æˆ–è€… <code>// _ = writer.Close()</code> éƒ½ä¼šå‡ºç°ç©ºæ•°æ®çš„é”™è¯¯ï¼Œ<strong>è¯´æ˜ä¸åŠæ—¶åœ°å…³é—­æ–‡ä»¶ <code>I/O</code> æµå½±å“ç½‘ç»œ <code>I/O</code> æµè¯»å–</strong></p></li><li><p>å¦‚æœæˆ‘ä»¬å»¶è¿Ÿå…³é—­æˆ–æ²¡æœ‰å…³é—­è¾“å‡ºæµï¼Œ<strong>ç”±äºæ²¡æœ‰ä¸€ä¸ªä¿¡å·å‘ŠçŸ¥â€œå¯ä»¥æŠŠæ•°æ®ä»ç¼“å†²åŒºåŠ è½½è‡³è¿è¡ŒåŒºäº†â€ï¼Œå¯¹ç«¯çš„æœåŠ¡å™¨ <code>socket session</code> ä¸€ç›´è¢«é˜»å¡è‡³çº¿ç¨‹è¶…æ—¶</strong>ï¼Œè‡ªç„¶å°±å–ä¸åˆ°æ•°æ®</p></li></ul><h1 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a><strong>è§£å†³æ–¹æ³•</strong></h1><blockquote><p>ç”±æ­¤å¾—å‡º<strong>æµçš„å…³é—­æœ€ä½³å®è·µ</strong>æ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>åªè¯»æµå¯ä»¥ä½¿ç”¨ <code>defer</code>ï¼Œè¯»å†™æµæ…é‡ä½¿ç”¨ <code>defer</code>ï¼›æ–‡ä»¶ <code>I/O</code> æµå¯ä»¥ä½¿ç”¨ <code>defer</code>ï¼Œç½‘ç»œ <code>I/O</code> æµæ…é‡ä½¿ç”¨ <code>defer</code></li><li>åº”è¯¥åŒç­‰é‡è§† <code>Write()</code> å’Œ <code>Close()</code> çš„é”™è¯¯ï¼Œå¿…è¦æ—¶å¯ä»¥ç”¨ <code>Sync()</code></li></ol></blockquote><h2 id="æœ‰-defer-ç‰ˆ"><a href="#æœ‰-defer-ç‰ˆ" class="headerlink" title="æœ‰ defer ç‰ˆ"></a>æœ‰ defer ç‰ˆ</h2><h3 id="å•ä¸ª-defer-ä½¿ç”¨"><a href="#å•ä¸ª-defer-ä½¿ç”¨" class="headerlink" title="å•ä¸ª defer ä½¿ç”¨"></a>å•ä¸ª defer ä½¿ç”¨</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-params">(err error)</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// ä½¿ç”¨é—­åŒ…å‡½æ•°</span></span><br><span class="line">    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">        closeErr := w.Close()</span><br><span class="line">        <span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">            err = closeErr</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> w.Sync()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤šä¸ª-defer-ä½¿ç”¨"><a href="#å¤šä¸ª-defer-ä½¿ç”¨" class="headerlink" title="å¤šä¸ª defer ä½¿ç”¨"></a>å¤šä¸ª defer ä½¿ç”¨</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">r, err := Open(<span class="hljs-string">"a"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'a'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> r.Close()</span><br><span class="line"></span><br><span class="line">r, err = Open(<span class="hljs-string">"b"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'b'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> r.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">r1, err := Open(<span class="hljs-string">"a"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'a'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">err := r1.Close()</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">r2, err := Open(<span class="hljs-string">"b"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'b'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">err := r2.Close()</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">r, err := Open(<span class="hljs-string">"a"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'a'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> Close(r)</span><br><span class="line"></span><br><span class="line">r, err = Open(<span class="hljs-string">"b"</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatalf(<span class="hljs-string">"error opening 'b'\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">defer</span> Close(r)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Close</span><span class="hljs-params">(c io.Closer)</span></span> &#123;</span><br><span class="line">err := c.Close()</span><br><span class="line"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ— -defer-ç‰ˆ"><a href="#æ— -defer-ç‰ˆ" class="headerlink" title="æ—  defer ç‰ˆ"></a>æ—  defer ç‰ˆ</h2><h3 id="æ•è·é”™è¯¯"><a href="#æ•è·é”™è¯¯" class="headerlink" title="æ•è·é”™è¯¯"></a>æ•è·é”™è¯¯</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">var</span> err error</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ç›´æ¥åŒæ­¥åˆ¤æ–­</span></span><br><span class="line">    <span class="hljs-keyword">if</span> err = w.Close(); err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="hljs-keyword">return</span> w.Sync()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¿½ç•¥é”™è¯¯"><a href="#å¿½ç•¥é”™è¯¯" class="headerlink" title="å¿½ç•¥é”™è¯¯"></a>å¿½ç•¥é”™è¯¯</h3><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">var</span> err error</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ç›´æ¥åŒæ­¥åˆ¤æ–­</span></span><br><span class="line">    _ = w.Close()</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="hljs-keyword">return</span> w.Sync()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a><strong>å‚è€ƒé“¾æ¥</strong></h1><ol><li><a href="https://www.joeshaw.org/dont-defer-close-on-writable-files/#:~:text=But%20this%20idiom%20is%20actually,infrequent%2C%20maddening%20bugs%20will%20occur." target="_blank" rel="noopener">Donâ€™t defer Close() on writable files</a></li><li><a href="https://blevesearch.com/news/Deferred-Cleanup,-Checking-Errors,-and-Potential-Problems/" target="_blank" rel="noopener">Deferred Cleanup, Checking Errors, and Potential Problems</a></li><li><a href="https://blog.twofei.com/861/" target="_blank" rel="noopener">ç®€å•åœ° defer file.Close() å¯èƒ½æ˜¯ä¸€ç§é”™è¯¯ç”¨æ³•</a></li><li><a href="https://blog.csdn.net/qq_15268359/article/details/80070900" target="_blank" rel="noopener">socketé€šè®¯æµä¸å…³é—­æ¥æ”¶ä¸åˆ°å†…å®¹</a></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡è®¨è®º &lt;code&gt;defer&lt;/code&gt; + &lt;code&gt;xxx.Close()&lt;/code&gt; æ—¥å¸¸ä½¿ç”¨çš„åé¢æ•™æï¼ˆç¬‘&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Issue" scheme="http://yoursite.com/categories/Issue/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>#Sucks# å†™åœ¨äºŒé›¶äºŒè´°</title>
    <link href="http://yoursite.com/2022/01/01/%E5%86%99%E5%9C%A8%E4%BA%8C%E9%9B%B6%E4%BA%8C%E8%B4%B0/"/>
    <id>http://yoursite.com/2022/01/01/%E5%86%99%E5%9C%A8%E4%BA%8C%E9%9B%B6%E4%BA%8C%E8%B4%B0/</id>
    <published>2021-12-31T16:00:00.000Z</published>
    <updated>2022-01-16T08:02:36.946Z</updated>
    
    <content type="html"><![CDATA[<p>ï¼ˆï¼ˆï¼ˆåºŸè¯æ–‡å­¦è¿è½½å·â…¢</p><hr><a id="more"></a><p>â€Œå·¥ä½œä¹‹åç–äºæ‰“ç†è¿™ä¸ªåšå®¢ï¼Œä»Šå¹´å†³å®š set back to routineï¼ˆæˆ‘æœ€å¥½æ˜¯.jpgã€‚è¿‡å»ä¸€å¹´å¯¹æˆ‘ä¸ªäººæ¥è¯´æ„ä¹‰é‡å¤§â€”â€”<strong>æ€»ç®—æ¸¡è¿‡äººç”Ÿè½¬å‹çš„é˜µç—›æ—¶æœŸå•¦ :Pï¼ˆakaä»å°å­¦ğŸ“åˆ°æ–°ç”Ÿä»£å†œæ°‘å·¥å®Œæˆè¿›åŒ– bushiã€‚</strong>è™½ç„¶è¯´æˆé•¿è¿˜ä¸åŠé¢„æœŸï¼Œå›é¡¾èµ·æ¥è¿˜æ˜¯æœ‰ä¸€ä¸¢ä¸¢æ”¶è·ã€‚  </p><ul><li><p><strong>2021H1 æ˜¯å…³äºæ¶ˆåŒ–ç¦»åˆ«çš„åŠå¹´ã€‚</strong>ç»“æŸåœ¨äº‘ç®¡å°†è¿‘ä¸€å¹´çš„å®ä¹ ï¼Œæ¬ç©ºè½¬è§’é£˜çª—çš„å°å°è±ªæ–¯ğŸŒ‡ï¼Œå¿˜ä¸äº†è·µè¡Œé‚£å¤©é¥­åæ•£æ­¥æ™“æ¸…å“¥å¯¹æˆ‘çš„é¼“åŠ±å’Œç¥ç¦ï¼Œç¬¬ä¸€æ¬¡å·¥ä½œå°±é‡åˆ°ç‰¹åˆ«ç‰¹åˆ«å¥½çš„ leaderã€mentor å’ŒåŒäº‹ä»¬å®åœ¨æ˜¯å¤ªæ„ŸåŠ¨ã€‚æ¥ç€å°±æ˜¯é¡ºåˆ©ä»çªå·¥æ¯•ä¸šå™œï¼ˆæ²¡æœ‰æœºä¼šä½“éªŒè‰¾åˆ©æ–¯é¡¿å­¦é™¢ <code>what a pitty</code>ï¼Œä¸è¿‡åº¦è¿‡äº†éå¸¸å¼€å¿ƒå’Œéš¾å¿˜çš„æ¯•ä¸š <code>ing</code> â†’ æ¯•ä¸š <code>already</code> æ—¶å…‰ï¼Œä¹Ÿå°±æ­¤å‘Šåˆ«äº†æˆ‘çš„å­¦ç”Ÿæ—¶ä»£ã€æ ¡å›­ç”Ÿæ´»ã€æ‹äººã€åŒçª—è¿˜æœ‰å®è´å¥³é¹…ï¼ˆä½†æ˜¯éº»éº»ä¼šåœ¨å¿ƒé‡Œæ°¸è¿œçˆ±ä½ â¤ã€‚  </p></li><li><p><strong>â€Œ2021H2 æ˜¯å…³äºæ‹¥æŠ±å˜åŒ–çš„åŠå¹´ã€‚</strong>æ¯”å¦‚å†å›ä½ ğŸ§å½“å·¥å…·äºº <code>bot</code>ï¼ˆç»ˆäºä¸å†æ˜¯ <code>CURD girl</code> äº† _(:3ã€âˆ )_ï¼Œå¦‚æœå¹¸è¿çš„è¯è¿‡æ®µæ—¶é—´å¯èƒ½æ˜¯ <code>T6</code> ä»”ï¼ˆéšè—æ¬¾ ç¬‘ã€‚æ¯”å¦‚è¿›è¡Œäººç±»ç”°å›­è§‚å¯Ÿå®éªŒï¼Œä¼˜ç§€å¦‚ Walden å’Œ Steven å•¦æˆ‘æ’ä¹…çš„æ¦œæ ·ã€è¿˜æœ‰å„è‡ªç¾ä¸½çš„æ·±åœ³æ¹¾<del>1å·</del>æ‰“å·¥ä»”å’Œä¸šä¸»ç¾¤ã€ä¸€å¦‚æ—¢å¾€ carry åˆ nice çš„åŒäº‹ä»¬ã€å§è™è—é¾™ä¹‹å°åŸ¹å°ä¼™ä¼´ <code>etc</code>ã€‚æ¯”å¦‚â€œè¯—æ„åœ°æ –å±…â€ ( ?ï¼Œå·¥ä½œæ—¥å¬ç€ Indie Rock æ¿€æƒ…å†™ä»£ç ï¼Œå‘¨æœ«åˆ°ä¹¦åº—è¯»ä¸‰è” or çªåœ¨å®¶çœ‹ç”µå½±ï¼Œå¤å¤©ä¸‹æ¥¼ä½›ç³»æ¸¸æ³³å†¬å¤©åœ¨å®¶è¸©æ¤­åœ†æœºèº«ä½“æ£’æ£’ï¼Œæ—¥å¸¸é¥­åæ•£æ­¥ &amp; å¶å°”å…¬å›­é‡é¤ &amp; è¯´èµ°å°±èµ°æ—…è¡Œ <code>cosy buff++</code>ï¼Œè¿˜æœ‰ä¸¤åªç“œå®å®æ— æƒ…çš„æŒ‰æ‘© <code>bot</code> åœ¨ä¸‹æ˜¯ä¹ŸğŸ˜†ã€‚æ¯”å¦‚â€œç®€å•ï¼Œç®€å•ï¼Œå†ç®€å•â€ï¼Œä½“éªŒ over æ³³æœ‰ï¼Œå°†æ¶ˆè´¹ä¸»ä¹‰å’ŒæŠ•æœºä¸»ä¹‰ä»æˆ‘çš„ç”Ÿæ´»ä¸­æ’é™¤ï¼Œä»…ä»…å±äºæœ¬è´¨ï¼ˆä½†æ˜¯ä¼šè®¤çœŸåœ°è§„åˆ’ <code>f**k u money</code>ï¼Œæœ‰ä½™åŠ›å¤šå¤š<a href="https://gongyi.qq.com/succor/detail.htm?id=28439" target="_blank" rel="noopener">ç»™å¦¹å¦¹ä»¬å®‰æ’ä¸Šå«ç”Ÿç”¨å“</a>ingâ€¦| à¥‚â€¢à«…Ï‰â€¢Ì)áµáµáµ  </p></li></ul><p>â€Œå½“ç„¶ï¼Œçœ‹ä¼¼å¹³é™çš„ç”Ÿæ´»ä¸‹å…¶å®å……æ»¡æš—æ¶Œï¼Œé¢å¯¹è‡ªå·±ä¹Ÿè¦è¶³å¤Ÿè¯šå®ã€‚æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´æˆ‘æ„Ÿè§‰è‡ªå·±å¤„äºã€Šçª„é—¨ã€‹é‡Œçš„çŠ¶æ€â€”â€”<strong>â€œåˆ°äº†ç”Ÿæ´»çš„å…³å£ï¼Œéš¾ä»¥é€šè¿‡äº†ã€‚ä½†è¿™ä¸æ˜¯åŒå€¦ï¼Œåªæ˜¯æˆ‘è‡ªå·±éš¾ä»¥ç†è§£ã€‚â€</strong> è¿™æ˜¯è¯´ï¼Œå½“è‡ªæˆ‘å®¡æŸ¥çš„æ·±å…¥ä¼šå‘ç°ç†æƒ³å¹¶ä¸å¤Ÿç†æƒ³ï¼Œå³ä½¿è¶³å¤Ÿå¹¸è¿çš„æ¬¡è¦ç”Ÿæ´»ä¹Ÿæ— æ³•æ¶ˆè§£ä¸€äº›ä¸å¯è¨€è¯´ã€æ— è¨€ä»¥å¯¹çš„ç»“æ„æ€§å›°æ‰°â€”â€”è¦å»å¯¹æŠ—è‡ªå·±â€œè½åçš„ç”Ÿäº§åŠ›â€ä¸èƒ½é€‚åº”ç°å®â€œæ–°çš„ç”Ÿäº§å…³ç³»â€å¸¦æ¥çš„å¼‚åŒ–æ„Ÿã€è¦å»å¯¹æŠ—å’Œä¸–ç•Œç´§å¯†è”ç»“äº§ç”Ÿçš„æ”¿æ²»æ€§æŠ‘éƒå‰¯ä½œç”¨ï¼ˆè¨€é‡äº†ã€è¦å»å¯¹æŠ—æœªèƒ½çœŸæ­£å®ç°è‡ªç”±åˆ°è¾¾ç»éªŒå’Œæƒ³è±¡åŠ›ä¹‹å¤–çš„å±€ä¿ƒã€è¦å»å¯¹æŠ—å³ä½¿ä½ çœŸå®åœ°æ‹¥æœ‰å¹¶æ„Ÿå—ç€ä¸€åˆ‡çš„ä¸€åˆ‡ä¹Ÿæ— æ³•æ‘†è„±çš„ã€å¦‚å½±éšå½¢çš„æ— èŠã€‚<strong>ä½†æ˜¯å½“æˆ‘æ¥å—æ‰€æœ‰çš„è¿™äº›æ˜¯â€œæˆ‘ä½œä¸ºæˆ‘â€çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ‰“ç®—åƒæ–¹ç™¾è®¡åœ°å–æ¶ˆå®ƒä»¬ï¼Œæ•´ä¸ªäººå°±å¥½äº†ï¼Œ</strong>ä¹Ÿè®¸æ„ä¹‰æœ¬èº« <code>be like</code> å¯»æ‰¾æ— åŒï¼š</p><blockquote><p>â€œâ€Œè¿åŠ¨å°±æ˜¯ä¸€åˆ‡ï¼Œç›®çš„æ˜¯æ²¡æœ‰çš„ã€‚æ‰€ä»¥å¯»æ‰¾å°±æ˜¯ä¸€åˆ‡ï¼Œè€Œæ‰¾çš„æ˜¯è°å´æ— å…³ç´§è¦â€¦ä½•å†µå°˜ä¸–åš£åš£ï¼Œæˆ‘ä»¬ä¸ç®¡å¹²ä»€ä¹ˆï¼Œéƒ½æ˜¯å›°éš¾é‡é‡ã€‚æ‰€ä»¥æˆ‘ä¼°è®¡ç‹ä»™å®¢æ‰¾ä¸åˆ°æ— åŒã€‚â€</p></blockquote><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;ï¼ˆï¼ˆï¼ˆåºŸè¯æ–‡å­¦è¿è½½å·â…¢&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Sucks" scheme="http://yoursite.com/categories/Sucks/"/>
    
    
  </entry>
  
  <entry>
    <title>#DevOps# éƒ¨ç½²æœåŠ¡çš„Nç§å§¿åŠ¿</title>
    <link href="http://yoursite.com/2021/10/22/%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E7%9A%84N%E7%A7%8D%E5%A7%BF%E5%8A%BF/"/>
    <id>http://yoursite.com/2021/10/22/%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E7%9A%84N%E7%A7%8D%E5%A7%BF%E5%8A%BF/</id>
    <published>2021-10-21T23:00:21.000Z</published>
    <updated>2021-10-22T15:26:31.039Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦è®°å½•å·¥ä½œä¸­æœåŠ¡å¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œæ—¨åœ¨äº cover æ—¥å¸¸çš„ <code>CI/CD</code> åœºæ™¯ï¼š</p><ol><li><strong>è¿›ç¨‹+å•æœº</strong>ï¼š<code>systemctl</code> + <code>rpm</code></li><li><strong>å®¹å™¨+å•æœº</strong>ï¼š<code>docker-compose</code> + <code>image</code></li><li><strong>å®¹å™¨+é›†ç¾¤</strong>ï¼š<code>k8s</code> + <code>image</code></li></ol><hr><a id="more"></a><h1 id="systemctl-rpm"><a href="#systemctl-rpm" class="headerlink" title="systemctl + rpm"></a><strong>systemctl + rpm</strong></h1><blockquote><p><code>systemctl</code>ï¼šè‡ªè¡Œæ³¨å†Œ/å¯åŠ¨/æ›´æ–°/åœæ­¢</p><p><code>rpm</code>ï¼šæµæ°´çº¿ç”Ÿæˆ rpmï¼Œè‡ªè¡Œå®‰è£…/æ›´æ–°</p></blockquote><h2 id="æ³¨å†ŒæœåŠ¡"><a href="#æ³¨å†ŒæœåŠ¡" class="headerlink" title="æ³¨å†ŒæœåŠ¡"></a>æ³¨å†ŒæœåŠ¡</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/lib/systemd/system/wework-service.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=wework-service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=root</span><br><span class="line">Group=root</span><br><span class="line">PermissionsStartOnly=true</span><br><span class="line">ExecStart=/usr/bin/wework-service --config=/etc/wework-service/config.yaml</span><br><span class="line">Restart=always</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">WorkingDirectory=/usr/share/wework-service</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">:wq</span><br></pre></td></tr></table></figure><ol><li><p><strong>ä¿è¯ <code>WorkingDirectory</code> å¿…é¡»å­˜åœ¨</strong>ï¼Œå¦åˆ™æŠ›å‡ºé”™è¯¯ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Failed at step CHDIR spawning /xxx: No such file or directory</span><br><span class="line">mkdir -p /usr/share/wework-service</span><br></pre></td></tr></table></figure></li><li><p><strong>ä¿è¯ <code>ExecStart</code> å¯ä»¥æ‰§è¡Œ</strong>ï¼Œäº¤å‰ç¼–è¯‘äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè®¾ç½®æƒé™ä¸ºå¯æ‰§è¡Œï¼Œå…·ä½“å‘½ä»¤ï¼š</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># äº¤å‰ç¼–è¯‘</span><br><span class="line">set CGO_ENBALED=0</span><br><span class="line">set GOOS=linux</span><br><span class="line">set GOARCH=amd64</span><br><span class="line">go build -o cmd/server/wework-service cmd/server/main.go</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æƒé™</span><br><span class="line">chmod 755 /usr/bin/wework-service</span><br></pre></td></tr></table></figure></li></ol><h2 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Step 1: åˆæ¬¡äº¤å‰ç¼–è¯‘</span><br><span class="line"># Step 2: ä¸Šä¼ äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆè‹¥é…ç½®æ–‡ä»¶ä¹Ÿæ›´æ–°ï¼ŒåŒæ­¥ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼‰</span><br><span class="line"># Step 3: åˆæ¬¡è®¾ç½®æƒé™</span><br><span class="line">rpm -ivh wework-service-0.0.0-dev.1.xxxxxxx.rpm # å®‰è£… rpm åŒ…</span><br><span class="line"></span><br><span class="line">sudo systemctl daemon-reload # é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</span><br><span class="line">sudo systemctl enable wework-service.service # å½•å…¥æœåŠ¡</span><br><span class="line">sudo systemctl start wework-service.service # å¯åŠ¨æœåŠ¡</span><br><span class="line">sudo systemctl status wework-service.service # æŸ¥çœ‹æœåŠ¡</span><br><span class="line">journalctl -u wework-service.service # æŸ¥çœ‹æœåŠ¡è¿è¡Œæ—¥å¿—</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æœåŠ¡"><a href="#æ›´æ–°æœåŠ¡" class="headerlink" title="æ›´æ–°æœåŠ¡"></a>æ›´æ–°æœåŠ¡</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Step 1: é‡æ–°äº¤å‰ç¼–è¯‘</span><br><span class="line"># Step 2: ä¸Šä¼ äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆè‹¥é…ç½®æ–‡ä»¶ä¹Ÿæ›´æ–°ï¼ŒåŒæ­¥ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼‰</span><br><span class="line"># Step 3: é‡æ–°è®¾ç½®æƒé™</span><br><span class="line">rpm -Uvh wework-service-0.0.0-dev.1.xxxxxxx.rpm # æ›´æ–° rpm åŒ…</span><br><span class="line"></span><br><span class="line">sudo systemctl restart wework-service.service # é‡å¯æœåŠ¡</span><br><span class="line">sudo systemctl status wework-service.service # æŸ¥çœ‹æœåŠ¡</span><br><span class="line">journalctl -u wework-service.service # æŸ¥çœ‹æœåŠ¡è¿è¡Œæ—¥å¿—</span><br></pre></td></tr></table></figure><h2 id="åœæ­¢æœåŠ¡"><a href="#åœæ­¢æœåŠ¡" class="headerlink" title="åœæ­¢æœåŠ¡"></a>åœæ­¢æœåŠ¡</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop wework-service.service # åœæ­¢æœåŠ¡</span><br><span class="line">sudo systemctl status wework-service.service # æŸ¥çœ‹æœåŠ¡</span><br><span class="line">journalctl -u wework-service.service # æŸ¥çœ‹æœåŠ¡è¿è¡Œæ—¥å¿—</span><br></pre></td></tr></table></figure><h1 id="docker-compose-image"><a href="#docker-compose-image" class="headerlink" title="docker-compose + image"></a><strong>docker-compose + image</strong></h1><blockquote><p><code>docker-compose</code>ï¼šæä¾›ç¼–æ’é…ç½®æ–‡ä»¶</p><p><code>image</code>ï¼šæµæ°´çº¿ç”Ÿæˆ imageï¼Œç›´æ¥ä»å…¬å¸ä»“åº“æ‹‰æˆ–è€…ä¸‹è½½ä¸Šä¼ é•œåƒ</p></blockquote><h2 id="docker-compose-yaml"><a href="#docker-compose-yaml" class="headerlink" title="docker-compose yaml"></a>docker-compose yaml</h2><figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># /data/wework-service/base.yaml</span></span><br><span class="line"><span class="hljs-attr">version:</span> <span class="hljs-string">"2.1"</span></span><br><span class="line"><span class="hljs-attr">services:</span></span><br><span class="line">  <span class="hljs-comment"># ä¸­é—´ä»¶</span></span><br><span class="line">  <span class="hljs-attr">mongo-standalone:</span></span><br><span class="line">    <span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;mongo-standalone-image&#125;</span></span><br><span class="line">    <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span></span><br><span class="line">    <span class="hljs-attr">healthcheck:</span></span><br><span class="line">      <span class="hljs-attr">test:</span> <span class="hljs-string">[]</span></span><br><span class="line">      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span></span><br><span class="line">      <span class="hljs-attr">start_period:</span> <span class="hljs-string">15s</span></span><br><span class="line">    <span class="hljs-attr">environment:</span></span><br><span class="line">      <span class="hljs-attr">MONGO_INITDB_ROOT_USERNAME:</span> <span class="hljs-string">username</span></span><br><span class="line">      <span class="hljs-attr">MONGO_INITDB_ROOT_PASSWORD:</span> <span class="hljs-string">password</span></span><br><span class="line">      <span class="hljs-attr">MONGO_INITDB_DATABASE:</span> <span class="hljs-string">database</span></span><br><span class="line">    <span class="hljs-attr">volumes:</span> <span class="hljs-comment"># æŒ‚è½½ volume</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/xxx/install/init_script/mongo:/docker-entrypoint-initdb.d</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/xxx/mount_points/mongodb:/data/db</span></span><br><span class="line">    <span class="hljs-attr">ports:</span>   <span class="hljs-comment"># æ˜ å°„ port</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-number">27017</span><span class="hljs-string">:27017</span></span><br><span class="line">    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span></span><br><span class="line">    <span class="hljs-attr">command:</span> <span class="hljs-string">--replSet</span> <span class="hljs-string">rs0</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment"># å¾®æœåŠ¡</span></span><br><span class="line">  <span class="hljs-attr">wework-service:</span></span><br><span class="line">    <span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;wework-service-image&#125;</span></span><br><span class="line">    <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span></span><br><span class="line">    <span class="hljs-attr">volumes:</span> <span class="hljs-comment"># æŒ‚è½½ volume</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/xxx/conf/wework-service/config.yaml:/etc/wework-service/config.yaml</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/xxx/logs/wework-service:/var/log/wework-service</span></span><br><span class="line">    <span class="hljs-attr">ports:</span> <span class="hljs-comment"># æ˜ å°„ port</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">xxxx:xxxx</span></span><br><span class="line">    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment"># å¯åŠ¨é¡ºåº</span></span><br><span class="line">  <span class="hljs-attr">step-0:</span></span><br><span class="line">    <span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;wait-for-dependencies-image&#125;</span></span><br><span class="line">    <span class="hljs-attr">environment:</span></span><br><span class="line">      <span class="hljs-attr">TIMEOUT_LENGTH:</span> <span class="hljs-number">60</span></span><br><span class="line">    <span class="hljs-attr">depends_on:</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">mongo-standalone</span></span><br><span class="line">    <span class="hljs-attr">command:</span> <span class="hljs-string">mongo-standalone:27017</span></span><br><span class="line">  </span><br><span class="line">  <span class="hljs-attr">step-1:</span></span><br><span class="line">    <span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;wait-for-dependencies-image&#125;</span></span><br><span class="line">    <span class="hljs-attr">environment:</span></span><br><span class="line">      <span class="hljs-attr">TIMEOUT_LENGTH:</span> <span class="hljs-number">30</span></span><br><span class="line">    <span class="hljs-attr">depends_on:</span></span><br><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">wework-service</span></span><br><span class="line">    <span class="hljs-attr">command:</span> <span class="hljs-string">wework-service:xxxx</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-attr">networks:</span></span><br><span class="line">  <span class="hljs-attr">default:</span></span><br><span class="line">    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span></span><br><span class="line">    <span class="hljs-attr">ipam:</span></span><br><span class="line">      <span class="hljs-attr">config:</span></span><br><span class="line">        <span class="hljs-bullet">-</span> <span class="hljs-attr">subnet:</span> <span class="hljs-string">$&#123;subnet_segment&#125;</span></span><br></pre></td></tr></table></figure><h2 id="è®¿é—®æœåŠ¡"><a href="#è®¿é—®æœåŠ¡" class="headerlink" title="è®¿é—®æœåŠ¡"></a>è®¿é—®æœåŠ¡</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://&#123;node_ip&#125;:&#123;port&#125; æˆ– http://&#123;domain&#125;:&#123;port&#125;</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æœåŠ¡-1"><a href="#æ›´æ–°æœåŠ¡-1" class="headerlink" title="æ›´æ–°æœåŠ¡"></a>æ›´æ–°æœåŠ¡</h2><h3 id="æ›´æ–°é…ç½®"><a href="#æ›´æ–°é…ç½®" class="headerlink" title="æ›´æ–°é…ç½®"></a>æ›´æ–°é…ç½®</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆä¿®æ”¹æŒ‚è½½è·¯å¾„çš„ä¸æ˜¯å®¹å™¨å†…éƒ¨çš„ï¼‰</span></span><br><span class="line">vim /data/xxx/conf/wework-service/config.yaml</span><br><span class="line">:wq</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># -------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ‰§è¡Œæ›´æ–°è„šæœ¬</span></span><br><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># è¯»å–å‚æ•°</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">    container_name=<span class="hljs-variable">$1</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"usage: ./restart.sh container-name\n e.g.  ./restart.sh wework-service"</span></span><br><span class="line">    <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯å®¹å™¨</span></span><br><span class="line">container_id=$(docker ps -a | grep <span class="hljs-string">"<span class="hljs-variable">$&#123;container_name&#125;</span>"</span> | awk <span class="hljs-string">'&#123;print $1&#125;'</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$container_id</span>"</span> == <span class="hljs-string">""</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">"container not found!"</span></span><br><span class="line">   <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">"restarting <span class="hljs-variable">$&#123;container_name&#125;</span>... "</span></span><br><span class="line">docker restart <span class="hljs-string">"<span class="hljs-variable">$&#123;container_id&#125;</span>"</span> &gt; restart.log &amp;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># å¥åº·æ£€æŸ¥</span></span><br><span class="line">PID=$!</span><br><span class="line">marks=( <span class="hljs-string">'/'</span> <span class="hljs-string">'-'</span> <span class="hljs-string">'\'</span> <span class="hljs-string">'|'</span> )</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span> s=$(ps -p <span class="hljs-variable">$PID</span> -o s=) &amp;&amp; [[ <span class="hljs-string">"<span class="hljs-variable">$s</span>"</span> &amp;&amp; <span class="hljs-string">"<span class="hljs-variable">$s</span>"</span> != <span class="hljs-string">'Z'</span> ]]; <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -ne <span class="hljs-string">"\b<span class="hljs-variable">$&#123;marks[i++ % $&#123;#marks[@]&#125;</span>]&#125;"</span>;</span><br><span class="line">    sleep 0.5</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"></span><br><span class="line">output=$(cat restart.log)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$output</span>"</span> == <span class="hljs-string">"<span class="hljs-variable">$container_id</span>"</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\b\e[32mDone.\033[0m"</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\b\e[31mFailed!\033[0m"</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$output</span>"</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°é•œåƒ"><a href="#æ›´æ–°é•œåƒ" class="headerlink" title="æ›´æ–°é•œåƒ"></a>æ›´æ–°é•œåƒ</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># é•œåƒè·å–</span></span><br><span class="line"><span class="hljs-comment"># 1. å…ˆä»æœ¬åœ°ä»“åº“æŸ¥æ‰¾ï¼ˆå¦‚æœä¸èƒ½pingé€šå…¬å¸çš„ä»“åº“ï¼Œéœ€è¦ä¸‹è½½â†’ä¿å­˜â†’ä¸Šä¼ â†’åŠ è½½æµç¨‹ï¼‰</span></span><br><span class="line"><span class="hljs-comment"># 2. å†ä»è¿œç¨‹ä»“åº“ä¸‹è½½ï¼ˆå¦‚æœå¯ä»¥pingé€šå…¬å¸çš„ä»“åº“ï¼Œå¯ä»¥ç›´æ¥è®©è„šæœ¬è·‘ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># -------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ‰§è¡Œæ›´æ–°è„šæœ¬</span></span><br><span class="line"><span class="hljs-meta">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># è¯»å–å‚æ•°</span></span><br><span class="line">docker_service_name=<span class="hljs-variable">$1</span></span><br><span class="line">service_tag=<span class="hljs-variable">$2</span></span><br><span class="line"><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$#</span> -lt 2 ]];<span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">"please input two param for docker_service_name and service_tag. eg: wework-service 0.0.0-dev.1.xxxxxxx"</span></span><br><span class="line">    <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line">IFS=<span class="hljs-string">" "</span> <span class="hljs-built_in">read</span> -r -a values &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$&#123;docker_service_name//\// &#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">service_name=<span class="hljs-variable">$&#123;values[$[$&#123;#values[@]&#125;</span>-1]]&#125;</span><br><span class="line">workspace=<span class="hljs-string">"/data/wework-service"</span></span><br><span class="line"><span class="hljs-built_in">cd</span> <span class="hljs-string">"<span class="hljs-variable">$&#123;workspace&#125;</span>"</span></span><br><span class="line">docker-compose -f base.yml stop <span class="hljs-string">"<span class="hljs-variable">$&#123;service_name&#125;</span>"</span></span><br><span class="line"><span class="hljs-built_in">echo</span> y | docker-compose -f base.yml rm <span class="hljs-string">"<span class="hljs-variable">$&#123;service_name&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">sed -i <span class="hljs-string">"s/image: <span class="hljs-variable">$&#123;docker_service_name//\//\\/&#125;</span>.*$/image: <span class="hljs-variable">$&#123;docker_service_name//\//\\/&#125;</span>:<span class="hljs-variable">$&#123;service_tag&#125;</span>/"</span> base.yml</span><br><span class="line">docker-compose -f base.yml up -d <span class="hljs-string">"<span class="hljs-variable">$&#123;service_name&#125;</span>"</span></span><br></pre></td></tr></table></figure><h1 id="k8s-image"><a href="#k8s-image" class="headerlink" title="k8s + image"></a><strong>k8s + image</strong></h1><blockquote><p><code>k8s</code>ï¼šæä¾›ç¼–æ’é…ç½®æ–‡ä»¶</p><p><code>image</code>ï¼šæµæ°´çº¿ç”Ÿæˆ imageï¼Œç›´æ¥ä»å…¬å¸ä»“åº“æ‹‰æˆ–è€…ä¸‹è½½ä¸Šä¼ é•œåƒ</p></blockquote><p><img src="https://pic3.zhimg.com/80/v2-1344ef25cfeff6ef831cd5e99890d242_1440w.jpg" alt="Kubernetes Domain Concept Relationship"></p><h2 id="Kubernetes-Deployment"><a href="#Kubernetes-Deployment" class="headerlink" title="Kubernetes Deployment"></a>Kubernetes Deployment</h2><figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attr">Pod Template:</span></span><br><span class="line">  <span class="hljs-attr">Labels:</span>  <span class="hljs-string">app=wework-service</span></span><br><span class="line">  <span class="hljs-attr">Containers:</span></span><br><span class="line">   <span class="hljs-attr">wework-service:</span></span><br><span class="line">    <span class="hljs-attr">Image:</span>      <span class="hljs-string">$&#123;wework-service-image&#125;</span></span><br><span class="line">    <span class="hljs-attr">Port:</span>       <span class="hljs-string">xxxx/TCP</span></span><br><span class="line">    <span class="hljs-attr">Host Port:</span>  <span class="hljs-number">0</span><span class="hljs-string">/TCP</span></span><br><span class="line">    <span class="hljs-attr">Limits:</span></span><br><span class="line">      <span class="hljs-attr">cpu:</span>     <span class="hljs-string">600m</span></span><br><span class="line">      <span class="hljs-attr">memory:</span>  <span class="hljs-string">1Gi</span></span><br><span class="line">    <span class="hljs-attr">Requests:</span></span><br><span class="line">      <span class="hljs-attr">cpu:</span>        <span class="hljs-string">64m</span></span><br><span class="line">      <span class="hljs-attr">memory:</span>     <span class="hljs-string">64Mi</span></span><br><span class="line">    <span class="hljs-attr">Environment:</span>  <span class="hljs-string">&lt;none&gt;</span></span><br><span class="line">    <span class="hljs-attr">Mounts:</span></span><br><span class="line">      <span class="hljs-string">/data/xxx/conf/wework-service</span> <span class="hljs-string">from</span> <span class="hljs-string">app-config</span> <span class="hljs-string">(rw)</span></span><br><span class="line">      <span class="hljs-string">/etc/localtime</span> <span class="hljs-string">from</span> <span class="hljs-string">host-time</span> <span class="hljs-string">(rw)</span></span><br><span class="line">  <span class="hljs-attr">Volumes:</span></span><br><span class="line">   <span class="hljs-attr">host-time:</span></span><br><span class="line">    <span class="hljs-attr">Type:</span>          <span class="hljs-string">HostPath</span> <span class="hljs-string">(bare</span> <span class="hljs-string">host</span> <span class="hljs-string">directory</span> <span class="hljs-string">volume)</span></span><br><span class="line">    <span class="hljs-attr">Path:</span>          <span class="hljs-string">/etc/localtime</span></span><br><span class="line">    <span class="hljs-attr">HostPathType:</span>  </span><br><span class="line">   <span class="hljs-attr">app-config:</span></span><br><span class="line">    <span class="hljs-attr">Type:</span>      <span class="hljs-string">ConfigMap</span> <span class="hljs-string">(a</span> <span class="hljs-string">volume</span> <span class="hljs-string">populated</span> <span class="hljs-string">by</span> <span class="hljs-string">a</span> <span class="hljs-string">ConfigMap)</span></span><br><span class="line">    <span class="hljs-attr">Name:</span>      <span class="hljs-string">wework-service-config</span></span><br><span class="line">    <span class="hljs-attr">Optional:</span>  <span class="hljs-literal">false</span></span><br></pre></td></tr></table></figure><h2 id="Kubernetes-Service"><a href="#Kubernetes-Service" class="headerlink" title="Kubernetes Service"></a>Kubernetes Service</h2><figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attr">Name:</span>              <span class="hljs-string">wework-service</span></span><br><span class="line"><span class="hljs-attr">Namespace:</span>         <span class="hljs-string">default</span></span><br><span class="line"><span class="hljs-attr">Labels:</span>            <span class="hljs-string">app=wework-service</span></span><br><span class="line"><span class="hljs-attr">Selector:</span>          <span class="hljs-string">app=wework-service</span></span><br><span class="line"><span class="hljs-attr">Type:</span>              <span class="hljs-string">ClusterIP</span></span><br><span class="line"><span class="hljs-attr">IP:</span>                <span class="hljs-string">x.x.x.x</span> <span class="hljs-comment"># Cluster Ip</span></span><br><span class="line"><span class="hljs-attr">Port:</span>              <span class="hljs-string">http</span> <span class="hljs-string">xxxx/TCP</span></span><br><span class="line"><span class="hljs-attr">TargetPort:</span>        <span class="hljs-string">xxxx/TCP</span></span><br><span class="line"><span class="hljs-attr">Endpoints:</span>         <span class="hljs-string">x.x.x.x:xxxx</span> <span class="hljs-comment"># Pod Ip</span></span><br><span class="line"><span class="hljs-attr">Session Affinity:</span>  <span class="hljs-string">None</span></span><br><span class="line"><span class="hljs-attr">Events:</span>            <span class="hljs-string">&lt;none&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è®¿é—®æœåŠ¡-1"><a href="#è®¿é—®æœåŠ¡-1" class="headerlink" title="è®¿é—®æœåŠ¡"></a>è®¿é—®æœåŠ¡</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://&#123;ingress_ip&#125;:&#123;port&#125; æˆ– http://&#123;domain&#125;:&#123;port&#125;</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æœåŠ¡-2"><a href="#æ›´æ–°æœåŠ¡-2" class="headerlink" title="æ›´æ–°æœåŠ¡"></a>æ›´æ–°æœåŠ¡</h2><h3 id="æ›´æ–°é…ç½®-1"><a href="#æ›´æ–°é…ç½®-1" class="headerlink" title="æ›´æ–°é…ç½®"></a>æ›´æ–°é…ç½®</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆä¿®æ”¹æŒ‚è½½è·¯å¾„çš„ä¸æ˜¯å®¹å™¨å†…éƒ¨çš„ï¼‰</span></span><br><span class="line">kubectl edit configmap wework-service</span><br><span class="line">:wq</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># -------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ‰§è¡Œæ›´æ–°è„šæœ¬</span></span><br><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># è¯»å–å‚æ•°</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">    pod_name=<span class="hljs-variable">$1</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"usage: ./restart.sh pod-name\n e.g.  ./restart.sh wework-service"</span></span><br><span class="line">    <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯å®¹å™¨</span></span><br><span class="line">pod_id=$(kubectl get pods | grep <span class="hljs-string">"<span class="hljs-variable">$&#123;pod_name&#125;</span>"</span> | awk <span class="hljs-string">'&#123;print $1&#125;'</span>)</span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$pod_id</span>"</span> == <span class="hljs-string">""</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">"pod not found!"</span></span><br><span class="line">   <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">"restarting <span class="hljs-variable">$&#123;pod_name&#125;</span>... "</span></span><br><span class="line">kubectl delete pod <span class="hljs-string">"<span class="hljs-variable">$&#123;pod_id&#125;</span>"</span> &gt; restart.log &amp;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># å¥åº·æ£€æŸ¥</span></span><br><span class="line">PID=$!</span><br><span class="line">marks=( <span class="hljs-string">'/'</span> <span class="hljs-string">'-'</span> <span class="hljs-string">'\'</span> <span class="hljs-string">'|'</span> )</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span> s=$(ps -p <span class="hljs-variable">$PID</span> -o s=) &amp;&amp; [[ <span class="hljs-string">"<span class="hljs-variable">$s</span>"</span> &amp;&amp; <span class="hljs-string">"<span class="hljs-variable">$s</span>"</span> != <span class="hljs-string">'Z'</span> ]]; <span class="hljs-keyword">do</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -ne <span class="hljs-string">"\b<span class="hljs-variable">$&#123;marks[i++ % $&#123;#marks[@]&#125;</span>]&#125;"</span>;</span><br><span class="line">    sleep 0.5</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"></span><br><span class="line">output=$(cat restart.log)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$output</span>"</span> == <span class="hljs-string">"<span class="hljs-variable">$pod_id</span>"</span> ]</span><br><span class="line"><span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\b\e[32mDone.\033[0m"</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\b\e[31mFailed!\033[0m"</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$output</span>"</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°é•œåƒ-1"><a href="#æ›´æ–°é•œåƒ-1" class="headerlink" title="æ›´æ–°é•œåƒ"></a>æ›´æ–°é•œåƒ</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># é•œåƒè·å–</span></span><br><span class="line"><span class="hljs-comment"># 1. å…ˆä»æœ¬åœ°ä»“åº“æŸ¥æ‰¾ï¼ˆå¦‚æœä¸èƒ½pingé€šå…¬å¸çš„ä»“åº“ï¼Œéœ€è¦ä¸‹è½½â†’ä¿å­˜â†’ä¸Šä¼ â†’åŠ è½½æµç¨‹ï¼‰</span></span><br><span class="line"><span class="hljs-comment"># 2. å†ä»è¿œç¨‹ä»“åº“ä¸‹è½½ï¼ˆå¦‚æœå¯ä»¥pingé€šå…¬å¸çš„ä»“åº“ï¼Œå¯ä»¥ç›´æ¥è®©è„šæœ¬è·‘ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># -------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç™»å½•ä¸­è½¬æœºå™¨</span></span><br><span class="line">docker pull pub/wework-service:0.0.0-dev.1.xxxxxxx</span><br><span class="line">docker tag pub/wework-service:0.0.0-dev.1.xxxxxxx pri/wework-service:0.0.0-dev.1.xxxxxxx</span><br><span class="line">docker push pri/wework-service:0.0.0-dev.1.xxxxxxx</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç™»å½•è”è°ƒæœºå™¨</span></span><br><span class="line">kubectl <span class="hljs-built_in">set</span> image deploy/wework-service wework-service=pri/wework-service:0.0.0-dev.1.xxxxxxx</span><br></pre></td></tr></table></figure><h1 id="å ¡å’æœºå’Œéš§é“æœº"><a href="#å ¡å’æœºå’Œéš§é“æœº" class="headerlink" title="å ¡å’æœºå’Œéš§é“æœº"></a><strong>å ¡å’æœºå’Œéš§é“æœº</strong></h1><h2 id="è®¿é—®æœåŠ¡-2"><a href="#è®¿é—®æœåŠ¡-2" class="headerlink" title="è®¿é—®æœåŠ¡"></a>è®¿é—®æœåŠ¡</h2><blockquote><p><strong>æ‰€è°“éš§é“ä»£ç†ï¼Œå°±æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè‡ªåŠ¨æ›´æ¢ä»£ç†åœ°å€çš„ä»£ç†æœåŠ¡ï¼ˆlocal â†’ remoteï¼‰ã€‚</strong>è¯¥éš§é“æœºå¯¹ local å’Œ remote å‡ç½‘ç»œäº’é€šï¼Œä½†æ˜¯ local å’Œ remote ä¹‹é—´ç½‘ç»œä¸é€šã€‚</p></blockquote><ol><li>ç™»å½•éš§é“æœº</li><li>é…ç½®è½¬å‘è§„åˆ™</li><li>é€‰ä¸åˆ†é…ç»ˆç«¯</li><li>é…ç½® hosts æ–‡ä»¶ï¼š<code>127.0.0.1 web.test.wework.com</code></li><li>æ‰“å¼€éš§é“æœº</li><li>è®¿é—® web æœåŠ¡ï¼š<a href="http://web.test.wework.com" target="_blank" rel="noopener">http://web.test.wework.com</a></li></ol><h2 id="æ›´æ–°æœåŠ¡-3"><a href="#æ›´æ–°æœåŠ¡-3" class="headerlink" title="æ›´æ–°æœåŠ¡"></a>æ›´æ–°æœåŠ¡</h2><blockquote><p><strong>è·³æ¿æœºå±äºå†…æ§å ¡å’æœºèŒƒç•´ï¼Œæ˜¯ä¸€ç§ç”¨äºå•ç‚¹ç™»é™†çš„ä¸»æœºåº”ç”¨ç³»ç»Ÿã€‚</strong>å¼€å‘æœºç›´è¿å…¬å¸çš„å†…ç½‘ï¼Œè·³æ¿æœºç›´è¿å®éªŒå®¤å†…ç½‘ã€‚</p></blockquote><ol><li><p>ç™»å½•å¼€å‘æœº</p></li><li><p>ä¸‹è½½é•œåƒå¹¶ä¿å­˜é•œåƒ</p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line">docker_service_name=<span class="hljs-variable">$1</span></span><br><span class="line">service_tag=<span class="hljs-variable">$2</span></span><br><span class="line"><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$#</span> -lt 2 ]];<span class="hljs-keyword">then</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">"please input two param for docker_service_name and service_tag. eg: wework-service 0.0.0-dev.1.xxxxxxx"</span></span><br><span class="line">    <span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line">docker pull <span class="hljs-variable">$1</span>:<span class="hljs-variable">$2</span></span><br><span class="line">IFS=<span class="hljs-string">" "</span> <span class="hljs-built_in">read</span> -r -a values &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$&#123;docker_service_name//\// &#125;</span>"</span></span><br><span class="line">service_name=<span class="hljs-variable">$&#123;values[$[$&#123;#values[@]&#125;</span>-1]]&#125;</span><br><span class="line">docker save -o <span class="hljs-variable">$&#123;service_name&#125;</span>_<span class="hljs-variable">$&#123;service_tag//./-&#125;</span>.tar <span class="hljs-variable">$1</span>:<span class="hljs-variable">$2</span></span><br></pre></td></tr></table></figure></li><li><p><code>sz ${wework-service-image}.tar</code> åˆ°æœ¬åœ°</p></li><li><p>ç™»å½•è·³æ¿æœº</p></li><li><p>ä»æœ¬åœ° <code>rz</code></p></li><li><p>ä¸Šä¼ é•œåƒå¹¶åŠ è½½é•œåƒ</p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load -i <span class="hljs-variable">$&#123;wework-service-image&#125;</span>.tar</span><br></pre></td></tr></table></figure></li><li><p>æ‰§è¡Œæ›´æ–°æœåŠ¡è„šæœ¬</p></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦è®°å½•å·¥ä½œä¸­æœåŠ¡å¸¸è§çš„éƒ¨ç½²æ–¹å¼ï¼Œæ—¨åœ¨äº cover æ—¥å¸¸çš„ &lt;code&gt;CI/CD&lt;/code&gt; åœºæ™¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¿›ç¨‹+å•æœº&lt;/strong&gt;ï¼š&lt;code&gt;systemctl&lt;/code&gt; + &lt;code&gt;rpm&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨+å•æœº&lt;/strong&gt;ï¼š&lt;code&gt;docker-compose&lt;/code&gt; + &lt;code&gt;image&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¹å™¨+é›†ç¾¤&lt;/strong&gt;ï¼š&lt;code&gt;k8s&lt;/code&gt; + &lt;code&gt;image&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="DevOps" scheme="http://yoursite.com/categories/DevOps/"/>
    
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
    <category term="Kubernetes" scheme="http://yoursite.com/tags/Kubernetes/"/>
    
    <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>#Unit Test# Unit Test Pre-study and Practice in Golang</title>
    <link href="http://yoursite.com/2021/08/16/Unit%20Test%20Pre-study%20and%20Practice%20in%20Golang/"/>
    <id>http://yoursite.com/2021/08/16/Unit%20Test%20Pre-study%20and%20Practice%20in%20Golang/</id>
    <published>2021-08-15T23:00:21.000Z</published>
    <updated>2021-08-16T15:20:06.038Z</updated>
    
    <content type="html"><![CDATA[<p>If you write code, write tests. <em>â€“ The Way of Testivus</em></p><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a><strong>èƒŒæ™¯</strong></h2><blockquote><p>å•å…ƒæµ‹è¯•çš„é‡è¦æ€§æ— éœ€å¤šè¨€ï¼Œä½†æ˜¯ç”±äºä¸šåŠ¡è¿­ä»£å¾—è¶…å¿«ï¼Œå°±å¾ˆéš¾å†åˆ†å‡ºæ—¶é—´å’Œç²¾åŠ›æŠ•å…¥åˆ°è´¨é‡ä¿éšœä¸­å»ã€‚<strong>å°½ç®¡å¦‚æ­¤ï¼Œç­‰å¾…æ¥å£è”è°ƒçš„è¿‡ç¨‹ä¸­æ—¢æ¼«é•¿æ— æ¯”åˆå‹åŠ›å±±å¤§ï¼ˆæ¯•ç«Ÿè°æƒ³è¢«æŒ‚ Tapd Bug å•å‘¢ <em>_(:Ğ·ã€âˆ )_</em></strong></p><p>åœ¨ä¹‹å‰çš„ <a href="https://lottewong.github.io/2020/11/19/Unit%20Test%20Pre-study%20and%20Practice%20in%20Python/" target="_blank" rel="noopener">Unit Test Pre-study and Practice in Python</a> æ–‡ç« ä¸­ï¼Œå·²ç»ç®€è¦åœ°ä»‹ç»äº†æµ‹è¯•æµç¨‹å’Œæµ‹è¯•ç”¨ä¾‹çš„æ ¸å¿ƒç†å¿µï¼Œæœ¬æ–‡å°†æ²¿ç”¨è¿™äº›æ–¹æ³•è®ºä»¥åŠç»“åˆå„ä½å¤§ç¥çš„åšå®¢å’Œæ—¥å¸¸å·¥ä½œçš„ä½“éªŒï¼Œç€é‡è®¨è®ºä»¥ä¸‹å†…å®¹ï¼š</p><ul><li><strong>æŠ€æœ¯é€‰å‹</strong>ï¼š<code>Golang</code> ä½œä¸ºä¸€é—¨é™æ€å’Œå¼ºç±»å‹è¯­è¨€ï¼Œç›¸æ¯”äº <code>Python</code> çš„åŠ¨æ€å’Œå¼±ç±»å‹ç‰¹æ€§ï¼Œå¸¦æ¥äº†ä¸€äº›æ–°çš„æŒ‘æˆ˜ã€‚</li><li><strong>å·¥ç¨‹å®è·µ</strong>ï¼šä¸šåŠ¡é€»è¾‘å¿«é€ŸéªŒè¯çš„æœ€ä½³å®è·µï¼Œæš‚æ—¶ä¸æ¶‰åŠè„šæ‰‹æ¶è®¾è®¡ã€‚</li></ul></blockquote><hr><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a><strong>æŠ€æœ¯é€‰å‹</strong></h2><h3 id="å•æµ‹æ¡†æ¶"><a href="#å•æµ‹æ¡†æ¶" class="headerlink" title="å•æµ‹æ¡†æ¶"></a>å•æµ‹æ¡†æ¶</h3><h4 id="testing"><a href="#testing" class="headerlink" title="testing"></a>testing</h4><blockquote><p>å®˜æ–¹åŸç”Ÿåº“ï¼Œæ— æ–­è¨€æœºåˆ¶ï¼Œç¼–å†™è¾ƒç¹çã€‚</p></blockquote><ol><li><p><strong>ç¼–å†™</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoSomething</span><span class="hljs-params">()</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestDoSomething</span><span class="hljs-params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">// Arrange</span></span><br><span class="line">   <span class="hljs-comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Act</span></span><br><span class="line">    err := DoSomething()</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Assert</span></span><br><span class="line">    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;</span><br><span class="line">        t.Errorf(err.Error())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>è¿è¡Œ</strong></p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go <span class="hljs-built_in">test</span> -v</span><br></pre></td></tr></table></figure></li></ol><h4 id="GoConvey"><a href="#GoConvey" class="headerlink" title="GoConvey"></a>GoConvey</h4><blockquote><p>å…¼å®¹å®˜æ–¹åŸç”Ÿåº“å’Œæ¨¡æ‹Ÿæ¡†æ¶ï¼Œæœ‰æ–­è¨€æœºåˆ¶ï¼Œç¼–å†™è¾ƒç®€æ´ã€‚</p></blockquote><ol><li><p><strong>ç¼–å†™</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoSomething</span><span class="hljs-params">()</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestDoSomething</span><span class="hljs-params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    Convey(<span class="hljs-string">"TestDoSomething"</span>, t, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">        Convey(<span class="hljs-string">"Condition 1"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;</span><br><span class="line">            <span class="hljs-comment">// Arrange</span></span><br><span class="line">            <span class="hljs-comment">// ...</span></span><br><span class="line">            </span><br><span class="line">            <span class="hljs-comment">// Act</span></span><br><span class="line">            err := DoSomething()</span><br><span class="line">            </span><br><span class="line">            <span class="hljs-comment">// Assert</span></span><br><span class="line">            So(err, ShouldBeNil)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>è¿è¡Œ</strong></p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Cmd</span></span><br><span class="line">go <span class="hljs-built_in">test</span> -v</span><br><span class="line"><span class="hljs-comment"># Web</span></span><br><span class="line"><span class="hljs-variable">$GOPATH</span>/bin/goconvey</span><br></pre></td></tr></table></figure></li></ol><h3 id="æ¨¡æ‹Ÿæ¡†æ¶"><a href="#æ¨¡æ‹Ÿæ¡†æ¶" class="headerlink" title="æ¨¡æ‹Ÿæ¡†æ¶"></a>æ¨¡æ‹Ÿæ¡†æ¶</h3><h4 id="GoMonkey"><a href="#GoMonkey" class="headerlink" title="GoMonkey"></a>GoMonkey</h4><blockquote><p>Mock å…¨å±€å˜é‡ &amp; å‡½æ•°æ–¹æ³•</p></blockquote><ol><li><p><strong>å…¨å±€å˜é‡</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">patches := ApplyFuncVar(&amp;funcVar, mockVar)</span><br><span class="line"><span class="hljs-keyword">defer</span> patches.Reset()</span><br><span class="line"></span><br><span class="line">patches := ApplyGlobalVar(&amp;funcVar, mockVar)</span><br><span class="line"><span class="hljs-keyword">defer</span> patches.Reset()</span><br></pre></td></tr></table></figure></li><li><p><strong>å‡½æ•°æ–¹æ³•</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">patches := ApplyFunc(funcName, mockFunc)</span><br><span class="line"><span class="hljs-keyword">defer</span> patches.Reset()</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">var</span> ptr *SomeClass</span><br><span class="line">patches := ApplyMethod(reflect.TypeOf(ptr), <span class="hljs-string">"methodName"</span>, mockMethod)</span><br><span class="line"><span class="hljs-keyword">defer</span> patches.Reset()</span><br></pre></td></tr></table></figure></li></ol><h4 id="GoMock"><a href="#GoMock" class="headerlink" title="GoMock"></a>GoMock</h4><blockquote><p>Mock æ¥å£</p></blockquote><ol><li><p><strong>ç”Ÿæˆ</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// repository.go</span></span><br><span class="line"><span class="hljs-comment">// Repository is the interface to be mocked</span></span><br><span class="line"><span class="hljs-keyword">type</span> Repository <span class="hljs-keyword">interface</span> &#123;</span><br><span class="line">    Create(val <span class="hljs-keyword">interface</span>&#123;&#125;) error</span><br><span class="line">    Get(key <span class="hljs-keyword">string</span>) (<span class="hljs-keyword">interface</span>&#123;&#125;, error)</span><br><span class="line">    Update(key <span class="hljs-keyword">string</span>, val <span class="hljs-keyword">interface</span>&#123;&#125;) error</span><br><span class="line">    Delete(key <span class="hljs-keyword">string</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// mockgen -source=$&#123;file&#125;</span></span><br><span class="line"><span class="hljs-comment">// mockgen $&#123;package&#125; $&#123;interface1&#125;, ... , $&#123;interfaceN&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// mock_repository.go</span></span><br><span class="line"><span class="hljs-comment">// MockRepository is a mock of Repository interface</span></span><br><span class="line"><span class="hljs-keyword">type</span> MockRepository <span class="hljs-keyword">struct</span> &#123;</span><br><span class="line">    ctrl     *gomock.Controller</span><br><span class="line">    recorder *MockRepositoryMockRecorder</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// MockRepositoryMockRecorder is the mock recorder for MockRepository</span></span><br><span class="line"><span class="hljs-keyword">type</span> MockRepositoryMockRecorder <span class="hljs-keyword">struct</span> &#123;</span><br><span class="line">    mock *MockRepository</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// NewMockRepository creates a new mock instance</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewMockRepository</span><span class="hljs-params">(ctrl *gomock.Controller)</span> *<span class="hljs-title">MockRepository</span></span> &#123;</span><br><span class="line">    mock := &amp;MockRepository&#123;ctrl: ctrl&#125;</span><br><span class="line">    mock.recorder = &amp;MockRepositoryMockRecorder&#123;mock&#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> mock</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// EXPECT returns an object that allows the caller to indicate expected use</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(_m *MockRepository)</span> <span class="hljs-title">EXPECT</span><span class="hljs-params">()</span> *<span class="hljs-title">MockRepositoryMockRecorder</span></span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> _m.recorder</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Create mocks base method</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(_m *MockRepository)</span> <span class="hljs-title">Create</span><span class="hljs-params">(_param0 []<span class="hljs-keyword">byte</span>)</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Get mocks base method</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(_m *MockRepository)</span> <span class="hljs-title">Get</span><span class="hljs-params">(_param0 <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(<span class="hljs-keyword">interface</span>&#123;&#125;, error)</span></span> &#123;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Update mocks base method</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(_m *MockRepository)</span> <span class="hljs-title">Update</span><span class="hljs-params">(_param0 <span class="hljs-keyword">string</span>, _param1 <span class="hljs-keyword">interface</span>&#123;&#125;)</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Delete mocks base method</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(_m *MockRepository)</span> <span class="hljs-title">Delete</span><span class="hljs-params">(_param0 <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">error</span></span> &#123;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨</strong></p><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ctrl := gomock.NewController(t)</span><br><span class="line"><span class="hljs-keyword">defer</span> ctrl.Finish()</span><br><span class="line">mockRepo := mock_repo.NewMockRepository(ctrl)</span><br><span class="line"></span><br><span class="line">InOrder (</span><br><span class="line">createCall := mockRepo.EXPECT().Create(mockVal).Return(mockErr)</span><br><span class="line">    getCall := mockRepo.EXPECT().Get(mockKey).Return(mockVal, mockErr).Times(<span class="hljs-number">7</span>)</span><br><span class="line">updateCall := mockRepo.EXPECT().Update(mockKey, mockVal).Return(mockErr)</span><br><span class="line">deleteCall := mockRepo.EXPECT().Create(mockKey).Return(mockErr)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ol><h4 id="sqlmock"><a href="#sqlmock" class="headerlink" title="sqlmock"></a>sqlmock</h4><blockquote><p>Mock æ•°æ®åº“</p></blockquote><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Arrange</span></span><br><span class="line">db, mock, err := sqlmock.New()</span><br><span class="line"><span class="hljs-keyword">defer</span> db.Close()</span><br><span class="line"></span><br><span class="line">rows := sqlmock.NewRows(colKeys).AddRow(colVals)</span><br><span class="line">mock.ExpectQuery(sqlStatement).WillReturnRows(rows)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Act</span></span><br><span class="line">res, err := db.Query(sqlStatement)</span><br><span class="line"><span class="hljs-keyword">defer</span> res.Close()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Assert</span></span><br><span class="line"><span class="hljs-keyword">for</span> res.Next() &#123;</span><br><span class="line">    res.Scan(&amp;fileds)</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="httptest"><a href="#httptest" class="headerlink" title="httptest"></a>httptest</h4><blockquote><p>Mock æœåŠ¡å™¨</p></blockquote><figure class="highlight go hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// Arrange</span></span><br><span class="line">r := httptest.NewRequest(method, url, <span class="hljs-literal">nil</span>)</span><br><span class="line">w := httptest.NewRecorder()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Act</span></span><br><span class="line">handler(w, r)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Assert</span></span><br><span class="line">res := w.Result()</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br></pre></td></tr></table></figure><h2 id="å·¥ç¨‹å®è·µ"><a href="#å·¥ç¨‹å®è·µ" class="headerlink" title="å·¥ç¨‹å®è·µ"></a><strong>å·¥ç¨‹å®è·µ</strong></h2><ul><li><em>to be continuedâ€¦</em></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><ul><li><p><strong>å•æµ‹æ¡†æ¶</strong>ç”¨äº<strong>æ–­è¨€</strong>ï¼šä½¿ç”¨ <code>GoConvey</code> æ¡†æ¶ã€‚</p></li><li><p><strong>æ¨¡æ‹Ÿæ¡†æ¶</strong>ç”¨äº<strong>æ›¿æ¢</strong>ï¼šå¯¹äºå…¨å±€å˜é‡å’Œå‡½æ•°æ–¹æ³•ä½¿ç”¨ <code>GoMonkey</code> æ¡†æ¶ï¼Œå¯¹äºæ¥å£ä½¿ç”¨ <code>GoMock</code> æ¡†æ¶ï¼Œå¯¹äºæ•°æ®åº“ä½¿ç”¨ <code>sqlmock</code> æ¡†æ¶ï¼Œå¯¹äºæœåŠ¡å™¨ä½¿ç”¨ <code>httptest</code> æ¡†æ¶ã€‚</p></li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a><strong>å‚è€ƒé“¾æ¥</strong></h2><blockquote><p>ä»¥ä¸‹æ–‡ç« å¯¹æœ¬æ–‡äº¦æœ‰è´¡çŒ® :)</p></blockquote><ul><li><a href="http://no_permission_for_oa_article" target="_blank" rel="noopener">å•å…ƒæµ‹è¯•æˆç¥ä¹‹è·¯â€”â€”Golangç¯‡</a></li><li><a href="http://no_permission_for_oa_article" target="_blank" rel="noopener">Golangå•å…ƒæµ‹è¯•è°ƒç ”å’Œå®è·µ</a></li></ul><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a><strong>é™„å½•</strong></h2><blockquote><p>ä½¿ç”¨æ–‡æ¡£å’Œæœ€ä½³å®è·µ :)</p></blockquote><ul><li><a href="https://books.studygolang.com/The-Golang-Standard-Library-by-Example/chapter09/09.1.html" target="_blank" rel="noopener">testingçš„æ›´å¤šç”¨æ³•</a></li><li><a href="https://www.jianshu.com/p/e3b2b1194830" target="_blank" rel="noopener">GoConveyçš„æ›´å¤šç”¨æ³•</a></li><li><a href="https://blog.csdn.net/u013276277/article/details/104993370" target="_blank" rel="noopener">GoMonkeyçš„æ›´å¤šç”¨æ³•</a></li><li><a href="https://www.jianshu.com/p/f4e773a1b11f" target="_blank" rel="noopener">GoMockçš„æ›´å¤šç”¨æ³•</a></li><li><a href="https://studygolang.com/articles/27670" target="_blank" rel="noopener">sqlmockçš„æ›´å¤šç”¨æ³•</a></li><li><a href="https://tkstorm.com/posts-list/programming/go/refs/go-httptest/" target="_blank" rel="noopener">httptestçš„æ›´å¤šç”¨æ³•</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;If you write code, write tests. &lt;em&gt;â€“ The Way of Testivus&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="QA" scheme="http://yoursite.com/categories/QA/"/>
    
    
    <category term="GoConvey" scheme="http://yoursite.com/tags/GoConvey/"/>
    
    <category term="GoMonkey" scheme="http://yoursite.com/tags/GoMonkey/"/>
    
    <category term="GoMock" scheme="http://yoursite.com/tags/GoMock/"/>
    
  </entry>
  
  <entry>
    <title>#Others# GoLand + WSL çš„æœ¬åœ°å¼€å‘ä¸è°ƒè¯•</title>
    <link href="http://yoursite.com/2021/08/14/GoLand%20+%20WSL%20%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E4%B8%8E%E8%B0%83%E8%AF%95/"/>
    <id>http://yoursite.com/2021/08/14/GoLand%20+%20WSL%20%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E4%B8%8E%E8%B0%83%E8%AF%95/</id>
    <published>2021-08-13T23:21:00.000Z</published>
    <updated>2022-02-07T10:59:45.268Z</updated>
    
    <content type="html"><![CDATA[<ul><li><code>GoLand</code> as <code>IDE</code></li><li><code>WSL2</code> as <code>go run/go build environment</code></li></ul><hr><a id="more"></a><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h1><blockquote><p>æœ€è¿‘ç”³è¯·äº†ä¸€å°æ–°çš„å¼€å‘æœºæ‰“ç®—æ£é¼“ä¸€ä¸‹ï¼ˆï¼ˆï¼ˆç¦»æˆ‘å®Œç¾çš„å·¥ä½œç¯å¢ƒå°±å·®æ¬å»å‰æµ·å¤§å¦å’Œç¬¬äºŒä¸ªæ˜¾ç¤ºå±äº†æƒ¹ å˜¿å˜¿ :P</p></blockquote><h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a><strong>ç¯å¢ƒå‡†å¤‡</strong></h1><h2 id="æœ¬åœ°ç¯å¢ƒ"><a href="#æœ¬åœ°ç¯å¢ƒ" class="headerlink" title="æœ¬åœ°ç¯å¢ƒ"></a>æœ¬åœ°ç¯å¢ƒ</h2><ol><li>GoLand 2021.2.1 Beta</li></ol><h2 id="è¿œç¨‹ç¯å¢ƒ"><a href="#è¿œç¨‹ç¯å¢ƒ" class="headerlink" title="è¿œç¨‹ç¯å¢ƒ"></a>è¿œç¨‹ç¯å¢ƒ</h2><ol><li>Goï¼ˆ<a href="https://learnku.com/go/t/47176" target="_blank" rel="noopener">å®‰è£…æŒ‡å—</a>ï¼‰</li><li>Dockerï¼ˆ<a href="https://zhuanlan.zhihu.com/p/148511634" target="_blank" rel="noopener">å®‰è£…æŒ‡å—</a>ï¼‰</li><li>Ubuntu WSL2ï¼ˆ<a href="https://segmentfault.com/a/1190000040143442" target="_blank" rel="noopener">å®‰è£…æŒ‡å—</a>ï¼‰</li></ol><h1 id="WSLé…ç½®"><a href="#WSLé…ç½®" class="headerlink" title="WSLé…ç½®"></a>WSLé…ç½®</h1><h2 id="é…ç½®é»˜è®¤ç‰ˆæœ¬"><a href="#é…ç½®é»˜è®¤ç‰ˆæœ¬" class="headerlink" title="é…ç½®é»˜è®¤ç‰ˆæœ¬"></a>é…ç½®é»˜è®¤ç‰ˆæœ¬</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># æŒ‡å®šé»˜è®¤ç‰ˆæœ¬</span></span><br><span class="line">wslconfig /list</span><br><span class="line">wslconfig /setdefault ubuntu</span><br><span class="line">wsl -l -v</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># å‡çº§WSL2ç‰ˆæœ¬</span></span><br><span class="line">wsl --<span class="hljs-built_in">set</span>-default-version 2</span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶èµ„æºä½¿ç”¨"><a href="#é™åˆ¶èµ„æºä½¿ç”¨" class="headerlink" title="é™åˆ¶èµ„æºä½¿ç”¨"></a>é™åˆ¶èµ„æºä½¿ç”¨</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Step 1ï¼šåœ¨ C:\Users\$&#123;user&#125; ä¸­åˆ›å»º .wslconfig æ–‡ä»¶</span></span><br><span class="line">[wsl2]</span><br><span class="line">processors=4</span><br><span class="line">memory=8GB</span><br><span class="line">swap=8GB</span><br><span class="line">localhostForwarding=<span class="hljs-literal">true</span></span><br><span class="line"><span class="hljs-comment"># Step 2ï¼šé‡å¯ WSL2</span></span><br><span class="line">wsl --shutdown</span><br><span class="line"><span class="hljs-comment"># Step 3ï¼šé‡å¯ Docker Desktop</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®å…±äº«ç›®å½•"><a href="#é…ç½®å…±äº«ç›®å½•" class="headerlink" title="é…ç½®å…±äº«ç›®å½•"></a>é…ç½®å…±äº«ç›®å½•</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /mnt/f/ubuntu ~/windows</span><br></pre></td></tr></table></figure><h1 id="GoLandé…ç½®"><a href="#GoLandé…ç½®" class="headerlink" title="GoLandé…ç½®"></a><strong>GoLandé…ç½®</strong></h1><h2 id="DEBUG-on-WSL"><a href="#DEBUG-on-WSL" class="headerlink" title="DEBUG on WSL"></a>DEBUG on WSL</h2><p><img src="/images/wsl_go_build_config.png" alt="WSL Go Build Config"></p><p><img src="/images/wsl_new_target_config_step_1.png" alt="WSL New Target Config Step 1"></p><p><img src="/images/wsl_new_target_config_step_2.png" alt="WSL New Target Config Step 2"></p><h2 id="DEBUG-on-SSH"><a href="#DEBUG-on-SSH" class="headerlink" title="DEBUG on SSH"></a>DEBUG on SSH</h2><p><img src="/images/ssh_go_build_config.png" alt="SSH Go Build Config"></p><p><img src="/images/ssh_new_target_config_step_1.png" alt="SSH New Target Config Step 1"></p><p><img src="/images/ssh_new_target_config_step_2.png" alt="SSH New Target Config Step 2"></p><p><img src="/images/ssh_new_target_config_step_3.png" alt="SSH New Target Config Step 3"></p><p><img src="/images/ssh_new_target_config_step_4.png" alt="SSH New Target Config Step 4"></p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a><strong>å‚è€ƒæ–‡çŒ®</strong></h1><ol><li><a href="https://hangzhi.github.io/2021/06/24/wsl2GolandThanosDev/" target="_blank" rel="noopener">ä½¿ç”¨ WSL2 + Goland è¿›è¡Œ Go é¡¹ç›®ï¼ˆThanosï¼‰å¼€å‘åŠæµ‹è¯•</a></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GoLand&lt;/code&gt; as &lt;code&gt;IDE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WSL2&lt;/code&gt; as &lt;code&gt;go run/go build environment&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Others" scheme="http://yoursite.com/categories/Others/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
    <category term="WSL" scheme="http://yoursite.com/tags/WSL/"/>
    
  </entry>
  
  <entry>
    <title>#Others# GoLand + DevCloud çš„è¿œç¨‹å¼€å‘ä¸è°ƒè¯•</title>
    <link href="http://yoursite.com/2021/08/12/GoLand%20+%20DevCloud%20%E7%9A%84%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91%E4%B8%8E%E8%B0%83%E8%AF%95/"/>
    <id>http://yoursite.com/2021/08/12/GoLand%20+%20DevCloud%20%E7%9A%84%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91%E4%B8%8E%E8%B0%83%E8%AF%95/</id>
    <published>2021-08-11T23:21:00.000Z</published>
    <updated>2021-08-12T16:02:49.916Z</updated>
    
    <content type="html"><![CDATA[<ul><li><code>GoLand</code> as <code>IDE</code></li><li><code>DevCloud</code> as <code>go run/go build/dlv debug</code> environment</li></ul><hr><a id="more"></a><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h1><blockquote><p>ç¼˜èµ·ä¸€ä¸ª <code>EOF</code> é”™è¯¯ï¼Œç”±äºç½‘ç»œç­–ç•¥åŸå› ï¼Œæœ¬åœ°å¼€å‘æœºæ— æ³•è¿æ¥æŸä¸ªå†…ç½‘æœåŠ¡ï¼Œé‚è½¬å‘åœ¨åŠå…¬ç½‘å†…çš„è¿œç¨‹æœåŠ¡å™¨ã€‚<del>æœ¬äººä½œä¸º Linux å°èœ</del>ï¼Œç”±æ­¤äº§ç”Ÿäº†ä¸€ä¸ªæ–°è¯‰æ±‚ï¼š<strong>åœ¨ Windows ä¸Šè¿œç¨‹å¼€å‘å’Œè°ƒè¯•æœåŠ¡å™¨çš„ä»£ç ï¼Œå……åˆ†åœ°å‘æŒ¥ IDE çš„å¼ºå¤§ä½œç”¨ã€‚</strong> </p></blockquote><h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a><strong>ç¯å¢ƒå‡†å¤‡</strong></h1><h2 id="æœ¬åœ°ç¯å¢ƒ"><a href="#æœ¬åœ°ç¯å¢ƒ" class="headerlink" title="æœ¬åœ°ç¯å¢ƒ"></a>æœ¬åœ°ç¯å¢ƒ</h2><ol><li>GoLand 2020.2.3</li></ol><h2 id="è¿œç¨‹ç¯å¢ƒ"><a href="#è¿œç¨‹ç¯å¢ƒ" class="headerlink" title="è¿œç¨‹ç¯å¢ƒ"></a>è¿œç¨‹ç¯å¢ƒ</h2><ol><li>Go 1.16.6</li><li>Delve 1.7.0</li></ol><h1 id="é…ç½®-GoLand-è¿æ¥-DevCloud"><a href="#é…ç½®-GoLand-è¿æ¥-DevCloud" class="headerlink" title="é…ç½® GoLand è¿æ¥ DevCloud"></a><strong>é…ç½® GoLand è¿æ¥ DevCloud</strong></h1><h2 id="åˆ›å»º-Deployment-é…ç½®"><a href="#åˆ›å»º-Deployment-é…ç½®" class="headerlink" title="åˆ›å»º Deployment é…ç½®"></a>åˆ›å»º Deployment é…ç½®</h2><blockquote><p><code>Tools</code> -&gt; <code>Deployment</code> -&gt; <code>Configuration</code> -&gt; <code>+</code></p></blockquote><p><img src="/images/create_deployment_configuration.png" alt="åˆ›å»º Deployment é…ç½®"></p><h3 id="Connection-ç½‘ç»œè¿æ¥"><a href="#Connection-ç½‘ç»œè¿æ¥" class="headerlink" title="Connection - ç½‘ç»œè¿æ¥"></a>Connection - ç½‘ç»œè¿æ¥</h3><blockquote><ul><li><code>Type</code>ï¼šé€‰æ‹© <code>SFTP</code> åè®®</li><li><code>SSH configuration</code>ï¼šå¡«å†™ <code>Host</code> / <code>Port</code> / <code>User name</code> / <code>Password</code> ä¿¡æ¯ï¼Œé€šè¿‡ <code>Test Connection</code> éªŒè¯</li><li><code>Root path</code>ï¼šç‚¹å‡» <code>Autodetect</code> æŒ‰é’®</li><li><code>Web server URL</code>ï¼šæš‚æ—¶ä¸ç”¨è€ƒè™‘</li></ul></blockquote><p><img src="/images/config_connection_option.png" alt="é…ç½® Connection é€‰é¡¹"></p><h3 id="Mappings-å­˜å‚¨æ˜ å°„"><a href="#Mappings-å­˜å‚¨æ˜ å°„" class="headerlink" title="Mappings - å­˜å‚¨æ˜ å°„"></a>Mappings - å­˜å‚¨æ˜ å°„</h3><blockquote><ul><li><p><code>Local path</code>ï¼šæœ¬åœ°å¼€å‘æœºé¡¹ç›®ç›®å½•</p></li><li><p><code>Deployment path</code>ï¼šè¿œç¨‹æœåŠ¡å™¨é¡¹ç›®ç›®å½•</p></li><li><p><code>Web path</code>ï¼šæš‚æ—¶ä¸ç”¨è€ƒè™‘</p></li></ul></blockquote><p><img src="/images/config_mappings_option.png" alt="é…ç½® Mappings é€‰é¡¹"></p><h2 id="åˆ›å»º-Run-Debug-é…ç½®"><a href="#åˆ›å»º-Run-Debug-é…ç½®" class="headerlink" title="åˆ›å»º Run/Debug é…ç½®"></a>åˆ›å»º Run/Debug é…ç½®</h2><blockquote><p><code>Run</code> -&gt; <code>Edit Configurations</code> -&gt; <code>+</code> -&gt; <code>Go Remote</code></p></blockquote><p><img src="/images/create_run_and_debug_configuration.png" alt="åˆ›å»º Run/Debug é…ç½®"></p><blockquote><ul><li><p><code>Host</code>ï¼šè¿œç¨‹æœåŠ¡å™¨åœ°å€</p></li><li><p><code>Port</code>ï¼šDelve Port</p></li></ul></blockquote><p><img src="/images/config_go_remote_option.png" alt="é…ç½® Go Remote é€‰é¡¹"></p><h1 id="ç™»å½•ã€æŸ¥çœ‹å’ŒåŒæ­¥"><a href="#ç™»å½•ã€æŸ¥çœ‹å’ŒåŒæ­¥" class="headerlink" title="ç™»å½•ã€æŸ¥çœ‹å’ŒåŒæ­¥"></a><strong>ç™»å½•ã€æŸ¥çœ‹å’ŒåŒæ­¥</strong></h1><h2 id="ç™»å½•è¿œç¨‹æœåŠ¡å™¨"><a href="#ç™»å½•è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="ç™»å½•è¿œç¨‹æœåŠ¡å™¨"></a>ç™»å½•è¿œç¨‹æœåŠ¡å™¨</h2><blockquote><p><code>Tool</code> -&gt; <code>Start SSH Session</code></p></blockquote><p><img src="/images/start_ssh_session.png" alt="åˆ›å»º SSH ä¼šè¯"></p><h2 id="æŸ¥çœ‹è¿œç¨‹ç›®å½•æ ‘"><a href="#æŸ¥çœ‹è¿œç¨‹ç›®å½•æ ‘" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹ç›®å½•æ ‘"></a>æŸ¥çœ‹è¿œç¨‹ç›®å½•æ ‘</h2><blockquote><p><code>Tools</code> -&gt; <code>Deployment</code> -&gt; <code>Browse Remote Host</code></p></blockquote><p><img src="/images/browse_remote_host.png" alt="æŸ¥çœ‹ Remote Host ç›®å½•"></p><h2 id="åŒæ­¥æœ¬åœ°æ–‡ä»¶å¤¹"><a href="#åŒæ­¥æœ¬åœ°æ–‡ä»¶å¤¹" class="headerlink" title="åŒæ­¥æœ¬åœ°æ–‡ä»¶å¤¹"></a>åŒæ­¥æœ¬åœ°æ–‡ä»¶å¤¹</h2><blockquote><p><strong>æ‰‹åŠ¨</strong>ï¼š<code>Tools</code> -&gt; <code>Deployment</code> -&gt; <code>Sync with Deployed to DevCloud</code></p><p><strong>è‡ªåŠ¨</strong>ï¼š<code>Tools</code> -&gt; <code>Deployment</code> -&gt; <code>Automatic Upload (on explicit save)</code></p></blockquote><p><img src="/images/sync_to_or_automatic_upload.png" alt="æ‰‹åŠ¨ or è‡ªåŠ¨ Sync"></p><h1 id="éƒ¨ç½²ä¸è°ƒè¯•"><a href="#éƒ¨ç½²ä¸è°ƒè¯•" class="headerlink" title="éƒ¨ç½²ä¸è°ƒè¯•"></a><strong>éƒ¨ç½²ä¸è°ƒè¯•</strong></h1><h2 id="è¿œç¨‹æ‰§è¡Œéƒ¨ç½²è„šæœ¬"><a href="#è¿œç¨‹æ‰§è¡Œéƒ¨ç½²è„šæœ¬" class="headerlink" title="è¿œç¨‹æ‰§è¡Œéƒ¨ç½²è„šæœ¬"></a>è¿œç¨‹æ‰§è¡Œéƒ¨ç½²è„šæœ¬</h2><h3 id="ç¼–è¯‘è°ƒè¯•ä¸€èµ·"><a href="#ç¼–è¯‘è°ƒè¯•ä¸€èµ·" class="headerlink" title="ç¼–è¯‘è°ƒè¯•ä¸€èµ·"></a>ç¼–è¯‘è°ƒè¯•ä¸€èµ·</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dlv debug cmd/server/main.go --headless --listen=:2345 --api-version=2</span><br></pre></td></tr></table></figure><h3 id="å…ˆç¼–è¯‘å†è°ƒè¯•"><a href="#å…ˆç¼–è¯‘å†è°ƒè¯•" class="headerlink" title="å…ˆç¼–è¯‘å†è°ƒè¯•"></a>å…ˆç¼–è¯‘å†è°ƒè¯•</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go build -o cmd/server/demo.exe cmd/server/main.go</span><br><span class="line">dlv --listen=:2345 --headless=<span class="hljs-literal">true</span> --api-version=2 <span class="hljs-built_in">exec</span> cmd/server/demo.exe</span><br></pre></td></tr></table></figure><h3 id="è¿›ç¨‹åå°æ“ä½œ"><a href="#è¿›ç¨‹åå°æ“ä½œ" class="headerlink" title="è¿›ç¨‹åå°æ“ä½œ"></a>è¿›ç¨‹åå°æ“ä½œ</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nohup dlv debug cmd/server/main.go --headless --listen=:2345 --api-version=2 &gt;&gt; ./demo.log 2&gt;&amp;1 &amp; <span class="hljs-comment"># åå°å¯åŠ¨</span></span><br><span class="line">pkill -9 dlv <span class="hljs-comment"># åå°æš‚åœ</span></span><br></pre></td></tr></table></figure><h3 id="å®Œæ•´è„šæœ¬æ–‡ä»¶"><a href="#å®Œæ•´è„šæœ¬æ–‡ä»¶" class="headerlink" title="å®Œæ•´è„šæœ¬æ–‡ä»¶"></a>å®Œæ•´è„šæœ¬æ–‡ä»¶</h3><ul><li><p><strong>start.sh</strong></p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># set go env</span></span><br><span class="line"><span class="hljs-built_in">export</span> GO111MODULE=auto</span><br><span class="line"><span class="hljs-built_in">export</span> GOPROXY=https://goproxy.io,direct</span><br><span class="line">go mod tidy</span><br><span class="line">go mod vendor</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># kill processes already started</span></span><br><span class="line">pkill -9 dlv</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># run demo backgroud server</span></span><br><span class="line">nohup dlv debug cmd/server/main.go --headless --listen=:2345 --api-version=2 &gt;&gt; ./demo.log 2&gt;&amp;1 &amp;</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">'nohup dlv debug cmd/server/main.go --headless --listen=:2345 --api-version=2 &gt;&gt; ./demo.log 2&gt;&amp;1 &amp;'</span></span><br></pre></td></tr></table></figure></li><li><p><strong>stop.sh</strong></p><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># kill processes already started</span></span><br><span class="line">pkill -9 dlv</span><br></pre></td></tr></table></figure></li></ul><h2 id="æœ¬åœ°æ‰“å¼€è°ƒè¯•æ¨¡å¼"><a href="#æœ¬åœ°æ‰“å¼€è°ƒè¯•æ¨¡å¼" class="headerlink" title="æœ¬åœ°æ‰“å¼€è°ƒè¯•æ¨¡å¼"></a>æœ¬åœ°æ‰“å¼€è°ƒè¯•æ¨¡å¼</h2><p><img src="/images/debug_on_devcloud.png" alt="DEBUG on DevCloud"></p><blockquote><p><em>PSï¼šè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œ<code>go run</code> çš„æ—¶å€™è¿”å›æ•°æ®åˆ° <code>Postman</code>ï¼Œ<code>dlv debug</code> çš„æ—¶å€™è¿”å›æ•°æ®åˆ° <code>GoLand</code></em></p></blockquote><h1 id="å…·ä½“æµç¨‹"><a href="#å…·ä½“æµç¨‹" class="headerlink" title="å…·ä½“æµç¨‹"></a><strong>å…·ä½“æµç¨‹</strong></h1><ol><li>é…ç½®å¥½ <code>Deployment</code> å’Œ <code>Run/Debug</code></li><li>ä¿®æ”¹æœ¬åœ°ä»£ç æ–‡ä»¶ï¼Œæ‰‹åŠ¨æˆ–è‡ªåŠ¨åŒæ­¥å†…å®¹åˆ°è¿œç¨‹</li><li>ç™»å½•è¿œç¨‹æœåŠ¡å™¨ï¼Œä¸€é”®æ‰§è¡Œéƒ¨ç½²è„šæœ¬</li><li>æœ¬åœ°æ‰“å¥½æ–­ç‚¹ï¼Œå¼€å¯è°ƒè¯•æ¨¡å¼</li></ol><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a><strong>é™„å½•</strong></h1><h2 id="GoLand-Debug"><a href="#GoLand-Debug" class="headerlink" title="GoLand Debug"></a>GoLand Debug</h2><ol><li><strong>å¼€å¯è°ƒè¯•æ¨¡å¼</strong>ï¼š<code>Shift + F9</code></li><li><strong>æ‰“ä¸‹æ–­ç‚¹</strong>ï¼šç‚¹å‡» Code å·¦ä¾§</li><li><strong>æŸ¥çœ‹å˜é‡</strong>ï¼šæŸ¥çœ‹ Debug é¢æ¿</li><li><strong><code>Step Over</code></strong>ï¼š<code>F8</code></li><li><strong><code>Step Into</code></strong>ï¼š<code>F7</code></li><li><strong><code>Step Out</code></strong>ï¼š<code>Shift + F8</code></li><li><strong>ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„</strong>ï¼š<code>F9</code></li></ol><h2 id="Delve-Debug"><a href="#Delve-Debug" class="headerlink" title="Delve Debug"></a>Delve Debug</h2><ol><li><strong>å¼€å¯è°ƒè¯•æ¨¡å¼</strong>ï¼š<code>dlv debug main.go</code></li><li><strong>æ‰“ä¸‹æ–­ç‚¹</strong>ï¼š<code>break pkg.fn</code> æˆ– <code>break file:line</code></li><li><strong>æŸ¥çœ‹å˜é‡</strong>ï¼š<code>print var</code> æˆ– <code>args</code> æˆ– <code>locals</code></li><li><strong><code>Step Over</code></strong>ï¼š<code>next</code></li><li><strong><code>Step Into</code></strong>ï¼š<code>step</code></li><li><strong><code>Step Out</code></strong>ï¼š<code>stepout</code></li><li><strong>ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„</strong>ï¼š<code>continue</code></li></ol><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a><strong>å‚è€ƒæ–‡çŒ®</strong></h1><ol><li><a href="https://mojotv.cn/go/golang-remote_debug" target="_blank" rel="noopener">Goè¿›é˜¶36:Golandè¿œç¨‹å¼€å‘è°ƒè¯•</a></li><li><a href="https://blog.csdn.net/liuYinXinAll/article/details/103016871" target="_blank" rel="noopener">è§£å†³åœ¨golandä¸­é€šè¿‡dlvè¿œç¨‹è°ƒè¯•goç¨‹åºåæœåŠ¡ç«¯æ— æ³•é€€å‡º</a></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GoLand&lt;/code&gt; as &lt;code&gt;IDE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DevCloud&lt;/code&gt; as &lt;code&gt;go run/go build/dlv debug&lt;/code&gt; environment&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Others" scheme="http://yoursite.com/categories/Others/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>#Others# å’Œæ–°é¡¹ç›®ç›¸çˆ±ç›¸æ€</title>
    <link href="http://yoursite.com/2021/07/24/%E5%92%8C%E6%96%B0%E9%A1%B9%E7%9B%AE%E7%9B%B8%E7%88%B1%E7%9B%B8%E6%9D%80/"/>
    <id>http://yoursite.com/2021/07/24/%E5%92%8C%E6%96%B0%E9%A1%B9%E7%9B%AE%E7%9B%B8%E7%88%B1%E7%9B%B8%E6%9D%80/</id>
    <published>2021-07-23T23:21:00.000Z</published>
    <updated>2021-08-16T15:12:41.987Z</updated>
    
    <content type="html"><![CDATA[<p>å¤¸å¼ çš„ä¿®è¾æ‰‹æ³•.jpgï¼ˆï¼ˆï¼ˆ Happy 7*24 Day ğŸ¤Ÿ</p><hr><a id="more"></a><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h1><blockquote><p>æ¥ä½ ğŸ§æ­£å¼æ‰“å·¥ä¸çŸ¥ä¸è§‰å·²ç»åå¤©äº†ï¼Œæ¯”èµ·å®ä¹ çš„æ—¶å€™å·¥ä½œå†…å®¹å·²ç»å¤§æœ‰ä¸åŒï¼Œå†è§å·²æ˜¯<strong>å·¥å…·äººå°é»„bot</strong>ï¼ˆæ­¤å·¥å…·äººéå½¼å·¥å…·äººthxã€‚</p><p>ä»Šå¤©ä¸»è¦è®°å½•ä¸€ä¸‹ç†è§£å’Œç†Ÿæ‚‰æ–°é¡¹ç›®çš„è¿‡ç¨‹ï¼Œå¸Œæœ›åœ¨æœªæ¥æ¥è§¦æ–°ä¸šåŠ¡ä¹Ÿä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p></blockquote><h1 id="å‰ç½®æ¡ä»¶"><a href="#å‰ç½®æ¡ä»¶" class="headerlink" title="å‰ç½®æ¡ä»¶"></a><strong>å‰ç½®æ¡ä»¶</strong></h1><blockquote><p>æœ¬äººå¸èŒ <code>Golang</code> åå°å¼€å‘ï¼Œä¸‹é¢å†…å®¹ä»…ä¾›å‚è€ƒã€‚</p></blockquote><h2 id="ç¼–ç¨‹è¯­è¨€"><a href="#ç¼–ç¨‹è¯­è¨€" class="headerlink" title="ç¼–ç¨‹è¯­è¨€"></a>ç¼–ç¨‹è¯­è¨€</h2><ol><li><code>Golang</code>ï¼šä¸šåŠ¡å¼€å‘çš„ä¸»è¦è¯­è¨€</li><li><code>Shell</code>ï¼šå·¥å…·è¿ç»´çš„ä¸»è¦è¯­è¨€</li></ol><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><ol><li><code>Git</code>ã€<code>Linux</code></li><li>äº‘åŸç”Ÿã€é«˜å¹¶å‘ã€åˆ†å¸ƒå¼ã€å¾®æœåŠ¡</li><li>ç®—æ³•åˆ†æã€æ•°æ®ç»“æ„</li><li>è®¡ç®—æœºç½‘ç»œã€æ“ä½œç³»ç»Ÿã€æ•°æ®åº“æ¦‚è®º</li><li>è®¾è®¡æ¨¡å¼ã€è½¯ä»¶æ¶æ„</li><li>æ•æ·å¼€å‘ã€é¡¹ç›®ç®¡ç†</li></ol><h2 id="å¼€å‘æ¡†æ¶"><a href="#å¼€å‘æ¡†æ¶" class="headerlink" title="å¼€å‘æ¡†æ¶"></a>å¼€å‘æ¡†æ¶</h2><ol><li><code>gin</code>ï¼šåŸºäº API</li><li><code>go-micro</code>ï¼šåŸºäºå¾®æœåŠ¡</li></ol><h2 id="æ•°æ®åº“æ“ä½œåŠé©±åŠ¨"><a href="#æ•°æ®åº“æ“ä½œåŠé©±åŠ¨" class="headerlink" title="æ•°æ®åº“æ“ä½œåŠé©±åŠ¨"></a>æ•°æ®åº“æ“ä½œåŠé©±åŠ¨</h2><ol><li><code>MySQL</code>ï¼šå…³ç³»å‹æ•°æ®åº“</li><li><code>MongoDB</code>ï¼šæ–‡æ¡£å‹æ•°æ®åº“</li><li><code>Redis</code>ï¼šé”®å€¼å‹æ•°æ®åº“</li></ol><h2 id="å…¶å®ƒçš„ä¸­é—´ä»¶"><a href="#å…¶å®ƒçš„ä¸­é—´ä»¶" class="headerlink" title="å…¶å®ƒçš„ä¸­é—´ä»¶"></a>å…¶å®ƒçš„ä¸­é—´ä»¶</h2><ol><li>æ¶ˆæ¯é˜Ÿåˆ—</li><li>æ³¨å†Œä¸­å¿ƒ</li></ol><h2 id="ç›¸å…³ç³»ç»Ÿ"><a href="#ç›¸å…³ç³»ç»Ÿ" class="headerlink" title="ç›¸å…³ç³»ç»Ÿ"></a>ç›¸å…³ç³»ç»Ÿ</h2><ol><li><code>upstream</code>ï¼šå¯¹æ¥å†…éƒ¨äº§å“</li><li><code>downstream</code>ï¼šå‰ç«¯é¡¹ç›®</li></ol><h2 id="è¿­ä»£æµç¨‹"><a href="#è¿­ä»£æµç¨‹" class="headerlink" title="è¿­ä»£æµç¨‹"></a>è¿­ä»£æµç¨‹</h2><ol><li><code>Unit Test</code>ã€<code>Mock Test</code></li><li><code>Coding Standard</code></li><li><code>CI / CD</code></li></ol><h1 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a><strong>éœ€æ±‚åˆ†æ</strong></h1><blockquote><p>éœ€æ±‚åˆ†æé˜¶æ®µä¸»è¦æ˜¯ä»éœ€æ±‚å±‚é¢æ¥äº†è§£é¡¹ç›®ï¼Œ<strong>çŸ¥é“é¡¹ç›®åœ¨åšä»€ä¹ˆ</strong>ã€‚</p></blockquote><h2 id="å¯ç”¨èµ„äº§"><a href="#å¯ç”¨èµ„äº§" class="headerlink" title="å¯ç”¨èµ„äº§"></a>å¯ç”¨èµ„äº§</h2><ol><li>äº§å“æ‰‹å†Œ</li><li>äº§å“åŸå‹</li><li>éœ€æ±‚æ–‡æ¡£</li></ol><h2 id="é˜¶æ®µç›®æ ‡"><a href="#é˜¶æ®µç›®æ ‡" class="headerlink" title="é˜¶æ®µç›®æ ‡"></a>é˜¶æ®µç›®æ ‡</h2><ol><li>ç†è§£å’ŒåŒºåˆ†å…³é”®çš„<strong>é¢†åŸŸæ¦‚å¿µ</strong></li><li>æ˜ç¡®äº§å“çš„<strong>ä¸»è¦åŠŸèƒ½å’Œä¸»è¦æµç¨‹</strong></li></ol><h1 id="æ–¹æ¡ˆè®¾è®¡"><a href="#æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="æ–¹æ¡ˆè®¾è®¡"></a><strong>æ–¹æ¡ˆè®¾è®¡</strong></h1><blockquote><p>æ–¹æ¡ˆè®¾è®¡é˜¶æ®µä¸»è¦æ˜¯ä»æ–¹æ¡ˆå±‚é¢æ¥è§£æ„é¡¹ç›®ï¼Œ<strong>æ€è€ƒé¡¹ç›®è¯¥æ€ä¹ˆåš</strong>ã€‚</p></blockquote><h2 id="å¯ç”¨èµ„äº§-1"><a href="#å¯ç”¨èµ„äº§-1" class="headerlink" title="å¯ç”¨èµ„äº§"></a>å¯ç”¨èµ„äº§</h2><ol><li>æŠ€æœ¯æ–‡æ¡£</li><li>æ¥å£æ–‡æ¡£</li><li>æ•°æ®åº“è¡¨</li></ol><h2 id="é˜¶æ®µç›®æ ‡-1"><a href="#é˜¶æ®µç›®æ ‡-1" class="headerlink" title="é˜¶æ®µç›®æ ‡"></a>é˜¶æ®µç›®æ ‡</h2><ol><li>æ•´ç†é¡¹ç›®çš„<strong>æ•´ä½“è®¾è®¡</strong>ï¼ˆé¡¹ç›®æœ¬èº«ï¼‰ï¼ŒåŒ…æ‹¬åŠŸèƒ½ã€æ¶æ„å’Œæµç¨‹</li><li>æ•´ç†é¡¹ç›®çš„<strong>å±€éƒ¨è®¾è®¡</strong>ï¼ˆå¯¹åº”ç‰¹å®šåœºæ™¯çš„å…·ä½“è§£å†³æ–¹æ¡ˆï¼‰ï¼ŒåŒ…æ‹¬åŠŸèƒ½ã€æ¶æ„å’Œæµç¨‹</li><li>äº†è§£<strong>æ¥å£æ–‡æ¡£ï¼ˆ<code>dto</code>ï¼‰</strong>å¦‚ä½•ä¸ä¸šåŠ¡ç›¸ç»“åˆèµ·æ¥</li><li>äº†è§£<strong>æ•°æ®åº“è¡¨ï¼ˆ<code>po</code>ï¼‰</strong>å¦‚ä½•ä¸ä¸šåŠ¡ç›¸ç»“åˆèµ·æ¥</li></ol><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a><strong>ä»£ç å®ç°</strong></h1><blockquote><p>ä»£ç å®ç°é˜¶æ®µä¸»è¦æ˜¯ä»ä»£ç å±‚é¢æ¥è½å®é¡¹ç›®ï¼Œ<strong>æœ‰ä¾æ®åœ°æå¥½ç»†èŠ‚</strong>ã€‚</p></blockquote><h2 id="å¯ç”¨èµ„äº§-2"><a href="#å¯ç”¨èµ„äº§-2" class="headerlink" title="å¯ç”¨èµ„äº§"></a>å¯ç”¨èµ„äº§</h2><ol><li>é¡¹ç›®ä»£ç </li></ol><h2 id="é˜¶æ®µç›®æ ‡-2"><a href="#é˜¶æ®µç›®æ ‡-2" class="headerlink" title="é˜¶æ®µç›®æ ‡"></a>é˜¶æ®µç›®æ ‡</h2><ol><li><strong>æ¢³ç†é¡¹ç›®ä»£ç å±‚æ¬¡</strong>ï¼Œæ¯”å¦‚ <code>router</code>ã€<code>api controller/cron job/message queue</code>ã€<code>service</code>ã€<code>dao/driver</code> ç­‰ç­‰</li><li>å¯¹åº”éœ€æ±‚å’Œæ–¹æ¡ˆï¼Œä» <code>api controller/cron job/message queue</code> æ¥å…¥æ‰‹ï¼Œ<strong>å·©å›ºç†è§£ä¸šåŠ¡ï¼Œäº†è§£å®ç°ç»†èŠ‚</strong></li><li>é‡åˆ°<strong>å¤æ‚ä¸”æ ¸å¿ƒçš„ä»£ç </strong>ï¼Œå¯ç”»æµç¨‹å›¾ç­‰ä¸“é—¨è®°å½•å’Œåˆ†æ</li></ol><h1 id="æ¨¡æ‹Ÿå¼€å‘"><a href="#æ¨¡æ‹Ÿå¼€å‘" class="headerlink" title="æ¨¡æ‹Ÿå¼€å‘"></a><strong>æ¨¡æ‹Ÿå¼€å‘</strong></h1><blockquote><p>æ¨¡æ‹Ÿå¼€å‘é˜¶æ®µä¸»è¦æ˜¯ä»å®è·µå±‚é¢æ¥è¿è¡Œé¡¹ç›®ï¼Œ<strong>è¿‡ä¸€éå·¥ä½œçš„æµç¨‹</strong>ã€‚</p></blockquote><h2 id="å¯ç”¨èµ„äº§-3"><a href="#å¯ç”¨èµ„äº§-3" class="headerlink" title="å¯ç”¨èµ„äº§"></a>å¯ç”¨èµ„äº§</h2><ol><li>é¡¹ç›®ä»£ç </li><li>ç¯å¢ƒä¿¡æ¯</li></ol><h2 id="é˜¶æ®µç›®æ ‡-3"><a href="#é˜¶æ®µç›®æ ‡-3" class="headerlink" title="é˜¶æ®µç›®æ ‡"></a>é˜¶æ®µç›®æ ‡</h2><ol><li>æœ¬åœ°å’Œè¿œç¨‹å¯ä»¥<strong>è·‘é€šé¡¹ç›®ä»£ç </strong></li><li><strong>ç†Ÿæ‚‰å®Œæ•´çš„å¼€å‘æµç¨‹</strong>ï¼šç¼–å†™æ–‡æ¡£ â†’ ç”Ÿæˆä»£ç  â†’ ä¸šåŠ¡å¼€å‘ â†’ å•å…ƒæµ‹è¯• â†’ ä»£ç è§„èŒƒ â†’ æäº¤ä»£ç  â†’ ä»£ç è¯„å®¡ â†’ åˆå…¥ä»£ç  â†’ ä»£ç æ‰“åŒ… â†’ éƒ¨ç½² â†’ æµ‹è¯•</li></ol><h1 id="ä»£ç é‡æ„"><a href="#ä»£ç é‡æ„" class="headerlink" title="ä»£ç é‡æ„"></a><strong>ä»£ç é‡æ„</strong></h1><blockquote><p>ä»£ç é‡æ„é˜¶æ®µä¸»è¦æ˜¯ä»ç†æƒ³å±‚é¢æ¥ä¼˜åŒ–é¡¹ç›®ï¼Œ<strong>æå‡è‡ªå·±å’Œæ–°é¡¹ç›®</strong>ã€‚</p></blockquote><h2 id="å¯ç”¨èµ„äº§-4"><a href="#å¯ç”¨èµ„äº§-4" class="headerlink" title="å¯ç”¨èµ„äº§"></a>å¯ç”¨èµ„äº§</h2><ol><li>é¡¹ç›®ä»£ç </li></ol><h2 id="é˜¶æ®µç›®æ ‡-4"><a href="#é˜¶æ®µç›®æ ‡-4" class="headerlink" title="é˜¶æ®µç›®æ ‡"></a>é˜¶æ®µç›®æ ‡</h2><ol><li><strong>å­¦ä¹ æˆ–æ”¹è¿›</strong>é¡¹ç›®ä»£ç ï¼Œå¤§åˆ°æ¶æ„æ¨¡å¼ï¼Œå°åˆ°ç®—æ³•ç»“æ„ï¼ŒåŒæ—¶ä¹Ÿè¦å…³æ³¨ä»£ç è§„èŒƒ</li></ol><h1 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a><strong>è‡´è°¢</strong></h1><blockquote><p>æ„Ÿè°¢æ™“æ¸…å“¥æˆä¸ºæˆ‘çš„ä¼¯ä¹ï¼Œè®©æˆ‘æœ‰æœºä¼šåœ¨å–œæ¬¢çš„åœ°æ–¹åšå–œæ¬¢çš„äº‹æƒ…ï¼Œåœ¨å·¥ä½œä¸­å’Œç”Ÿæ´»ä¸Šä¹Ÿç»™äº†æˆ‘å¾ˆå¤šé¼“åŠ±ï¼›æ„Ÿè°¢é£å“¥åœ¨æˆ‘å›æ¥ä¹‹åä¾ç„¶è®©æˆ‘è§‰å¾—å¯¹è¿™é‡Œå¾ˆæœ‰å½’å±æ„Ÿï¼Œé£å“¥ä¹Ÿä¼šä¸€ç›´æ˜¯æˆ‘çš„æ¦œæ ·ï¼ˆin every aspectï¼›æ„Ÿè°¢è¿œå“¥ï¼Œäº¦å¸ˆäº¦å‹ï¼Œä¸ºå…¨ä¸–ç•Œå å¥½çš„ mentor æ‰“ callï¼›æ„Ÿè°¢å„ä½ä¸å«Œå¼ƒæˆ‘èœçš„åŒäº‹ï¼Œæœ‰ä½ ä»¬åœ¨ï¼Œæœ‰é£å“¥é€‰çš„ Macbook Proï¼Œæœ‰æ™ºç¥é€çš„ Windowsï¼Œæ¯å¤©åˆ°äº†å·¥ä½éƒ½è§‰å¾—è¿™ä¸€åˆ»ä¸€å®šè¦ä¸º HK0700 å–å‘½ï¼ˆbushiã€‚</p><p>ä¸Šä¸€æ¬¡åˆ†åˆ«æ—¶ï¼Œå…¶å®è‡ªå·±æ„Ÿåˆ°è›®æœ‰å‹åŠ›ï¼Œä¸€æ–¹é¢æ‹…å¿ƒè¦è¢«ç‚’é±¿é±¼äº†ï¼ˆç°åœ¨ä¹Ÿï¼Œå¦ä¸€æ–¹é¢æ˜¯å› ä¸ºæœ‰å¶åƒåŒ…è¢±ï¼ˆxså¼€å§‹ç»™è‡ªå·±åŠ æˆã€‚<strong>ä½†æ˜¯æ— è®ºå¦‚ä½•åœ°è¯´ï¼Œæˆ‘æœ€åº”è¯¥åšçš„å°±æ˜¯â€”â€”å¥½å¥½å·¥ä½œ</strong>ã€‚åœ¨çƒ­çˆ±çš„äº‹ä¸šé‡Œå®ç°ä»·å€¼ï¼ˆæˆ‘æœ€å¥½æ˜¯ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›å¤§å®¶å› ä¸ºæˆ‘çš„å­˜åœ¨è€Œæ„Ÿåˆ°å¼€å¿ƒï¼ˆä¸€ä¸¢ä¸¢ä¹Ÿè¡Œï¼Œbtwæ„¿ä¸‹ä¸€æ¬¡æ²¡æœ‰åˆ†åˆ« :)</p></blockquote><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¤¸å¼ çš„ä¿®è¾æ‰‹æ³•.jpgï¼ˆï¼ˆï¼ˆ Happy 7*24 Day ğŸ¤Ÿ&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Others" scheme="http://yoursite.com/categories/Others/"/>
    
    
  </entry>
  
  <entry>
    <title>#Shell Script# æ€ç»´å¯¼å›¾ï¼šShell Script</title>
    <link href="http://yoursite.com/2021/07/21/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BShell%20Script/"/>
    <id>http://yoursite.com/2021/07/21/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BShell%20Script/</id>
    <published>2021-07-20T23:00:21.000Z</published>
    <updated>2021-07-22T15:07:46.708Z</updated>
    
    <content type="html"><![CDATA[<p>å¤‡ä»½è®°å½• <code>Shell Script</code> çš„<strong>æ€ç»´å¯¼å›¾</strong>å’Œ<strong>ç›¸å…³æ–‡æ¡£</strong>ã€‚</p><hr><a id="more"></a><h1 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a><strong>æ€ç»´å¯¼å›¾</strong></h1><p><img src="/images/Shell_Script.png" alt="Shell Script Mindmap"></p><p><img src="/images/flag.png" alt="æµ‹è¯•æ ‡å¿—å›¾ç¤º"></p><h1 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a><strong>ç›¸å…³æ–‡æ¡£</strong></h1><ul><li><a href="http://cn.linux.vbird.org/linux_basic/0340bashshell-scripts.php" target="_blank" rel="noopener">å­¦ä¹  shell scripts</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¤‡ä»½è®°å½• &lt;code&gt;Shell Script&lt;/code&gt; çš„&lt;strong&gt;æ€ç»´å¯¼å›¾&lt;/strong&gt;å’Œ&lt;strong&gt;ç›¸å…³æ–‡æ¡£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Mind Map" scheme="http://yoursite.com/categories/Mind-Map/"/>
    
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
    <category term="Shell" scheme="http://yoursite.com/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>#Bash# æ€ç»´å¯¼å›¾ï¼šBash å‘½ä»¤è¡Œ</title>
    <link href="http://yoursite.com/2021/07/20/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BBash/"/>
    <id>http://yoursite.com/2021/07/20/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BBash/</id>
    <published>2021-07-19T23:00:21.000Z</published>
    <updated>2021-07-22T15:07:42.622Z</updated>
    
    <content type="html"><![CDATA[<p>å¤‡ä»½è®°å½• <code>Bash</code> çš„<strong>æ€ç»´å¯¼å›¾</strong>å’Œ<strong>ç›¸å…³æ–‡æ¡£</strong>ã€‚</p><hr><a id="more"></a><h1 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a><strong>æ€ç»´å¯¼å›¾</strong></h1><p><img src="/images/Bash.png" alt="Bash Mindmap"></p><p><img src="/images/cfg.gif" alt="é…ç½®æ–‡ä»¶è¯»å–å›¾ç¤º"></p><p><img src="/images/var.jpg" alt="å˜é‡é…ç½®æ–¹å¼å›¾ç¤º"></p><h1 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a><strong>ç›¸å…³æ–‡æ¡£</strong></h1><ul><li><a href="http://cn.linux.vbird.org/linux_basic/0320bash.php" target="_blank" rel="noopener">è®¤è¯†ä¸å­¦ä¹  BASH</a></li><li><a href="http://cn.linux.vbird.org/linux_basic/0330regularex.php" target="_blank" rel="noopener">æ­£è§„è¡¨ç¤ºæ³•ä¸æ–‡ä»¶æ ¼å¼åŒ–å¤„ç†</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¤‡ä»½è®°å½• &lt;code&gt;Bash&lt;/code&gt; çš„&lt;strong&gt;æ€ç»´å¯¼å›¾&lt;/strong&gt;å’Œ&lt;strong&gt;ç›¸å…³æ–‡æ¡£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Mind Map" scheme="http://yoursite.com/categories/Mind-Map/"/>
    
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
    <category term="Shell" scheme="http://yoursite.com/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>#Vim# æ€ç»´å¯¼å›¾ï¼šVim ç¼–è¾‘å™¨</title>
    <link href="http://yoursite.com/2021/07/19/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BVim/"/>
    <id>http://yoursite.com/2021/07/19/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BVim/</id>
    <published>2021-07-18T23:00:21.000Z</published>
    <updated>2021-07-22T15:07:31.558Z</updated>
    
    <content type="html"><![CDATA[<p>å¤‡ä»½è®°å½• <code>Vim</code> çš„<strong>æ€ç»´å¯¼å›¾</strong>å’Œ<strong>ç›¸å…³æ–‡æ¡£</strong>ã€‚</p><hr><a id="more"></a><h1 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a><strong>æ€ç»´å¯¼å›¾</strong></h1><p><img src="/images/Vim.png" alt="Vim Mindmap"></p><p><img src="/images/vi-mode.gif" alt="æ¨¡å¼å›¾ç¤º"></p><p><img src="/images/vim-commands.jpg" alt="å‘½ä»¤å›¾ç¤º"></p><h1 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a><strong>ç›¸å…³æ–‡æ¡£</strong></h1><ul><li><a href="http://cn.linux.vbird.org/linux_basic/0310vi.php" target="_blank" rel="noopener">vimç¨‹åºç¼–è¾‘å™¨</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¤‡ä»½è®°å½• &lt;code&gt;Vim&lt;/code&gt; çš„&lt;strong&gt;æ€ç»´å¯¼å›¾&lt;/strong&gt;å’Œ&lt;strong&gt;ç›¸å…³æ–‡æ¡£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Mind Map" scheme="http://yoursite.com/categories/Mind-Map/"/>
    
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
    <category term="Vim" scheme="http://yoursite.com/tags/Vim/"/>
    
  </entry>
  
  <entry>
    <title>#Kubernetes# QCloudä¸Šçš„Kubernetesåˆä½“éªŒ</title>
    <link href="http://yoursite.com/2021/06/20/QCloud%E4%B8%8A%E7%9A%84Kubernetes%E5%AE%9E%E8%B7%B5/"/>
    <id>http://yoursite.com/2021/06/20/QCloud%E4%B8%8A%E7%9A%84Kubernetes%E5%AE%9E%E8%B7%B5/</id>
    <published>2021-06-19T23:00:21.000Z</published>
    <updated>2021-06-25T07:04:45.616Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<strong>QCloud</strong>ä¸Šåˆ©ç”¨<strong>Kubernetes</strong>ç¼–æ’åº”ç”¨ä¸æœåŠ¡ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹<strong>å››ä¸ªéƒ¨åˆ†</strong>ï¼š</p><ul><li><strong>ç¯å¢ƒå‡†å¤‡ Environment</strong></li><li><strong>ç–‘éš¾è§£å†³ FAQ</strong></li><li>å…·ä½“æ¡ˆä¾‹ Cases</li><li>å‚è€ƒæ–‡çŒ® References</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="ç¯å¢ƒå‡†å¤‡-Environment"><a href="#ç¯å¢ƒå‡†å¤‡-Environment" class="headerlink" title="ç¯å¢ƒå‡†å¤‡ Environment"></a><strong>ç¯å¢ƒå‡†å¤‡ Environment</strong></h2><h3 id="æ›´æ–°ç³»ç»Ÿæºå’Œè½¯ä»¶åŒ…"><a href="#æ›´æ–°ç³»ç»Ÿæºå’Œè½¯ä»¶åŒ…" class="headerlink" title="æ›´æ–°ç³»ç»Ÿæºå’Œè½¯ä»¶åŒ…"></a>æ›´æ–°ç³»ç»Ÿæºå’Œè½¯ä»¶åŒ…</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get upgrade</span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹Dockeré…ç½®"><a href="#ä¿®æ”¹Dockeré…ç½®" class="headerlink" title="ä¿®æ”¹Dockeré…ç½®"></a>ä¿®æ”¹Dockeré…ç½®</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># ç¼–è¾‘dockeré…ç½®</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"exe-opts"</span>: [<span class="hljs-string">"native.cgroupdriver=systemd"</span>], <span class="hljs-comment"># ä¿®æ”¹cgroup driveré€‰é¡¹ï¼Œä½¿dockerå’Œk8sä¸€è‡´</span></span><br><span class="line">  <span class="hljs-string">"registry-mirrors"</span>: [<span class="hljs-string">"https://registry.docker-cn.com"</span>] <span class="hljs-comment"># æ›¿æ¢æˆå›½å†…é•œåƒæº</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯dockeræœåŠ¡</span></span><br><span class="line">service docker restart æˆ– systemctl restart docker</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…Kuberneteså·¥å…·"><a href="#å®‰è£…Kuberneteså·¥å…·" class="headerlink" title="å®‰è£…Kuberneteså·¥å…·"></a>å®‰è£…Kuberneteså·¥å…·</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># å®‰è£…ä¾èµ–å·¥å…·</span></span><br><span class="line">apt-get install -y apt-transport-https</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># è·å–é˜¿é‡Œäº‘é•œåƒæºå¯†é’¥</span></span><br><span class="line">curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main"</span> &gt; /etc/apt/sources.list.d/kubernetes.list</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># å®‰è£…k8så·¥å…·</span></span><br><span class="line">apt-get install -y kubelet kubeadm kubectl</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½Kubernetesé•œåƒ"><a href="#ä¸‹è½½Kubernetesé•œåƒ" class="headerlink" title="ä¸‹è½½Kubernetesé•œåƒ"></a>ä¸‹è½½Kubernetesé•œåƒ</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># æŸ¥çœ‹æ‰€éœ€é•œåƒåˆ—è¡¨</span></span><br><span class="line">kubeadm config images list</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç¼–è¾‘ä¸‹è½½é•œåƒæ–‡ä»¶</span></span><br><span class="line">vim pull_k8s_images.sh</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ä»å›½å†…é•œåƒæºä¸­ä¸‹è½½é•œåƒå¹¶æ›¿æ¢æ ‡ç­¾</span></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span>  `kubeadm config images list`;  <span class="hljs-keyword">do</span></span><br><span class="line">    imageName=<span class="hljs-variable">$&#123;i#k8s.gcr.io/&#125;</span></span><br><span class="line">    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$imageName</span> != <span class="hljs-string">"coredns/coredns:v1.8.0"</span> ]</span><br><span class="line">    <span class="hljs-keyword">then</span></span><br><span class="line">        docker pull registry.aliyuncs.com/google_containers/<span class="hljs-variable">$imageName</span></span><br><span class="line">        docker tag registry.aliyuncs.com/google_containers/<span class="hljs-variable">$imageName</span> k8s.gcr.io/<span class="hljs-variable">$imageName</span></span><br><span class="line">        docker rmi registry.aliyuncs.com/google_containers/<span class="hljs-variable">$imageName</span></span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">        docker pull coredns/coredns:1.8.0</span><br><span class="line">        docker tag coredns/coredns:1.8.0 k8s.gcr.io/<span class="hljs-variable">$imageName</span></span><br><span class="line">        docker rmi coredns/coredns:1.8.0</span><br><span class="line">    <span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-keyword">done</span>;</span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–Kubernetesä¸»èŠ‚ç‚¹"><a href="#åˆå§‹åŒ–Kubernetesä¸»èŠ‚ç‚¹" class="headerlink" title="åˆå§‹åŒ–Kubernetesä¸»èŠ‚ç‚¹"></a>åˆå§‹åŒ–Kubernetesä¸»èŠ‚ç‚¹</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubeadm init \</span><br><span class="line">--service-cidr=10.1.0.0/16 --pod-network-cidr=10.244.0.0/16 <span class="hljs-comment"># è®¾ç½®ç½‘ç»œä¿¡æ¯</span></span><br><span class="line">--ignore-preflight-errors=NumCPU <span class="hljs-comment"># å…è®¸å•æ ¸è¿è¡Œ</span></span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨Kubernetesé…ç½®"><a href="#åº”ç”¨Kubernetesé…ç½®" class="headerlink" title="åº”ç”¨Kubernetesé…ç½®"></a>åº”ç”¨Kubernetesé…ç½®</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p <span class="hljs-variable">$HOME</span>/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf <span class="hljs-variable">$HOME</span>/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) <span class="hljs-variable">$HOME</span>/.kube/config</span><br><span class="line"><span class="hljs-built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½Kubernetesç½‘ç»œæ’ä»¶"><a href="#ä¸‹è½½Kubernetesç½‘ç»œæ’ä»¶" class="headerlink" title="ä¸‹è½½Kubernetesç½‘ç»œæ’ä»¶"></a>ä¸‹è½½Kubernetesç½‘ç»œæ’ä»¶</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br></pre></td></tr></table></figure><h3 id="å…è®¸ä¸»èŠ‚ç‚¹éƒ¨ç½²"><a href="#å…è®¸ä¸»èŠ‚ç‚¹éƒ¨ç½²" class="headerlink" title="å…è®¸ä¸»èŠ‚ç‚¹éƒ¨ç½²"></a>å…è®¸ä¸»èŠ‚ç‚¹éƒ¨ç½²</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes --all node-role.kubernetes.io/master-</span><br></pre></td></tr></table></figure><h3 id="å…è®¸å‘½ä»¤è¡Œè¡¥å…¨"><a href="#å…è®¸å‘½ä»¤è¡Œè¡¥å…¨" class="headerlink" title="å…è®¸å‘½ä»¤è¡Œè¡¥å…¨"></a>å…è®¸å‘½ä»¤è¡Œè¡¥å…¨</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install bash-completion</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"source &lt;(kubectl completion bash)"</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹æ˜¯å¦éƒ¨ç½²æˆåŠŸ"><a href="#æŸ¥çœ‹æ˜¯å¦éƒ¨ç½²æˆåŠŸ" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦éƒ¨ç½²æˆåŠŸ"></a>æŸ¥çœ‹æ˜¯å¦éƒ¨ç½²æˆåŠŸ</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br><span class="line">kubectl get pods -n kube-system</span><br></pre></td></tr></table></figure><h2 id="ç–‘éš¾è§£å†³-FAQ"><a href="#ç–‘éš¾è§£å†³-FAQ" class="headerlink" title="ç–‘éš¾è§£å†³ FAQ"></a><strong>ç–‘éš¾è§£å†³ FAQ</strong></h2><h3 id="Dockeré‡å¯æœåŠ¡å‡ºç°å¼‚å¸¸"><a href="#Dockeré‡å¯æœåŠ¡å‡ºç°å¼‚å¸¸" class="headerlink" title="Dockeré‡å¯æœåŠ¡å‡ºç°å¼‚å¸¸"></a>Dockeré‡å¯æœåŠ¡å‡ºç°å¼‚å¸¸</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># æŸ¥çœ‹æ—¥å¿—å®šä½åŸå› </span></span><br><span class="line">service docker status æˆ– systemctl status docker</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ˜¯å› ä¸º/var/run/docker.sockå‡ºé”™äº†</span></span><br><span class="line">level=fatal msg=<span class="hljs-string">"can't create unix socket /var/run/docker.sock: is a directory"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># åˆ é™¤/var/run/docker.sockæ–‡ä»¶</span></span><br><span class="line">rm -rf /var/run/docker.sock</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯dockeræœåŠ¡</span></span><br><span class="line">service docker restart æˆ– systemctl restart docker</span><br></pre></td></tr></table></figure><h3 id="Kuberneteså¿˜è®°åŠ å…¥é›†ç¾¤å‘½ä»¤"><a href="#Kuberneteså¿˜è®°åŠ å…¥é›†ç¾¤å‘½ä»¤" class="headerlink" title="Kuberneteså¿˜è®°åŠ å…¥é›†ç¾¤å‘½ä»¤"></a>Kuberneteså¿˜è®°åŠ å…¥é›†ç¾¤å‘½ä»¤</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># æç¤ºçš„å‘½ä»¤</span></span><br><span class="line">kubeadm join <span class="hljs-variable">$&#123;ip&#125;</span> --token <span class="hljs-variable">$&#123;token&#125;</span> --discovery-token-ca-cert-hash <span class="hljs-variable">$&#123;discovery-token-ca-cert-hash&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ‰¾å›çš„å‘½ä»¤</span></span><br><span class="line">kubeadm token create --<span class="hljs-built_in">print</span>-join-command</span><br></pre></td></tr></table></figure><h3 id="x509-certificate-signed-by-unknown-authority"><a href="#x509-certificate-signed-by-unknown-authority" class="headerlink" title="x509: certificate signed by unknown authority"></a>x509: certificate signed by unknown authority</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># é‡è£…å.kube/configå˜åŒ–äº†ï¼Œé‡æ–°åº”ç”¨é…ç½®</span></span><br><span class="line">mkdir -p <span class="hljs-variable">$HOME</span>/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf <span class="hljs-variable">$HOME</span>/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) <span class="hljs-variable">$HOME</span>/.kube/config</span><br><span class="line"><span class="hljs-built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br></pre></td></tr></table></figure><h3 id="Dockerå®¹å™¨è¿æ¥æœ¬æœºMySQL-Redis"><a href="#Dockerå®¹å™¨è¿æ¥æœ¬æœºMySQL-Redis" class="headerlink" title="Dockerå®¹å™¨è¿æ¥æœ¬æœºMySQL/Redis"></a>Dockerå®¹å™¨è¿æ¥æœ¬æœºMySQL/Redis</h3><h4 id="Bridgeæ¨¡å¼"><a href="#Bridgeæ¨¡å¼" class="headerlink" title="Bridgeæ¨¡å¼"></a>Bridgeæ¨¡å¼</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># æŸ¥çœ‹dockerå®¹å™¨ç½‘ç»œæ¨¡å¼</span></span><br><span class="line">docker inspect <span class="hljs-variable">$&#123;container_id&#125;</span> | grep -i <span class="hljs-string">"network"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é»˜è®¤ä¸ºbridgeçš„æ¨¡å¼</span></span><br><span class="line"><span class="hljs-string">"NetworkMode"</span>: <span class="hljs-string">"bridge"</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ­¤æ—¶localhostä»…ä»…æŒ‡çš„æ˜¯å®¹å™¨è‡ªèº«åœ°å€ï¼Œåº”ä½¿ç”¨ä¸»æœºçš„å†…ç½‘åœ°å€</span></span><br></pre></td></tr></table></figure><h4 id="Hostæ¨¡å¼"><a href="#Hostæ¨¡å¼" class="headerlink" title="Hostæ¨¡å¼"></a>Hostæ¨¡å¼</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># ä»¥hostçš„æ¨¡å¼å¯åŠ¨dockerå®¹å™¨</span></span><br><span class="line">docker run -d --network=host <span class="hljs-variable">$&#123;registry&#125;</span>:<span class="hljs-variable">$&#123;tag&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># æ­¤æ—¶localhoståŒæ—¶ä»£è¡¨äº†å®¹å™¨å’Œä¸»æœºçš„åœ°å€</span></span><br></pre></td></tr></table></figure><h3 id="Xshellå¤–ç½‘è¿œç¨‹è®¿é—®MySQL-Redis"><a href="#Xshellå¤–ç½‘è¿œç¨‹è®¿é—®MySQL-Redis" class="headerlink" title="Xshellå¤–ç½‘è¿œç¨‹è®¿é—®MySQL/Redis"></a>Xshellå¤–ç½‘è¿œç¨‹è®¿é—®MySQL/Redis</h3><h4 id="ä¿®æ”¹-MySQL-Redis-é…ç½®"><a href="#ä¿®æ”¹-MySQL-Redis-é…ç½®" class="headerlink" title="ä¿®æ”¹ MySQL/Redis é…ç½®"></a>ä¿®æ”¹ MySQL/Redis é…ç½®</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># ç¼–è¾‘mysqlé…ç½®</span></span><br><span class="line">vim /etc/mysql/my.cnf</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç›‘å¬æ‰€æœ‰ç½‘æ®µ</span></span><br><span class="line">[mysqld]</span><br><span class="line"><span class="hljs-built_in">bind</span>-address=0.0.0.0</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ä¿®æ”¹è¿œç¨‹ç™»å½•æƒé™</span></span><br><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; update user <span class="hljs-built_in">set</span> host=<span class="hljs-string">'%'</span> <span class="hljs-built_in">where</span> user=<span class="hljs-string">'root'</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯mysqlæœåŠ¡ä½¿å…¶é‡æ–°ç”Ÿæ•ˆ</span></span><br><span class="line">mysqld --defaults-file=/etc/mysql/my.cnf</span><br><span class="line">service mysql restart æˆ– systemctl restart mysql</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç¼–è¾‘redisé…ç½®</span></span><br><span class="line">vim /etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># ç›‘å¬æ‰€æœ‰ç½‘æ®µ</span></span><br><span class="line"><span class="hljs-built_in">bind</span> 0.0.0.0</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># é‡å¯redis-serveræœåŠ¡ä½¿å…¶é‡æ–°ç”Ÿæ•ˆ</span></span><br><span class="line">redis-server /etc/redis/redis.conf</span><br><span class="line">service redis-server restart æˆ– systemctl restart redis-server</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹è…¾è®¯äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™"><a href="#ä¿®æ”¹è…¾è®¯äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™" class="headerlink" title="ä¿®æ”¹è…¾è®¯äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™"></a>ä¿®æ”¹è…¾è®¯äº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™</h4><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># å…è®¸æ‰€æœ‰ç½‘æ®µè®¿é—®3306å’Œ6379è¿™ä¸¤ä¸ªç«¯å£</span></span><br><span class="line">0.0.0.0/0 TCP:3306,6379 Allow <span class="hljs-comment"># ipv4æ”¾è¡Œ</span></span><br><span class="line">::/0 TCP:3306,6379 Allow <span class="hljs-comment"># ipv6æ”¾è¡Œ</span></span><br></pre></td></tr></table></figure><h2 id="å…·ä½“æ¡ˆä¾‹-Cases"><a href="#å…·ä½“æ¡ˆä¾‹-Cases" class="headerlink" title="å…·ä½“æ¡ˆä¾‹ Cases"></a><strong>å…·ä½“æ¡ˆä¾‹ Cases</strong></h2><h3 id="äº¤å‰ç¼–è¯‘ä¸é•œåƒæ„å»º"><a href="#äº¤å‰ç¼–è¯‘ä¸é•œåƒæ„å»º" class="headerlink" title="äº¤å‰ç¼–è¯‘ä¸é•œåƒæ„å»º"></a>äº¤å‰ç¼–è¯‘ä¸é•œåƒæ„å»º</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># set go env</span></span><br><span class="line"><span class="hljs-built_in">export</span> GO111MODULE=auto</span><br><span class="line"><span class="hljs-built_in">export</span> GOPROXY=https://goproxy.io,direct</span><br><span class="line">go mod tidy</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># build binary executable</span></span><br><span class="line">mkdir -p ./bin</span><br><span class="line">GOOS=linux GOARCH=amd64 go build -o ./bin/giotto_gateway_core</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Dockerfile</span></span><br><span class="line">FROM golang</span><br><span class="line">MAINTAINER LotteWong &lt;lottewong21@gmail.com&gt;</span><br><span class="line"></span><br><span class="line">WORKDIR /go/src/app</span><br><span class="line">COPY . .</span><br><span class="line"></span><br><span class="line">CMD ./bin/giotto_gateway_core -config ./configs/prod/</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># docker build</span></span><br><span class="line">commit=`git rev-parse --short HEAD`</span><br><span class="line">docker build -f ./ci/docker/Dockerfile -t giotto-gateway-core:<span class="hljs-variable">$commit</span> .</span><br></pre></td></tr></table></figure><h3 id="å®¹å™¨éƒ¨ç½²ä¸å®¹å™¨ç¼–æ’"><a href="#å®¹å™¨éƒ¨ç½²ä¸å®¹å™¨ç¼–æ’" class="headerlink" title="å®¹å™¨éƒ¨ç½²ä¸å®¹å™¨ç¼–æ’"></a>å®¹å™¨éƒ¨ç½²ä¸å®¹å™¨ç¼–æ’</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># deploy config</span></span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: giotto-gateway-core</span><br><span class="line">spec:</span><br><span class="line">  replicas: 3</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      name: giotto-gateway-core</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        name: giotto-gateway-core</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: giotto-gateway-core</span><br><span class="line">          image: giotto-gateway-core:d1785da</span><br><span class="line">          imagePullPolicy: Never</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 80</span><br><span class="line">            - containerPort: 443</span><br><span class="line">---</span><br><span class="line"><span class="hljs-comment"># service config</span></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: giotto-gateway-core</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 80</span><br><span class="line">      name: <span class="hljs-string">"http-proxy"</span></span><br><span class="line">      targetPort: 80</span><br><span class="line">      protocol: TCP</span><br><span class="line">      nodePort: 30080</span><br><span class="line">    - port: 443</span><br><span class="line">      name: <span class="hljs-string">"https-proxy"</span></span><br><span class="line">      targetPort: 443</span><br><span class="line">      protocol: TCP</span><br><span class="line">      nodePort: 30443</span><br><span class="line">  <span class="hljs-built_in">type</span>: NodePort</span><br><span class="line">  selector:</span><br><span class="line">    name: giotto-gateway-core</span><br><span class="line">    </span><br><span class="line"><span class="hljs-comment"># kubectl create</span></span><br><span class="line">kubectl create -f ./ci/k8s/core.yaml</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™-References"><a href="#å‚è€ƒèµ„æ–™-References" class="headerlink" title="å‚è€ƒèµ„æ–™ References"></a><strong>å‚è€ƒèµ„æ–™ References</strong></h2><ol><li><a href="https://cloud.tencent.com/developer/article/1817826" target="_blank" rel="noopener">åœ¨ Ubuntu ä¸Šå®‰è£… K8S æ•™ç¨‹</a></li><li><a href="https://my.oschina.net/u/4409146/blog/3306898" target="_blank" rel="noopener">ubuntu k8s å•èŠ‚ç‚¹å¿«é€Ÿå®‰è£…</a></li><li><a href="https://blog.csdn.net/u012891504/article/details/52857682" target="_blank" rel="noopener">dockeræœåŠ¡å¯åŠ¨å¤±è´¥</a></li><li><a href="https://blog.csdn.net/weixin_44130081/article/details/103563392" target="_blank" rel="noopener">K8Såœ¨kubeadm initä»¥åæŸ¥è¯¢kubeadm join</a></li><li><a href="https://stackoverflow.com/questions/36939381/x509-certificate-signed-by-unknown-authority-kubernetes" target="_blank" rel="noopener">x509 certificate signed by unknown authority- Kubernetes</a></li><li><a href="https://blog.csdn.net/suchahaerkang/article/details/84570488" target="_blank" rel="noopener">Dockerçš„å››ç§ç½‘ç»œæ¨¡å¼Bridgeæ¨¡å¼</a></li><li><a href="https://cloud.tencent.com/developer/article/1153843" target="_blank" rel="noopener">mysql è¿œç¨‹è¿æ¥æ•°æ®åº“çš„äºŒç§æ–¹æ³•</a></li><li><a href="https://blog.csdn.net/Light_Breeze/article/details/82070222" target="_blank" rel="noopener">è§£å†³mysqlä¸ç”¨å¯†ç ä¹Ÿèƒ½ç™»å½•</a></li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨&lt;strong&gt;QCloud&lt;/strong&gt;ä¸Šåˆ©ç”¨&lt;strong&gt;Kubernetes&lt;/strong&gt;ç¼–æ’åº”ç”¨ä¸æœåŠ¡ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹&lt;strong&gt;å››ä¸ªéƒ¨åˆ†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¯å¢ƒå‡†å¤‡ Environment&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç–‘éš¾è§£å†³ FAQ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å…·ä½“æ¡ˆä¾‹ Cases&lt;/li&gt;
&lt;li&gt;å‚è€ƒæ–‡çŒ® References&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="DevOps" scheme="http://yoursite.com/categories/DevOps/"/>
    
    
    <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
    <category term="Kubernetes" scheme="http://yoursite.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(6) ç³»ç»Ÿæµ‹è¯•</title>
    <link href="http://yoursite.com/2021/06/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(6)/"/>
    <id>http://yoursite.com/2021/06/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(6)/</id>
    <published>2021-06-04T23:00:21.000Z</published>
    <updated>2021-06-21T03:11:42.222Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>ç³»ç»Ÿæµ‹è¯•</strong>ï¼Œåˆ†ä¸º<strong>ä¸¤ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li>åŠŸèƒ½æµ‹è¯•</li><li>æ€§èƒ½æµ‹è¯•</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a><strong>åŠŸèƒ½æµ‹è¯•</strong></h2><h3 id="ç”¨ä¾‹è®¾è®¡"><a href="#ç”¨ä¾‹è®¾è®¡" class="headerlink" title="ç”¨ä¾‹è®¾è®¡"></a>ç”¨ä¾‹è®¾è®¡</h3><ul><li><a href="https://segmentfault.com/a/1190000012127784" target="_blank" rel="noopener">å¸¸è§æµ‹è¯•ç”¨ä¾‹è®¾è®¡æ–¹æ³•</a></li></ul><h3 id="ç”¨ä¾‹è®°å½•"><a href="#ç”¨ä¾‹è®°å½•" class="headerlink" title="ç”¨ä¾‹è®°å½•"></a>ç”¨ä¾‹è®°å½•</h3><table><thead><tr><th align="center">æ¡ç›®</th><th align="center">å†…å®¹</th></tr></thead><tbody><tr><td align="center">ç”¨ä¾‹ç¼–å·</td><td align="center"><code>[æ•°å­¦]</code></td></tr><tr><td align="center">åŠŸèƒ½æè¿°</td><td align="center"><code>[-]</code></td></tr><tr><td align="center">å‰ç½®æ¡ä»¶</td><td align="center"><code>[-]</code></td></tr><tr><td align="center">æµ‹è¯•è¿‡ç¨‹</td><td align="center"><code>[-]</code></td></tr><tr><td align="center">é¢„æœŸç»“æœ</td><td align="center"><code>[-]</code></td></tr><tr><td align="center">æ˜¯å¦é€šè¿‡</td><td align="center"><code>[æ˜¯å¦]</code></td></tr></tbody></table><h2 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a><strong>æ€§èƒ½æµ‹è¯•</strong></h2><h3 id="æµ‹è¯•ç¯å¢ƒåŠå·¥å…·"><a href="#æµ‹è¯•ç¯å¢ƒåŠå·¥å…·" class="headerlink" title="æµ‹è¯•ç¯å¢ƒåŠå·¥å…·"></a>æµ‹è¯•ç¯å¢ƒåŠå·¥å…·</h3><table><thead><tr><th align="center">æ¡ç›®</th><th align="center">å†…å®¹</th></tr></thead><tbody><tr><td align="center">ç¡¬ä»¶æœºå™¨é…ç½®</td><td align="center">è…¾è®¯äº‘æœåŠ¡å™¨1C2G1M</td></tr><tr><td align="center">æµ‹è¯•ç½‘ç»œç¯å¢ƒ</td><td align="center">localhost</td></tr><tr><td align="center">è½¯ä»¶å‹æµ‹å·¥å…·</td><td align="center">wrk</td></tr></tbody></table><p><img src="/images/wrk.png" alt="å‹æµ‹å·¥å…·wrkä½¿ç”¨æ–¹æ³•"></p><h3 id="æµ‹è¯•è¿‡ç¨‹åŠç»“æœ"><a href="#æµ‹è¯•è¿‡ç¨‹åŠç»“æœ" class="headerlink" title="æµ‹è¯•è¿‡ç¨‹åŠç»“æœ"></a>æµ‹è¯•è¿‡ç¨‹åŠç»“æœ</h3><table><thead><tr><th align="center">å‹æµ‹å¯¹è±¡</th><th align="center">å‹æµ‹å‘½ä»¤</th><th align="center">æ¯ç§’çš„è¯·æ±‚é‡</th></tr></thead><tbody><tr><td align="center">å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—</td><td align="center"><code>wrk -t30 -c600 -d30s -H&quot;Authorization:Bearer ${jwt}&quot; http://localhost:8080/wrk</code></td><td align="center">5651.29</td></tr><tr><td align="center">çº¯ <code>Golang</code> æœåŠ¡å™¨</td><td align="center"><code>wrk -t30 -c600 -d30s http://localhost:8081/wrk</code></td><td align="center">25961.68</td></tr><tr><td align="center"><code>Nginx</code></td><td align="center"><code>wrk -t30 -c600 -d30s http://localhost:8082/wrk</code></td><td align="center">3561.78</td></tr></tbody></table><ul><li>å¼€å¯<strong>30ä¸ªçº¿ç¨‹</strong>ï¼Œå¹¶å‘è¯·æ±‚<strong>600æ¬¡åå°æ¥å£</strong>ï¼ŒæŒç»­<strong>30ç§’æ—¶é—´</strong>ï¼Œé‡‡é›†å¹¶æ‰“å°å‹æµ‹ç»“æœã€‚</li><li>ä»<strong>æ¯ç§’çš„è¯·æ±‚é‡</strong>çœ‹ï¼Œ<strong>çº¯ <code>Golang</code> æœåŠ¡å™¨</strong>æ²¡æœ‰ä¸­é—´æµç¨‹æŸè€—å’Œé¢å¤–ç»„ä»¶å¼€é”€å› è€Œæ”¯æ’‘çš„ <code>QPS</code> å¤§å¹…é¢†å…ˆï¼Œ<strong>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—</strong>èƒ½å¤Ÿè¶…è¿‡æœªè°ƒä¼˜å‰çš„ <strong><code>Nginx</code></strong> çš„æ€§èƒ½è¡¨ç°ã€‚</li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;ç³»ç»Ÿæµ‹è¯•&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸¤ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠŸèƒ½æµ‹è¯•&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æµ‹è¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(5) å®¹å™¨éƒ¨ç½²</title>
    <link href="http://yoursite.com/2021/06/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(5)/"/>
    <id>http://yoursite.com/2021/06/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(5)/</id>
    <published>2021-06-03T23:00:21.000Z</published>
    <updated>2021-06-20T14:10:45.635Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>å®¹å™¨éƒ¨ç½²</strong>ï¼Œåˆ†ä¸º<strong>ä¸‰ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li><code>Golang</code> äº¤å‰ç¼–è¯‘</li><li><code>Docker</code> é•œåƒæ„å»º</li><li><code>Kubernetes</code> å®¹å™¨ç¼–æ’</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="Golangäº¤å‰ç¼–è¯‘"><a href="#Golangäº¤å‰ç¼–è¯‘" class="headerlink" title="Golangäº¤å‰ç¼–è¯‘"></a><strong>Golangäº¤å‰ç¼–è¯‘</strong></h2><ul><li><u><code>Golang</code> æ”¯æŒäº¤å‰ç¼–è¯‘ï¼Œå³åœ¨å½“å‰çš„æ“ä½œç³»ç»Ÿå’Œä½“ç³»æ¶æ„ä¸Šç”ŸæˆæŒ‡å®šçš„æ“ä½œç³»ç»Ÿå’Œä½“ç³»æ¶æ„çš„å¯æ‰§è¡Œç¨‹åºã€‚</u>å¾®æœåŠ¡APIç½‘å…³é¢„å…ˆé‡‡å– <code>Golang</code> äº¤å‰ç¼–è¯‘å‡ºäºä¸¤ç‚¹è€ƒè™‘ï¼šä¸€æ˜¯æå‰åœ¨å¼€å‘ç¯å¢ƒä¸­ç¼–è¯‘ç¨‹åºæ¯”ä¹‹ååœ¨é•œåƒæ„å»ºä¸­ç¼–è¯‘ç¨‹åºçš„<strong>é€Ÿåº¦è¦æ›´åŠ å¿«</strong>ï¼›äºŒæ˜¯å¼€å‘ç¯å¢ƒå’Œéƒ¨ç½²ç¯å¢ƒçš„æ“ä½œç³»ç»Ÿä¸åŒï¼Œå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶å¿…é¡»ç»è¿‡äº¤å‰ç¼–è¯‘<strong>æ‰èƒ½æ­£å¸¸è¿è¡Œ</strong>ã€‚</li></ul><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/docker/cross_compile.sh</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># set go env</span></span><br><span class="line"><span class="hljs-built_in">export</span> GO111MODULE=auto</span><br><span class="line"><span class="hljs-built_in">export</span> GOPROXY=https://goproxy.io,direct</span><br><span class="line">go mod tidy</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># build binary executable</span></span><br><span class="line">mkdir -p ./bin</span><br><span class="line">GOOS=linux GOARCH=amd64 go build -o ./bin/giotto_gateway_core</span><br></pre></td></tr></table></figure><ul><li>å…ˆè®¾ç½® <code>Golang</code> æ‰“å¼€ <code>Go Module</code> æ¨¡å¼å¹¶ä¸‹è½½ç¨‹åºçš„æ¨¡å—ä¾èµ–ï¼Œå†å®šä¹‰ç›®æ ‡çš„æ“ä½œç³»ç»Ÿå’Œä½“ç³»æ¶æ„å¼€å§‹äº¤å‰ç¼–è¯‘ã€‚</li></ul><h2 id="Dockeré•œåƒæ„å»º"><a href="#Dockeré•œåƒæ„å»º" class="headerlink" title="Dockeré•œåƒæ„å»º"></a><strong>Dockeré•œåƒæ„å»º</strong></h2><ul><li><u><code>Docker</code> æ˜¯ä¸€ä¸ªé€šè¿‡ç®¡ç† <code>Linux</code> å®¹å™¨æ¥å®ç°åº”ç”¨ç¯å¢ƒéš”ç¦»çš„å¼€æºå®¹å™¨å¼•æ“ï¼Œå®ƒæä¾›äº†ä¸€æ•´å¥—å®Œå¤‡ä¸”æ˜“ç”¨çš„å®¹å™¨ç®¡ç†æ¥å£ã€‚</u>å¾®æœåŠ¡APIç½‘å…³çš„ç®¡ç†æ¨¡å—å’Œæ ¸å¿ƒæ¨¡å—ä¸¤ä¸ªå¾®æœåŠ¡å°†ä½¿ç”¨ <code>Docker</code> æ„å»ºé•œåƒï¼Œå®ç°<strong>æ›´å¿«çš„ç¨‹åºéƒ¨ç½²å’Œæ›´ä½çš„è®¡ç®—å¼€é”€</strong>ã€‚</li></ul><figure class="highlight dockerfile hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/docker/Dockerfile</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">FROM</span> golang</span><br><span class="line"><span class="hljs-keyword">MAINTAINER</span> LotteWong &lt;lottewong21@gmail.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">WORKDIR</span><span class="hljs-bash"> /go/src/app</span></span><br><span class="line"><span class="hljs-keyword">COPY</span><span class="hljs-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">CMD</span><span class="hljs-bash"> ./bin/giotto_gateway_core -config ./configs/prod/</span></span><br></pre></td></tr></table></figure><ul><li>å…ˆæ‹‰å–åŸºç¡€é•œåƒ <code>golang</code>ï¼Œå†å®šä¹‰å®¹å™¨å†…çš„å·¥ä½œç›®å½•ä¸º <code>/go/src/app</code>ï¼Œæ¥ç€å°†ä¸»æœºçš„æºæ–‡ä»¶æ‹·è´è¿›å®¹å™¨ä¸­ï¼Œæœ€åå‘½ä»¤è¡Œå¯åŠ¨å¾®æœåŠ¡ã€‚</li></ul><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/docker/cross_compile.sh</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># build docker images</span></span><br><span class="line">commit=`git rev-parse --short HEAD`</span><br><span class="line">docker build -f ./ci/docker/Dockerfile -t giotto-gateway-core:<span class="hljs-variable">$commit</span> .</span><br></pre></td></tr></table></figure><ul><li>å…ˆè¯»å– <code>Git</code> ç‰ˆæœ¬ç®¡ç†åº“ä¸­æœ€æ–°çš„ <code>commit id</code> ä½œä¸ºé•œåƒçš„ <code>tag</code>ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ ‡è¯†å’Œç®¡ç†é•œåƒï¼Œå†ä½¿ç”¨ <code>docker build</code> å‘½ä»¤ï¼Œä¼ å…¥å‚æ•°æ„å»ºé•œåƒã€‚</li></ul><h2 id="Kuberneteså®¹å™¨ç¼–æ’"><a href="#Kuberneteså®¹å™¨ç¼–æ’" class="headerlink" title="Kuberneteså®¹å™¨ç¼–æ’"></a><strong>Kuberneteså®¹å™¨ç¼–æ’</strong></h2><ul><li><u><code>Kubernetes</code> æ˜¯å…·å¤‡è‰¯å¥½çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ‰©å±•ã€è°ƒåº¦å’Œç¼–æ’èƒ½åŠ›çš„å¼€æºå®¹å™¨ç®¡ç†å¹³å°ï¼Œèƒ½å¤Ÿå¸®åŠ©æœ‰æ•ˆåœ°é™ä½å®¹å™¨è¿ç»´æˆæœ¬ï¼Œæé«˜æœåŠ¡é›†ç¾¤ç®¡ç†æ•ˆç‡ã€‚</u>å¾®æœåŠ¡APIç½‘å…³çš„ç®¡ç†æ¨¡å—å’Œæ ¸å¿ƒæ¨¡å—ä¸¤ä¸ªå¾®æœåŠ¡å°†ä½¿ç”¨ <code>Kubernetes</code> éƒ¨ç½²å’Œç¼–æ’å®¹å™¨ï¼Œä»¥æé«˜ç³»ç»Ÿçš„<strong>æ‰©å±•æ€§å’Œå¯é æ€§</strong>ã€‚</li></ul><p><img src="/images/microservice_api_gateway_k8s.png" alt="å¾®æœåŠ¡APIç½‘å…³åŸºäºKubernetesçš„éƒ¨ç½²å›¾"></p><ul><li>å¯¹äº<u>æ ¸å¿ƒæ¨¡å—</u>è€Œè¨€ï¼Œ1ä¸ªæ ¸å¿ƒæ¨¡å— <code>Pod</code> ç®¡ç†1ä¸ªæ ¸å¿ƒæ¨¡å— <code>Container</code> çš„<strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œæ€»å…±éƒ¨ç½²3ä¸ª <code>Pod</code> å®ç°æ ¸å¿ƒæ¨¡å—åŠŸèƒ½çš„<strong>é«˜å¯ç”¨</strong>ï¼›å¯¹äº<u>ç®¡ç†æ¨¡å—</u>è€Œè¨€ï¼Œ1ä¸ªç®¡ç†æ¨¡å— <code>Pod</code> ç®¡ç†1ä¸ªç®¡ç†æ¨¡å— <code>Container</code> çš„<strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œç”±äºåˆ°è¾¾ç®¡ç†æ¨¡å—çš„æµé‡ç›¸å¯¹è¾ƒå°ï¼Œæ€»å…±éƒ¨ç½²1ä¸ª <code>Pod</code> <strong>æä¾›æœåŠ¡</strong>ã€‚åˆ›å»º <code>Deployment</code> ç”¨äºå¯¹ <code>Pod</code> è¿›è¡Œ<strong>å¼¹æ€§ä¼¸ç¼©å’Œè´Ÿè½½å‡è¡¡</strong>ï¼Œåˆ›å»º <code>Service</code> ç”¨äºå¯¹ <code>Pod</code> è¿›è¡Œç«¯å£æ˜ å°„ä»¥<strong>å®ç°å¤–éƒ¨ç½‘ç»œçš„è®¿é—®</strong>ã€‚</li></ul><figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/k8s/core.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># deploy config</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span></span><br><span class="line">  <span class="hljs-attr">selector:</span></span><br><span class="line">    <span class="hljs-attr">matchLabels:</span></span><br><span class="line">      <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br><span class="line">  <span class="hljs-attr">template:</span></span><br><span class="line">    <span class="hljs-attr">metadata:</span></span><br><span class="line">      <span class="hljs-attr">labels:</span></span><br><span class="line">        <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br><span class="line">    <span class="hljs-attr">spec:</span></span><br><span class="line">      <span class="hljs-attr">containers:</span></span><br><span class="line">        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br><span class="line">          <span class="hljs-attr">image:</span> <span class="hljs-string">giotto-gateway-core:d1785da</span></span><br><span class="line">          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">Never</span></span><br><span class="line">          <span class="hljs-attr">ports:</span></span><br><span class="line">            <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line">            <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">443</span></span><br></pre></td></tr></table></figure><ul><li><code>Kubernetes Deployment</code> é…ç½®å®šä¹‰äº† <code>Pod</code> çš„å‰¯æœ¬æ•°é‡ã€å…ƒæ•°æ®ã€å®¹å™¨é•œåƒå’Œå®¹å™¨ç«¯å£æ˜ å°„å…³ç³»ç­‰ï¼Œç”¨äºå¯¹å¾®æœåŠ¡å®¹å™¨è¿›è¡Œéƒ¨ç½²è¿è¡Œã€å¼¹æ€§ä¼¸ç¼©å’Œè´Ÿè½½å‡è¡¡ã€‚</li></ul><figure class="highlight yaml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/k8s/core.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># service config</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-attr">ports:</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">80</span></span><br><span class="line">      <span class="hljs-attr">name:</span> <span class="hljs-string">"http-proxy"</span></span><br><span class="line">      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">80</span></span><br><span class="line">      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span></span><br><span class="line">      <span class="hljs-attr">nodePort:</span> <span class="hljs-number">30080</span></span><br><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">443</span></span><br><span class="line">      <span class="hljs-attr">name:</span> <span class="hljs-string">"https-proxy"</span></span><br><span class="line">      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">443</span></span><br><span class="line">      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span></span><br><span class="line">      <span class="hljs-attr">nodePort:</span> <span class="hljs-number">30443</span></span><br><span class="line">  <span class="hljs-attr">type:</span> <span class="hljs-string">NodePort</span></span><br><span class="line">  <span class="hljs-attr">selector:</span></span><br><span class="line">    <span class="hljs-attr">name:</span> <span class="hljs-string">giotto-gateway-core</span></span><br></pre></td></tr></table></figure><ul><li><code>Kubernetes Service</code> é…ç½®å®šä¹‰äº†å…ƒæ•°æ®å’Œå¯¹å¤–ç«¯å£æ˜ å°„å…³ç³»ç­‰ï¼Œç”¨äºå»ºç«‹å¤–éƒ¨ç½‘ç»œè®¿é—® <code>Kubernetes</code> èŠ‚ç‚¹å†…å®¹å™¨çš„é€šä¿¡æ¡¥æ¢ã€‚</li></ul><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># take giotto-gateway-core as an example</span></span><br><span class="line"><span class="hljs-comment"># https://github.com/LotteWong/giotto-gateway-core/blob/main/ci/k8s/apply_yaml.sh</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># k8s apply yaml to create deploy and service</span></span><br><span class="line">kubectl create -f ./ci/k8s/core.yaml</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ <code>kubectl create</code> å‘½ä»¤ï¼Œä¼ å…¥é…ç½®æ–‡ä»¶è·¯å¾„åˆ›å»º <code>Deployment</code> å’Œ <code>Service</code>ã€‚</li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;å®¹å™¨éƒ¨ç½²&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸‰ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Golang&lt;/code&gt; äº¤å‰ç¼–è¯‘&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Docker&lt;/code&gt; é•œåƒæ„å»º&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kubernetes&lt;/code&gt; å®¹å™¨ç¼–æ’&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
    <category term="Kubernetes" scheme="http://yoursite.com/tags/Kubernetes/"/>
    
    <category term="Docker" scheme="http://yoursite.com/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(4) æ•°æ®åº“è®¾è®¡</title>
    <link href="http://yoursite.com/2021/06/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(4)/"/>
    <id>http://yoursite.com/2021/06/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(4)/</id>
    <published>2021-06-03T13:00:07.000Z</published>
    <updated>2021-08-12T15:40:06.836Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>æ•°æ®åº“è®¾è®¡</strong>ï¼Œåˆ†ä¸º<strong>ä¸¤ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li><code>MySQL</code> æ•°æ®åº“è¡¨è®¾è®¡ - <strong>E-Rå›¾åŠå…³ç³»æ¨¡å¼</strong></li><li><code>Redis</code> é”®å€¼è®¾è®¡</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a><strong>æ•°æ®åº“</strong></h2><h3 id="æ•°æ®åº“ä¸‰èŒƒå¼"><a href="#æ•°æ®åº“ä¸‰èŒƒå¼" class="headerlink" title="æ•°æ®åº“ä¸‰èŒƒå¼"></a>æ•°æ®åº“ä¸‰èŒƒå¼</h3><ul><li>1NFæ˜¯å¯¹å±æ€§çš„<strong>åŸå­æ€§</strong>ï¼Œè¦æ±‚<strong>å±æ€§ä¸å¯å†åˆ†è§£</strong>ã€‚</li><li>2NFæ˜¯å¯¹è®°å½•çš„<strong>å”¯ä¸€æ€§</strong>ï¼Œè¦æ±‚è®°å½•æœ‰å”¯ä¸€æ ‡è¯†ï¼Œå³<strong>ä¸å­˜åœ¨éƒ¨åˆ†ä¾èµ–</strong>ã€‚</li><li>3NFæ˜¯å¯¹å­—æ®µçš„<strong>å†—ä½™æ€§</strong>ï¼Œè¦æ±‚ä»»ä½•å­—æ®µä¸èƒ½ç”±å…¶ä»–å­—æ®µä¸­æ´¾ç”Ÿå‡ºæ¥ï¼Œå³<strong>ä¸å­˜åœ¨ä¼ é€’ä¾èµ–</strong>ã€‚</li></ul><h3 id="ç»˜åˆ¶E-Rå›¾ä¾‹"><a href="#ç»˜åˆ¶E-Rå›¾ä¾‹" class="headerlink" title="ç»˜åˆ¶E-Rå›¾ä¾‹"></a>ç»˜åˆ¶E-Rå›¾ä¾‹</h3><ol><li>ç¡®å®šæ‰€æœ‰çš„å®ä½“ï¼ˆçŸ©å½¢æ¡†ï¼‰</li><li>ç¡®å®šå®ä½“çš„è”ç³»ï¼ˆè¿çº¿ï¼‰</li><li>ç¡®å®šå®ä½“å’Œè”ç³»çš„å±æ€§ï¼ˆæ¤­åœ†æ¡†ï¼‰</li><li>ç¡®å®šå®ä½“çš„é”®ï¼ˆä¸‹åˆ’çº¿ï¼‰</li></ol><h3 id="è½¬æ¢å…³ç³»æ¨¡å¼"><a href="#è½¬æ¢å…³ç³»æ¨¡å¼" class="headerlink" title="è½¬æ¢å…³ç³»æ¨¡å¼"></a>è½¬æ¢å…³ç³»æ¨¡å¼</h3><table><thead><tr><th align="center">ç±»å‹</th><th align="center">æ˜ å°„æ–¹æ³•</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">ä¸€å…ƒè”ç³»</td><td align="center">ç›´æ¥æ˜ å°„</td><td align="center">å®ä½“çš„å±æ€§â†’å…³ç³»æ¨¡å¼çš„å±æ€§ï¼›å®ä½“çš„ä¸»é”®â†’å…³ç³»æ¨¡å¼çš„ä¸»é”®</td></tr><tr><td align="center">äºŒå…ƒè”ç³» - ä¸€å¯¹ä¸€</td><td align="center">åˆå¹¶å…³ç³»æ¨¡å¼</td><td align="center">åˆæˆä¸€ä¸ªå…³ç³»æ¨¡å¼ <strong>R</strong>ï¼›ä»»ä¸€å®ä½“çš„å…¨éƒ¨ä¸»é”®â†’å…³ç³»æ¨¡å¼çš„ä¸»é”®</td></tr><tr><td align="center">äºŒå…ƒè”ç³» - ä¸€å¯¹å¤š</td><td align="center">å¼•å…¥å¤–é”®</td><td align="center">ä¸€æ–¹å®ä½“çš„ä¸»é”®â†’å¤šæ–¹å®ä½“çš„å¤–é”®ï¼›è”ç³»çš„å±æ€§â†’å¤šæ–¹å®ä½“çš„å±æ€§</td></tr><tr><td align="center">äºŒå…ƒè”ç³» - å¤šå¯¹å¤š</td><td align="center">å¢åŠ å…³ç³»æ¨¡å¼</td><td align="center">å¢åŠ ä¸€ä¸ªå…³ç³»æ¨¡å¼ <strong>R</strong>ï¼›ä¸¤ä¸ªå®ä½“çš„ä¸»é”®å¹¶é›†â†’å…³ç³»æ¨¡å¼çš„ä¸»é”®ï¼›è”ç³»çš„å±æ€§â†’å…³ç³»æ¨¡å¼çš„å±æ€§</td></tr><tr><td align="center">è¶…ç±»å­ç±»</td><td align="center">åˆ†åŒ–å…³ç³»æ¨¡å¼</td><td align="center">åˆ†åŒ–ä¸¤ä¸ªå…³ç³»æ¨¡å¼ <strong>R1 å’Œ R2</strong>ï¼›R1æ˜¯çˆ¶å…³ç³»æ¨¡å¼ï¼ŒåŒ…æ‹¬R1ä¸»é”®å’ŒR1éä¸»é”®ï¼›R2æ˜¯å­å…³ç³»æ¨¡å¼ï¼ŒåŒ…æ‹¬R1ä¸»é”®å’ŒR2éä¸»é”®ï¼›è‹¥æ¦‚æ‹¬æ˜¯å…¨éƒ¨çš„ï¼Œä¸ç”¨åˆ›å»ºçˆ¶å…³ç³»æ¨¡å¼ï¼Œå­å…³ç³»æ¨¡å¼åŒ…æ‹¬æ‰€æœ‰</td></tr><tr><td align="center">å¤åˆå±æ€§</td><td align="center">ç”±å­å±æ€§ä»£æ›¿</td><td align="center">å¤åˆå±æ€§ A â†’ å¤šä¸ªå­å±æ€§ä»£æ›¿ A1, A2, A3, â€¦</td></tr><tr><td align="center">å¤šå€¼å±æ€§</td><td align="center">æ‹†åˆ†å…³ç³»æ¨¡å¼</td><td align="center">æ‹†æˆä¸¤ä¸ªå…³ç³»æ¨¡å¼ <strong>R1 å’Œ R2</strong>ï¼›R1åŒ…æ‹¬Rçš„ä¸»é”®å’ŒMçš„æœ¬èº«ï¼›R2åŒ…æ‹¬Rçš„ä¸»é”®å’Œé™¤å¤šå€¼å±æ€§å¤–çš„å±æ€§ï¼›æ³¨æ„è®¾ç½®çº§è”æ“ä½œ</td></tr></tbody></table><h2 id="MySQL-æ•°æ®åº“è¡¨è®¾è®¡"><a href="#MySQL-æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="MySQL æ•°æ®åº“è¡¨è®¾è®¡"></a><strong>MySQL æ•°æ®åº“è¡¨è®¾è®¡</strong></h2><h3 id="ç”¨æˆ·çš„æ•°æ®åº“è¡¨è®¾è®¡"><a href="#ç”¨æˆ·çš„æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="ç”¨æˆ·çš„æ•°æ®åº“è¡¨è®¾è®¡"></a>ç”¨æˆ·çš„æ•°æ®åº“è¡¨è®¾è®¡</h3><p><img src="/images/user_er.png" alt="ç”¨æˆ·çš„E-Rå›¾"></p><h4 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h4><ul><li><u>ç”¨æˆ·å®ä½“</u>æ‹¥æœ‰<strong>ç”¨æˆ·IDã€ç”¨æˆ·åç§°ã€åŠ å¯†å¯†ç å’ŒåŠ å¯†ç›å€¼</strong>å››ç§å±æ€§ï¼Œå…¶ä¸­å‡ºäºå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œå¯†ç éœ€è¦ç»è¿‡ç›å€¼åŠ å¯†åå­˜å‚¨åœ¨æ•°æ®åº“è€Œéç›´æ¥æ˜æ–‡å­˜å‚¨ã€‚</li></ul><h4 id="è”ç³»"><a href="#è”ç³»" class="headerlink" title="è”ç³»"></a>è”ç³»</h4><ul><li>æ²¡æœ‰è”ç³»å¯ä»¥åˆ†æã€‚</li></ul><h4 id="è½¬æ¢"><a href="#è½¬æ¢" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h4><ul><li>å¯¹ç”¨æˆ·çš„E-Rå›¾è¿›è¡Œä¸€å…ƒè”ç³»ç±»å‹è½¬æ¢ï¼Œå¾—å‡ºå…³ç³»æ¨¡å¼ï¼š<strong>ç”¨æˆ·å®ä½“çš„å±æ€§ä¸ºç‹¬ç«‹çš„ä¸€å¼ è¡¨</strong>ã€‚</li></ul><h3 id="æœåŠ¡çš„æ•°æ®åº“è¡¨è®¾è®¡"><a href="#æœåŠ¡çš„æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="æœåŠ¡çš„æ•°æ®åº“è¡¨è®¾è®¡"></a>æœåŠ¡çš„æ•°æ®åº“è¡¨è®¾è®¡</h3><p><img src="/images/service_er.png" alt="æœåŠ¡çš„E-Rå›¾"></p><h4 id="å®ä½“-1"><a href="#å®ä½“-1" class="headerlink" title="å®ä½“"></a>å®ä½“</h4><ul><li><u>æœåŠ¡å®ä½“</u>æ‹¥æœ‰<strong>æœåŠ¡IDã€æœåŠ¡åç§°ã€æœåŠ¡æè¿°å’Œåè®®ç±»å‹</strong>å››ç§å±æ€§ï¼Œå…¶ä¸­åè®®ç±»å‹æ˜¯å¤šå€¼å±æ€§ï¼Œç”¨äºæ‰©å±•å’Œé€‚é…æ¥å…¥ä¸åŒåè®®çš„æœåŠ¡ï¼Œç›®å‰å¯æ”¯æŒ <code>HTTP</code>ã€<code>HTTPS</code> å’Œ <code>WebSocket</code> åè®®ã€‚</li><li><u>åè®®æ¥å…¥ä¸è¯·æ±‚é‡å†™é…ç½®å®ä½“</u>å›ºå®šå…·æœ‰<strong>åœ°å€å’Œé‡å†™è§„åˆ™</strong>å±æ€§ï¼Œä»åè®®æ¥å…¥ä¸è¯·æ±‚é‡å†™é…ç½®ä¸­å¯ä»¥æ³›åŒ–å‡ºå„ç§ç±»å‹çš„åè®®é…ç½®ï¼Œä¸åŒåè®®çš„é…ç½®å†…å®¹ä¸å°½ç›¸åŒã€‚</li><li><u>æƒé™è®¤è¯é…ç½®å®ä½“</u>åŒ…å«<strong>ipé»‘ç™½åå•</strong>çš„å±æ€§ï¼Œç”¨äºé‰´åˆ«è¯·æ±‚æ¥æºã€‚</li><li><u>æµé‡æ§åˆ¶é…ç½®å®ä½“</u>æ˜¯ç›¸å¯¹æœåŠ¡è€Œè¨€çš„ï¼Œå…·æœ‰<strong>é™æµé—´éš”å’Œé™æµæ¬¡æ•°</strong>å±æ€§ï¼Œå¯ä»¥æ”¯æŒå‘¨æœŸçµæ´»çš„é™æµç­–ç•¥ã€‚</li><li><u>è´Ÿè½½å‡è¡¡é…ç½®å®ä½“</u>æœ‰ä¸‰å¤§å±æ€§ï¼Œåˆ†åˆ«ä¸º<strong>ipåˆ—è¡¨ã€weightåˆ—è¡¨å’Œç®—æ³•ç±»å‹</strong>ï¼Œå…¶ä¸­ç®—æ³•ç±»å‹æ˜¯å¤šå€¼å±æ€§ï¼Œæ ‡è¯†äº†è´Ÿè½½å‡è¡¡ä½¿ç”¨çš„ç®—æ³•ï¼Œç›®å‰æ”¯æŒéšæœºè´Ÿè½½å‡è¡¡ã€è½®è¯¢è´Ÿè½½å‡è¡¡ã€åŠ æƒè½®è¯¢è´Ÿè½½å‡è¡¡å’Œä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡å››ç§ç®—æ³•ã€‚</li></ul><h4 id="è”ç³»-1"><a href="#è”ç³»-1" class="headerlink" title="è”ç³»"></a>è”ç³»</h4><ul><li>æœåŠ¡å®ä½“ä¸åè®®æ¥å…¥ä¸è¯·æ±‚é‡å†™é…ç½®å®ä½“ã€æƒé™è®¤è¯é…ç½®å®ä½“ã€æµé‡æ§åˆ¶é…ç½®å®ä½“ã€è´Ÿè½½å‡è¡¡é…ç½®å®ä½“å’Œåå‘ä»£ç†é…ç½®å®ä½“çš„å…³ç³»éƒ½æ˜¯<strong>ä¸€å¯¹ä¸€çš„æ‹¥æœ‰å…³ç³»</strong>ã€‚ç‰¹åˆ«åœ°ï¼Œåè®®æ¥å…¥é…ç½®å®ä½“å­˜åœ¨<strong>æ³›åŒ–</strong>ï¼Œå¯ä»¥è¡ç”Ÿå‡ºä¸åŒç±»å‹çš„åè®®æ¥å…¥ä¸è¯·æ±‚é‡å†™é…ç½®ã€‚</li></ul><h4 id="è½¬æ¢-1"><a href="#è½¬æ¢-1" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h4><ul><li>å¯¹æœåŠ¡çš„E-Rå›¾è¿›è¡ŒäºŒå…ƒè”ç³»ç±»å‹è½¬æ¢ï¼Œå¾—å‡ºå…³ç³»æ¨¡å¼ï¼š<strong>æœåŠ¡å®ä½“ä¸æƒé™è®¤è¯é…ç½®å®ä½“ã€æµé‡æ§åˆ¶é…ç½®å®ä½“ã€è´Ÿè½½å‡è¡¡é…ç½®å®ä½“å’Œåå‘ä»£ç†é…ç½®å®ä½“åˆå¹¶ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œä¸ºäº†è€ƒè™‘åç»­å¯¹å…¶ä»–åè®®è¿›è¡Œæ‰©å±•ï¼Œæ•…æ¯ç§åè®®é…ç½®éƒ½å»ºè®®æ–°å»ºä¸€å¼ æ•°æ®åº“è¡¨</strong>ã€‚</li></ul><h3 id="åº”ç”¨çš„æ•°æ®åº“è¡¨è®¾è®¡"><a href="#åº”ç”¨çš„æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="åº”ç”¨çš„æ•°æ®åº“è¡¨è®¾è®¡"></a>åº”ç”¨çš„æ•°æ®åº“è¡¨è®¾è®¡</h3><p><img src="/images/app_er.png" alt="åº”ç”¨çš„E-Rå›¾"></p><h4 id="å®ä½“-2"><a href="#å®ä½“-2" class="headerlink" title="å®ä½“"></a>å®ä½“</h4><ul><li><u>åº”ç”¨å®ä½“</u>æ‹¥æœ‰<strong>åº”ç”¨IDã€åº”ç”¨æ ‡è¯†ã€åº”ç”¨åç§°å’Œåº”ç”¨å¯†é’¥</strong>å››ç§å±æ€§ï¼Œå…¶ä¸­å‡ºäºå®‰å…¨æ€§çš„è€ƒè™‘å¯†é’¥åº”è¯¥å­˜å‚¨åŠ å¯†åçš„å¯†æ–‡è€Œéæ˜æ–‡ã€‚</li><li><u>æƒé™è®¤è¯é…ç½®å®ä½“</u>åŒ…å«<strong>ipé»‘ç™½åå•</strong>çš„å±æ€§ï¼Œç”¨äºé‰´åˆ«è¯·æ±‚æ¥æºã€‚</li><li><u>æµé‡æ§åˆ¶é…ç½®å®ä½“</u>æ˜¯ç›¸å¯¹åº”ç”¨è€Œè¨€çš„ï¼Œå…·æœ‰<strong>QPDï¼ˆæ¯æ—¥è¯·æ±‚é‡ï¼‰é™åˆ¶å’ŒQPSï¼ˆæ¯ç§’è¯·æ±‚é‡ï¼‰é™åˆ¶</strong>ä¸¤ç§å±æ€§ã€‚</li></ul><h4 id="è”ç³»-2"><a href="#è”ç³»-2" class="headerlink" title="è”ç³»"></a>è”ç³»</h4><ul><li>åº”ç”¨å®ä½“ä¸æƒé™æ§åˆ¶é…ç½®å®ä½“å’Œæµé‡æ§åˆ¶é…ç½®å®ä½“çš„å…³ç³»éƒ½æ˜¯<strong>ä¸€å¯¹ä¸€çš„æ‹¥æœ‰å…³ç³»</strong>ã€‚</li></ul><h4 id="è½¬æ¢-2"><a href="#è½¬æ¢-2" class="headerlink" title="è½¬æ¢"></a>è½¬æ¢</h4><ul><li>å¯¹åº”ç”¨çš„E-Rå›¾è¿›è¡ŒäºŒå…ƒè”ç³»ç±»å‹è½¬æ¢ï¼Œå¾—å‡ºå…³ç³»æ¨¡å¼ï¼š<strong>æœåŠ¡å®ä½“ä¸æƒé™è®¤è¯é…ç½®å®ä½“å’Œæµé‡æ§åˆ¶é…ç½®å®ä½“åˆå¹¶ä¸ºä¸€å¼ æ•°æ®åº“è¡¨</strong>ã€‚</li></ul><h2 id="Redis-é”®å€¼è®¾è®¡"><a href="#Redis-é”®å€¼è®¾è®¡" class="headerlink" title="Redis é”®å€¼è®¾è®¡"></a><strong>Redis é”®å€¼è®¾è®¡</strong></h2><h3 id="ä¼šè¯çš„é”®å€¼è®¾è®¡"><a href="#ä¼šè¯çš„é”®å€¼è®¾è®¡" class="headerlink" title="ä¼šè¯çš„é”®å€¼è®¾è®¡"></a>ä¼šè¯çš„é”®å€¼è®¾è®¡</h3><table><thead><tr><th align="center">é”®</th><th align="center">å€¼ç±»å‹</th><th align="center">å€¼å†…å®¹</th></tr></thead><tbody><tr><td align="center">session_<code>{session_id}</code></td><td align="center">Binary</td><td align="center">ä¼šè¯ä¿¡æ¯</td></tr></tbody></table><h3 id="é…ç½®çš„é”®å€¼è®¾è®¡"><a href="#é…ç½®çš„é”®å€¼è®¾è®¡" class="headerlink" title="é…ç½®çš„é”®å€¼è®¾è®¡"></a>é…ç½®çš„é”®å€¼è®¾è®¡</h3><table><thead><tr><th align="center">é”®</th><th align="center">å€¼ç±»å‹</th><th align="center">å€¼å†…å®¹</th></tr></thead><tbody><tr><td align="center">app_<code>{app_id}</code></td><td align="center">String</td><td align="center">app po as json</td></tr><tr><td align="center">service_<code>{service_id}</code></td><td align="center">String</td><td align="center">service po as json</td></tr><tr><td align="center">lb_<code>{lb_id}</code></td><td align="center">String</td><td align="center">load balance po as json</td></tr><tr><td align="center">ac_<code>{ac_id}</code></td><td align="center">String</td><td align="center">access control po as json</td></tr></tbody></table><h3 id="è®¡æ•°å™¨çš„é”®å€¼è®¾è®¡"><a href="#è®¡æ•°å™¨çš„é”®å€¼è®¾è®¡" class="headerlink" title="è®¡æ•°å™¨çš„é”®å€¼è®¾è®¡"></a>è®¡æ•°å™¨çš„é”®å€¼è®¾è®¡</h3><table><thead><tr><th align="center">é”®</th><th align="center">å€¼ç±»å‹</th><th align="center">å€¼å†…å®¹</th></tr></thead><tbody><tr><td align="center">flow_day_count_<code>{day_format}</code>_flow_total_count</td><td align="center">String</td><td align="center">æ€»è®¡æ¯ä¸€å¤©çš„æµé‡ç»Ÿè®¡æ•°</td></tr><tr><td align="center">flow_hour_count_<code>{hour_format}</code>_flow_total_count</td><td align="center">String</td><td align="center">æ€»è®¡æ¯å°æ—¶çš„æµé‡ç»Ÿè®¡æ•°</td></tr><tr><td align="center">flow_day_count_<code>{day_format}</code>_flow_service_count_<code>{service_name}</code></td><td align="center">String</td><td align="center">å•ä¸ªæœåŠ¡æ¯ä¸€å¤©çš„æµé‡ç»Ÿè®¡æ•°</td></tr><tr><td align="center">flow_hour_count_<code>{hour_format}</code>_flow_service_count_<code>{service_name}</code></td><td align="center">String</td><td align="center">å•ä¸ªæœåŠ¡æ¯å°æ—¶çš„æµé‡ç»Ÿè®¡æ•°</td></tr><tr><td align="center">flow_day_count_<code>{day_format}</code>_flow_app_count_<code>{app_id}</code></td><td align="center">String</td><td align="center">å•ä¸ªåº”ç”¨æ¯ä¸€å¤©çš„æµé‡ç»Ÿè®¡æ•°</td></tr><tr><td align="center">flow_hour_count_<code>{hour_format}</code>_flow_app_count_<code>{app_id}</code></td><td align="center">String</td><td align="center">å•ä¸ªåº”ç”¨æ¯å°æ—¶çš„æµé‡ç»Ÿè®¡æ•°</td></tr></tbody></table><h3 id="é™æµå™¨çš„é”®å€¼è®¾è®¡"><a href="#é™æµå™¨çš„é”®å€¼è®¾è®¡" class="headerlink" title="é™æµå™¨çš„é”®å€¼è®¾è®¡"></a>é™æµå™¨çš„é”®å€¼è®¾è®¡</h3><table><thead><tr><th align="center">é”®</th><th align="center">å€¼ç±»å‹</th><th align="center">å€¼å†…å®¹</th></tr></thead><tbody><tr><td align="center">rate_flow_service_count_<code>{service_name}</code></td><td align="center">String</td><td align="center">å•ä¸ªæœåŠ¡è°ƒç”¨ç»“æŸçš„æ—¶é—´ç‚¹</td></tr><tr><td align="center">rate_flow_app_count_<code>{app_id}</code></td><td align="center">String</td><td align="center">å•ä¸ªåº”ç”¨è°ƒç”¨ç»“æŸçš„æ—¶é—´ç‚¹</td></tr></tbody></table><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a><strong>Refs</strong></h2><ul><li><a href="https://segmentfault.com/a/1190000013695030" target="_blank" rel="noopener">æ•°æ®åº“é€»è¾‘è®¾è®¡ä¹‹ä¸‰å¤§èŒƒå¼é€šä¿—ç†è§£</a></li><li><a href="https://zhuanlan.zhihu.com/p/29029129#:~:text=er%E5%9B%BE%E7%9A%84%E5%B1%9E%E6%80%A7%E8%BF%98,%E5%92%8C%E5%90%8D%E5%AD%97%E5%B1%9E%E6%80%A7%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A&text=%E6%B4%BE%E7%94%9F%E5%B1%9E%E6%80%A7(derivers%20attribute)%EF%BC%9A,%E5%AD%98%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%B1%9E%E6%80%A7%E3%80%82" target="_blank" rel="noopener">æ•°æ®åº“ERå›¾åŸºç¡€æ¦‚å¿µæ•´ç†</a></li><li><a href="https://zhuanlan.zhihu.com/p/74394591" target="_blank" rel="noopener">å¦‚ä½•ç”»å¥½ERå›¾</a></li><li><a href="https://www.pianshen.com/article/1262363338/" target="_blank" rel="noopener">å°†E-Rå›¾è½¬æ¢æˆå…³ç³»æ¨¡å¼</a></li><li><a href="https://lanlan2017.github.io/ReadingNotes/ef76614/" target="_blank" rel="noopener">æ•°æ®åº“è®¾è®¡è¿‡ç¨‹</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;æ•°æ®åº“è®¾è®¡&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸¤ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MySQL&lt;/code&gt; æ•°æ®åº“è¡¨è®¾è®¡ - &lt;strong&gt;E-Rå›¾åŠå…³ç³»æ¨¡å¼&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Redis&lt;/code&gt; é”®å€¼è®¾è®¡&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(3) å¾®æœåŠ¡è®¾è®¡</title>
    <link href="http://yoursite.com/2021/06/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(3)/"/>
    <id>http://yoursite.com/2021/06/03/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(3)/</id>
    <published>2021-06-02T23:00:21.000Z</published>
    <updated>2021-06-18T08:18:18.511Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>å¾®æœåŠ¡è®¾è®¡</strong>ï¼Œåˆ†ä¸º<strong>ä¸¤ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡ - <strong>æ—¶åºå›¾</strong></li><li>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡ - <strong>æ—¶åºå›¾</strong></li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a><strong>UML</strong></h2><ul><li><u>æ—¶åºå›¾</u>ä¸€èˆ¬ç”±<strong>è§’è‰²ã€å¯¹è±¡ã€ç”Ÿå‘½çº¿ã€æ§åˆ¶ç„¦ç‚¹ã€æ¶ˆæ¯å’Œç»„åˆç‰‡æ®µ</strong>æ„æˆã€‚</li></ul><h3 id="æ§åˆ¶ç„¦ç‚¹"><a href="#æ§åˆ¶ç„¦ç‚¹" class="headerlink" title="æ§åˆ¶ç„¦ç‚¹"></a>æ§åˆ¶ç„¦ç‚¹</h3><ul><li>æ§åˆ¶ç„¦ç‚¹æ˜¯æ—¶åºå›¾ä¸­è¡¨ç¤ºæ—¶é—´æ®µçš„ç¬¦å·ï¼Œåœ¨æ­¤æ—¶é—´æ®µå†…å¯¹è±¡å°†æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</li></ul><h3 id="æ¶ˆæ¯"><a href="#æ¶ˆæ¯" class="headerlink" title="æ¶ˆæ¯"></a>æ¶ˆæ¯</h3><table><thead><tr><th align="center">æ¶ˆæ¯ç±»å‹</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">åŒæ­¥æ¶ˆæ¯</td><td align="center">å‘é€è€…åŒæ­¥è°ƒç”¨æ¥æ”¶è€…ï¼Œä¸¤è€…é¡ºåºå·¥ä½œ</td></tr><tr><td align="center">å¼‚æ­¥æ¶ˆæ¯</td><td align="center">å‘é€è€…å¼‚æ­¥è°ƒç”¨æ¥æ”¶è€…ï¼Œä¸¤è€…å¹¶å‘å·¥ä½œ</td></tr><tr><td align="center">è¿”å›æ¶ˆæ¯</td><td align="center">ä»è°ƒç”¨ä¸­è¿”å›ç»“æœ</td></tr><tr><td align="center">è‡ªè”æ¶ˆæ¯</td><td align="center">è°ƒç”¨å¯¹è±¡è‡ªèº«æ–¹æ³•</td></tr></tbody></table><h3 id="ç»„åˆç‰‡æ®µ"><a href="#ç»„åˆç‰‡æ®µ" class="headerlink" title="ç»„åˆç‰‡æ®µ"></a>ç»„åˆç‰‡æ®µ</h3><table><thead><tr><th align="center">ç»„åˆç±»å‹</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Alternative Fragment (alt)</td><td align="center">ç›¸å½“äº if-else</td></tr><tr><td align="center">Option Fragment (opt)</td><td align="center">ç›¸å½“äº switch-case</td></tr><tr><td align="center">Parallel Fragment (par)</td><td align="center">ç›¸å½“äº go</td></tr><tr><td align="center">Loop Fragment (loop)</td><td align="center">ç›¸å½“äº for</td></tr></tbody></table><h2 id="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡"><a href="#å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡" class="headerlink" title="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡"></a><strong>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡</strong></h2><h3 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h3><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—çš„æ¶æ„å›¾</u>ï¼Œå¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—çš„å†…éƒ¨é€»è¾‘æ˜¯å…¸å‹çš„MVCæ¨¡å¼ï¼Œç”± <strong><code>UI</code> å±‚ã€<code>Router</code> å±‚ã€<code>Controller</code> å±‚å’Œ <code>Dao</code> å±‚</strong>ç»„æˆã€‚</li></ul><p><img src="/images/microservice_api_gateway_admin_arch.png" alt="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—æ¶æ„å›¾"></p><ol><li><strong><code>UI</code> å±‚</strong>å³å‰ç«¯å¯è§†åŒ–çš„ç®¡ç†å¹³å°ç•Œé¢ï¼Œå‰ç«¯ä»£ç è¢«ç¼–è¯‘æ‰“åŒ…åï¼Œå°†é™æ€æ‰˜ç®¡äºç®¡ç†æ¨¡å—ä¸­ã€‚</li><li><strong><code>Router</code> å±‚</strong>å¯¹å¤–æš´éœ²APIæ¥å£ï¼Œå®šä¹‰äº†APIçš„è¯·æ±‚æ–¹æ³•å’Œè®¿é—®è·¯å¾„ï¼Œç¼–æ’äº†æ‰€åº”ç”¨çš„ä¸­é—´ä»¶çš„ç±»å‹å’Œé¡ºåºã€‚</li><li><strong><code>Controller</code> å±‚</strong>æ˜¯å…·ä½“å®ç°ä¸šåŠ¡é€»è¾‘çš„å±‚æ¬¡ï¼Œåœ¨è¯¥å±‚æ¬¡è¿›è¡Œç”¨æˆ·ç™»å½•ã€ç”¨æˆ·ç™»å‡ºã€ç®¡ç†ç”¨æˆ·ã€ç®¡ç†æœåŠ¡ã€ç®¡ç†åº”ç”¨å’Œæ•°æ®ç»Ÿè®¡åŠŸèƒ½çš„ç¼–å†™ã€‚</li><li><strong><code>Dao</code> å±‚</strong>ä½œä¸ºæ•°æ®åº“é©±åŠ¨å±‚ç›´æ¥å¯¹æ¥ä¸åŒç±»å‹çš„æ•°æ®åº“ï¼Œç®¡ç†æ¨¡å—æ”¯æŒå¯¹ <code>MySQL</code> å’Œ <code>Redis</code> è¿›è¡Œæ“ä½œã€‚</li><li><code>UI</code> å±‚å’Œ <code>Router</code> å±‚ä¹‹é—´ä¸»è¦ä¼ è¾“ <strong><code>json</code></strong> æ•°æ®ï¼Œç»Ÿä¸€äº†å‰åç«¯çš„æ•°æ®ä¼ è¾“æ ¼å¼ï¼›<code>Router</code> å±‚å’Œ <code>Controller</code> å±‚ä¹‹é—´ä¸»è¦ä¼ è¾“ç¨‹åºå®šä¹‰çš„ <strong><code>dto</code> (æ•°æ®ä¼ è¾“å¯¹è±¡)</strong> ç»“æ„ä½“ï¼›<code>Controller</code> å±‚å’Œ <code>Dao</code> å±‚ä¹‹é—´ä¸»è¦ä¼ è¾“ç¨‹åºå®šä¹‰çš„ <strong><code>po</code> (æŒä¹…åŒ–å¯¹è±¡)</strong> ç»“æ„ä½“ã€‚</li></ol><h3 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h3><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—çš„æ—¶åºå›¾</u>ï¼Œæ¥æè¿°ç®¡ç†å‘˜ç”¨æˆ·å¦‚ä½•é€šè¿‡ç®¡ç†æ¨¡å—è¿›è¡Œç™»å½•ç™»å‡ºå’Œå„é¡¹é…ç½®ç®¡ç†ã€‚</li></ul><p><img src="/images/microservice_api_gateway_admin_seq.png" alt="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—æ—¶åºå›¾"></p><ol><li><strong>ç¬¬1æ­¥åˆ°ç¬¬2æ­¥</strong>ï¼Œç®¡ç†å‘˜ç”¨æˆ·éœ€è¦è¾“å…¥ç”¨æˆ·åç§°å’Œç”¨æˆ·å¯†ç ç™»å½•ï¼Œæ­¤æ—¶ç™»å½•ç”Ÿæˆçš„ä¼šè¯ä¿¡æ¯å°†ä¿å­˜åˆ° <code>Redis</code> ï¼Œä»¥ä¾¿ä¿æŒä¸€å®šæ—¶é—´å†…çš„ç™»å½•çŠ¶æ€ã€‚</li><li><strong>ç¬¬3æ­¥åˆ°ç¬¬5æ­¥</strong>ï¼Œç®¡ç†å‘˜ç”¨æˆ·æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤é…ç½®ï¼Œé…ç½®çš„å˜æ›´å°†ä¼šåˆ†åˆ«å­˜å…¥åˆ° <code>MySQL</code> å’Œ <code>Redis</code> ä¸­ã€‚</li><li><strong>ç¬¬6æ­¥åˆ°ç¬¬12æ­¥</strong>ï¼Œç®¡ç†å‘˜ç”¨æˆ·æŸ¥è¯¢é…ç½®ï¼Œè‹¥ç¼“å­˜å‘½ä¸­åˆ™ç›´æ¥ä» <code>Redis</code> ä¸­è¯»å–é…ç½®çš„ç¼“å­˜æ•°æ®ï¼Œè‹¥ç¼“å­˜æœªå‘½ä¸­åˆ™ä¼šä» <code>MySQL</code> ä¸­è¯»å–é…ç½®çš„æ•°æ®åº“æ•°æ®ï¼Œå¹¶å°†é…ç½®å›å†™åˆ° <code>Redis</code> ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›é…ç½®ç»™ç®¡ç†å‘˜ç”¨æˆ·ã€‚</li><li><strong>ç¬¬13æ­¥åˆ°ç¬¬14æ­¥</strong>ï¼Œå½“ç®¡ç†å‘˜ç”¨æˆ·ç™»å‡ºæ—¶ï¼Œç®¡ç†æ¨¡å—å°†åˆ é™¤ <code>Redis</code> ä¸­å¯¹åº”çš„ä¼šè¯ä¿¡æ¯ï¼Œæ­¤åè¯¥ç®¡ç†å‘˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ä¸å†ä¿æŒï¼Œå¯ä»¥é€‰æ‹©é‡æ–°ç™»å½•æˆ–è€…åˆ‡æ¢è´¦æˆ·ç™»å½•ã€‚</li></ol><h2 id="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡"><a href="#å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡" class="headerlink" title="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡"></a><strong>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡</strong></h2><h3 id="æ¶æ„å›¾-1"><a href="#æ¶æ„å›¾-1" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h3><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—çš„æ¶æ„å›¾</u>ï¼Œå¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”±å¤šä¸ªä¸­é—´ä»¶ä»¥æ´‹è‘±æ¨¡å‹çš„å½¢å¼ç»„ç»‡èµ·æ¥ï¼Œå¹¶ä¸ <code>Redis</code> å’Œ <code>Consul</code> ç»“åˆä½¿ç”¨ï¼Œä¸ºä¸åŒå½¢æ€çš„å®¢æˆ·ç«¯æä¾›å¤šåè®®çš„åå°æœåŠ¡ç»Ÿä¸€å…¥å£ã€‚</li></ul><p><img src="/images/microservice_api_gateway_core_arch.png" alt="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—æ¶æ„å›¾"></p><ol><li><code>App</code> åº”ç”¨æˆ– <code>Web</code> åº”ç”¨å‘èµ·è¯·æ±‚ï¼Œåœ¨æ ¸å¿ƒæ¨¡å—ä¸­ç»è¿‡åè®®æ¥å…¥ã€æƒé™è®¤è¯ã€æµé‡ç»Ÿè®¡ã€æµé‡æ§åˆ¶ã€è¯·æ±‚é‡å†™ã€è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†ä¸­é—´ä»¶çš„å¤„ç†ï¼Œæœ€ç»ˆåˆ°è¾¾åå°çš„ <code>HTTP</code> æœåŠ¡ã€<code>HTTPS</code> æœåŠ¡æˆ– <code>WebSocket</code> æœåŠ¡ã€‚</li><li>å…¶ä¸­ï¼Œåå°çš„æœåŠ¡åº”é¢„å…ˆé…ç½®å¥½æœåŠ¡å’Œåº”ç”¨çš„é…ç½®ï¼Œæ–¹ä¾¿æ ¸å¿ƒæ¨¡å—çš„åè®®æ¥å…¥ä¸­é—´ä»¶å’Œæƒé™è®¤è¯ä¸­é—´ä»¶è¯»å–æœåŠ¡å’Œåº”ç”¨çš„é…ç½®è¿›è€Œå¤„ç†åç»­çš„ä¸šåŠ¡é€»è¾‘ã€‚åŒæ—¶ï¼Œåå°çš„æœåŠ¡ä¹Ÿåº”å…ˆåœ¨ <code>Consul</code> ä¸­æ³¨å†ŒæœåŠ¡åç§°å’Œåœ°å€ï¼Œæ–¹ä¾¿æ ¸å¿ƒæ¨¡å—çš„è´Ÿè½½å‡è¡¡ä¸­é—´ä»¶å‘ç°æœåŠ¡åœ°å€ï¼Œæ ¹æ®æƒé‡åˆ—è¡¨è®¾ç½®å’Œè´Ÿè½½å‡è¡¡ç®—æ³•åˆç†åˆ†å‘æµé‡ï¼Œæœ€åäº¤ç”±åå‘ä»£ç†ä¸­é—´ä»¶å»è®¿é—®å®é™…çš„åå°æœåŠ¡ã€‚</li><li>ç‰¹åˆ«åœ°ï¼Œåœ¨æ ¸å¿ƒæ¨¡å—ä¸­åº”è¯¥ä¿æŒå¯¹æœåŠ¡åœ°å€å˜åŒ–çš„ç›‘å¬ï¼Œ<code>Consul</code> ä¹Ÿæœ‰å¿…è¦å‘¨æœŸæ€§å¯¹åå°æœåŠ¡è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ã€‚</li></ol><h3 id="æ—¶åºå›¾-1"><a href="#æ—¶åºå›¾-1" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h3><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—çš„æ—¶åºå›¾</u>ï¼Œæ¥è¯´æ˜åº”ç”¨å¦‚ä½•é€šè¿‡æ ¸å¿ƒæ¨¡å—è¿›è¡Œå…¬å…±é€»è¾‘å¤„ç†å’Œè¯·æ±‚ä»£ç†è½¬å‘ã€‚</li></ul><p><img src="/images/microservice_api_gateway_core_seq.png" alt="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—æ—¶åºå›¾"></p><ol><li><strong>ç¬¬1æ­¥</strong>ï¼Œåº”ç”¨å‘èµ·è¯·æ±‚ã€‚</li><li><strong>ç¬¬2æ­¥åˆ°ç¬¬7æ­¥</strong>ï¼Œæ ¸å¿ƒæ¨¡å—å…ˆå‘ <code>Redis</code> ç¼“å­˜æŸ¥è¯¢æœåŠ¡é…ç½®è¿›è¡Œåè®®æ¥å…¥ï¼Œç„¶åæŸ¥è¯¢åº”ç”¨é…ç½®è¿›è¡Œæƒé™è®¤è¯ã€‚</li><li><strong>ç¬¬8æ­¥åˆ°ç¬¬11æ­¥</strong>ï¼Œè¿›è¡Œæµé‡ç»Ÿè®¡å’Œæµé‡æ§åˆ¶ï¼Œå¹¶å›å†™å…¥ <code>Redis</code>ã€‚</li><li><strong>ç¬¬12æ­¥</strong>ï¼Œæ ¹æ®è§„åˆ™è¿›è¡Œè¯·æ±‚é‡å†™ã€‚</li><li><strong>ç¬¬13æ­¥åˆ°ç¬¬15æ­¥</strong>ï¼Œæ ¹æ®æœåŠ¡å‘ç°è·å–çš„åœ°å€åˆ—è¡¨ä»¥åŠé¢„å…ˆé…ç½®çš„æƒé‡åˆ—è¡¨åº”ç”¨æŒ‡å®šçš„è´Ÿè½½å‡è¡¡ç®—æ³•é€‰å‡ºè®¿é—®åœ°å€ã€‚</li><li><strong>ç¬¬16æ­¥åˆ°ç¬¬18æ­¥</strong>ï¼Œæ ¸å¿ƒæ¨¡å—ä½¿ç”¨è´Ÿè½½å‡è¡¡åœ°å€åå‘ä»£ç†è®¿é—®åå°æœåŠ¡ï¼Œå¹¶å°†å“åº”è¿”å›ç»™åº”ç”¨ã€‚</li></ol><h2 id="FAQs"><a href="#FAQs" class="headerlink" title="FAQs"></a><strong>FAQs</strong></h2><blockquote><p><strong>Qï¼š</strong>å¹¶è¡Œå’Œå¼‚æ­¥å¦‚ä½•ç”¨æ—¶åºå›¾æ¥è¡¨ç¤ºï¼Ÿ</p><p><strong>Aï¼š</strong>é¦–å…ˆç¡®å®šè§¦å‘çš„æ—¶é—´ç‚¹ï¼Œæ¥ç€åˆ¤æ–­æ˜¯å¦å¹¶è¡Œï¼Œæœ€ååˆ¤æ–­æ˜¯å¦å¼‚æ­¥</p></blockquote><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a><strong>Refs</strong></h2><ul><li><a href="https://www.cnblogs.com/ywqu/archive/2009/12/22/1629426.html" target="_blank" rel="noopener">UMLå»ºæ¨¡ä¹‹æ—¶åºå›¾ï¼ˆSequence Diagramï¼‰</a></li><li><a href="https://blog.csdn.net/craftsman1970/article/details/72629590" target="_blank" rel="noopener">åºåˆ—å›¾(Sequence Diagram)::å¹¶è¡ŒåŒº/ä¸´ç•ŒåŒº</a></li><li><a href="https://blog.csdn.net/craftsman1970/article/details/71136232" target="_blank" rel="noopener">åºåˆ—å›¾(Sequence Diagram)::åŒæ­¥/å¼‚æ­¥</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;å¾®æœåŠ¡è®¾è®¡&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸¤ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—è®¾è®¡ - &lt;strong&gt;æ—¶åºå›¾&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—è®¾è®¡ - &lt;strong&gt;æ—¶åºå›¾&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(2) æ•´ä½“è®¾è®¡</title>
    <link href="http://yoursite.com/2021/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(2)/"/>
    <id>http://yoursite.com/2021/06/02/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(2)/</id>
    <published>2021-06-01T23:00:21.000Z</published>
    <updated>2021-06-18T07:08:21.131Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>æ•´ä½“è®¾è®¡</strong>ï¼Œåˆ†ä¸º<strong>ä¸¤ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li>é€»è¾‘æ¶æ„</li><li>è°ƒç”¨å…³ç³»</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="é€»è¾‘æ¶æ„"><a href="#é€»è¾‘æ¶æ„" class="headerlink" title="é€»è¾‘æ¶æ„"></a><strong>é€»è¾‘æ¶æ„</strong></h2><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³çš„æ•´ä½“é€»è¾‘æ¶æ„å›¾</u>ï¼Œå±•ç¤ºäº†å¾®æœåŠ¡APIç½‘å…³çš„ç»„æˆéƒ¨åˆ†å’Œé€»è¾‘åŠŸèƒ½ã€‚å¾®æœåŠ¡APIç½‘å…³ç”±<strong>ç®¡ç†æ¨¡å—</strong>å’Œ<strong>æ ¸å¿ƒæ¨¡å—</strong>ä¸¤ä¸ªå¾®æœåŠ¡æä¾›ä¸»è¦åŠŸèƒ½ï¼ŒåŒæ—¶è¿˜ä¾èµ–<strong>æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä¸­å¿ƒ</strong>æä¾›æœåŠ¡çš„æ³¨å†Œå’Œå‘ç°ï¼Œä»¥åŠ<strong>æ•°æ®åº“å±‚</strong>æä¾›æ•°æ®çš„ç¼“å­˜å’ŒæŒä¹…åŒ–ã€‚</li></ul><p><img src="/images/microservice_api_gateway_arch.png" alt="å¾®æœåŠ¡APIç½‘å…³é€»è¾‘æ¶æ„å›¾"></p><ol><li><strong>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—</strong>ï¼Œå†…ç½®äº†UIç•Œé¢å±‚æä¾›å¯è§†åŒ–çš„ç®¡ç†å¹³å°ï¼Œè¯·æ±‚ç»ç”±APIæ¥å£å±‚å¯ä»¥è®¿é—®ç”¨æˆ·ç™»å½•ã€ç”¨æˆ·ç™»å‡ºã€ç®¡ç†æœåŠ¡ã€ç®¡ç†åº”ç”¨ã€ç®¡ç†ç”¨æˆ·å’Œæ•°æ®ç»Ÿè®¡ç­‰åŠŸèƒ½ï¼Œå®ç°ä¸€ç«™å¼çš„ç½‘å…³é…ç½®ç®¡ç†ã€‚</li><li><strong>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—</strong>ï¼Œç”±åè®®æ¥å…¥ä¸­é—´ä»¶è¯†åˆ«è¯·æ±‚å’ŒåŒ¹é…é…ç½®ï¼Œæƒé™è®¤è¯ã€è¯·æ±‚é‡å†™ã€æµé‡ç»Ÿè®¡å’Œæµé‡æ§åˆ¶ä¸­é—´ä»¶è¿›è¡Œå…¬å…±ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œè´Ÿè½½å‡è¡¡ä¸­é—´ä»¶ä»æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä¸­å¿ƒå‘ç°å¯ç”¨æœåŠ¡åˆ—è¡¨å¹¶åº”ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•æ‰¾å‡ºåˆé€‚çš„å“åº”å®ä¾‹ï¼Œåå‘ä»£ç†æ ¹æ®è´Ÿè½½å‡è¡¡åœ°å€å°†è¯·æ±‚è½¬å‘è‡³æœåŠ¡ç«¯æœåŠ¡å¹¶è¿”å›å“åº”ç»™å®¢æˆ·ç«¯åº”ç”¨ã€‚</li><li><strong>æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä¸­å¿ƒ</strong>ï¼ŒæŠ€æœ¯é€‰å‹ä¸ºå¼€ç®±å³ç”¨çš„ <code>Consul</code>ï¼Œä¸»è¦æä¾›æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°çš„åŠŸèƒ½ã€‚å¯¹æœåŠ¡ç«¯æœåŠ¡è€Œè¨€ï¼Œæä¾›æœåŠ¡æ³¨å†Œçš„ç»Ÿä¸€å­˜å‚¨ä½ç½®ï¼Œä¿å­˜æœåŠ¡çš„åç§°ã€åœ°å€ã€ç«¯å£å’Œæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥å¯¹å·²æ³¨å†Œçš„æœåŠ¡è¿›è¡Œè‡ªå®šä¹‰çš„å‘¨æœŸæ€§å¥åº·æ£€æŸ¥ã€‚å¯¹äºå¾®æœåŠ¡APIç½‘å…³è€Œè¨€ï¼Œè´Ÿè½½å‡è¡¡ä¸­é—´ä»¶å¯ä»¥æ ¹æ®æœåŠ¡åå‘ç°å¯ç”¨çš„æœåŠ¡å®ä¾‹åœ°å€ï¼Œå¹¶åŠ¨æ€ç›‘å¬è¿™äº›åœ°å€çš„å¯ç”¨æƒ…å†µå’ŒçŠ¶æ€å˜åŒ–ï¼ŒåŠæ—¶æ›´æ–°è´Ÿè½½å‡è¡¡çš„åœ°å€åˆ—è¡¨ã€‚</li><li><strong>æ•°æ®åº“å±‚</strong>ï¼ŒåŒ…æ‹¬ <code>MySQL</code> å…³ç³»å‹æ•°æ®åº“å’Œ <code>Redis</code> éå…³ç³»å‹æ•°æ®åº“ã€‚<code>MySQL</code> ç”¨äºæŒä¹…åŒ–ç”¨æˆ·ã€æœåŠ¡å’Œåº”ç”¨çš„ä¿¡æ¯ï¼Œæ˜¯ä¸šåŠ¡æ•°æ®å­˜æ”¾çš„ä½ç½®å’Œç¼“å­˜æ•°æ®åŒæ­¥çš„æ¥æºã€‚<code>Redis</code> ç”¨ä½œç¼“å­˜å’Œè®¡æ•°å™¨ï¼ŒåŠ å¿«å¾®æœåŠ¡APIç½‘å…³å¤„ç†å®¢æˆ·ç«¯åº”ç”¨è¯·æ±‚çš„é€Ÿåº¦ï¼Œå®ç°ç³»ç»Ÿæµé‡çš„ç»Ÿè®¡å’Œç›‘æ§ï¼Œå¹¶æ ¹æ®ç­–ç•¥æ§åˆ¶æµé‡çš„è¿›å‡ºã€‚</li></ol><h2 id="è°ƒç”¨å…³ç³»"><a href="#è°ƒç”¨å…³ç³»" class="headerlink" title="è°ƒç”¨å…³ç³»"></a><strong>è°ƒç”¨å…³ç³»</strong></h2><ul><li>ä¸‹å›¾æ˜¯<u>å¾®æœåŠ¡APIç½‘å…³çš„æ•´ä½“è°ƒç”¨å…³ç³»å›¾</u>ï¼Œå±•ç¤ºäº†å¾®æœåŠ¡APIç½‘å…³å„æ¨¡å—åŠå…¶ä¾èµ–ä½œä¸ºä¸€ä¸ªæ•´ä½“å¦‚ä½•ä¸å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›è¡Œäº¤äº’çš„è¿‡ç¨‹ã€‚å…¶ä¸­<strong>å®¢æˆ·ç«¯</strong>ç”±ç®¡ç†å‘˜ç”¨æˆ·ã€<code>Web/App</code> åº”ç”¨ç»„æˆï¼Œ<strong>å¾®æœåŠ¡APIç½‘å…³</strong>ç”±ç®¡ç†æ¨¡å—ã€æ ¸å¿ƒæ¨¡å—ã€<code>MySQL</code>ã€<code>Redis</code> å’Œ <code>Consul</code> ç»„æˆï¼Œ<strong>æœåŠ¡ç«¯</strong>ç”±å¾®æœåŠ¡ç»„æˆã€‚</li></ul><p><img src="/images/microservice_api_gateway_call.png" alt="å¾®æœåŠ¡APIç½‘å…³è°ƒç”¨å…³ç³»å›¾"></p><ol><li><strong>ç¬¬1æ­¥</strong>ï¼ŒæœåŠ¡ç«¯çš„å¾®æœåŠ¡å…ˆåœ¨æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä¸­å¿ƒ <code>Consul</code> ä¸­æ³¨å†Œè¯¥å¾®æœåŠ¡çš„åç§°å’Œåœ°å€ã€‚</li><li><strong>ç¬¬2æ­¥</strong>ï¼Œå®¢æˆ·ç«¯çš„ç®¡ç†å‘˜ç”¨æˆ·åœ¨ç®¡ç†æ¨¡å—ä¸­é…ç½®æœåŠ¡å’Œåº”ç”¨ã€‚</li><li><strong>ç¬¬3æ­¥</strong>ï¼Œé…ç½®æˆåŠŸå†™å…¥ <code>MySQL</code> å…³ç³»å‹æ•°æ®åº“å’Œ <code>Redis</code> éå…³ç³»å‹æ•°æ®åº“ä¸­ã€‚</li><li><strong>ç¬¬4æ­¥</strong>ï¼Œå®¢æˆ·ç«¯çš„ <code>Web</code> åº”ç”¨æˆ– <code>App</code> åº”ç”¨å³å¯é€šè¿‡æ ¸å¿ƒæ¨¡å—è¯·æ±‚æœåŠ¡ç«¯çš„å¾®æœåŠ¡ã€‚</li><li><strong>ç¬¬5æ­¥</strong>ï¼Œæ ¸å¿ƒæ¨¡å—åœ¨ <code>Redis</code> ç¼“å­˜ä¸­è¯»å–æœåŠ¡å’Œåº”ç”¨çš„é…ç½®ã€‚</li><li><strong>ç¬¬6æ­¥</strong>ï¼Œæ ¸å¿ƒæ¨¡å—åœ¨æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä¸­å¿ƒ <code>Consul</code> ä¸­è·å–å¯ç”¨çš„åœ°å€åˆ—è¡¨ã€‚</li><li><strong>ç¬¬7æ­¥</strong>ï¼Œç»è¿‡æ ¸å¿ƒæ¨¡å—çš„ä¸€ç³»åˆ—å…¬å…±ä¸šåŠ¡é€»è¾‘ä¸­é—´ä»¶å¤„ç†åï¼Œè¯·æ±‚è¢«åå‘ä»£ç†åˆ°å·²æ³¨å†Œçš„å¾®æœåŠ¡ï¼ŒæœåŠ¡ç«¯çš„å¾®æœåŠ¡æ¥æ”¶åˆ°è¯·æ±‚å¹¶å¤„ç†åè¿”å›å“åº”ç»™æ ¸å¿ƒæ¨¡å—ï¼Œæ ¸å¿ƒæ¨¡å—å†è¿”å›å“åº”ç»™å®¢æˆ·ç«¯çš„åº”ç”¨ã€‚</li></ol><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;æ•´ä½“è®¾è®¡&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸¤ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€»è¾‘æ¶æ„&lt;/li&gt;
&lt;li&gt;è°ƒç”¨å…³ç³»&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
  </entry>
  
  <entry>
    <title>#Microservice# å¾®æœåŠ¡APIç½‘å…³çš„è®¾è®¡ä¸å®ç°(1) éœ€æ±‚åˆ†æ</title>
    <link href="http://yoursite.com/2021/06/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(1)/"/>
    <id>http://yoursite.com/2021/06/01/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0(1)/</id>
    <published>2021-05-31T23:00:21.000Z</published>
    <updated>2021-06-20T12:45:09.180Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»<u>å¾®æœåŠ¡APIç½‘å…³</u>çš„<strong>éœ€æ±‚åˆ†æ</strong>ï¼Œåˆ†ä¸º<strong>ä¸¤ä¸ª</strong>æ–¹é¢ï¼š</p><ul><li>åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ - <strong>ç”¨ä¾‹å›¾å’Œç”¨ä¾‹è¡¨</strong></li><li>éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ</li></ul><hr><a id="more"></a><h1 id="ç›®å½•-Table-of-Contents"><a href="#ç›®å½•-Table-of-Contents" class="headerlink" title="ç›®å½• Table of Contents"></a><strong>ç›®å½• Table of Contents</strong></h1><!-- toc --><hr><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a><strong>UML</strong></h2><h3 id="ç”¨ä¾‹å›¾"><a href="#ç”¨ä¾‹å›¾" class="headerlink" title="ç”¨ä¾‹å›¾"></a>ç”¨ä¾‹å›¾</h3><ul><li><u>ç”¨ä¾‹å›¾</u>ä¸€èˆ¬ç”±<strong>å‚ä¸è€…ã€ç”¨ä¾‹ã€ç³»ç»Ÿè¾¹ç•Œå’Œå…³ç³»</strong>æ„æˆã€‚</li></ul><table><thead><tr><th align="center">å…³ç³»ç±»å‹</th><th>å…ƒç´ </th><th align="center">è¯´æ˜</th><th align="center">æ¡ä»¶æ€§</th><th align="center">ç›´æ¥æ€§</th><th align="center">ç®­å¤´æŒ‡å‘</th></tr></thead><tbody><tr><td align="center">å…³è”</td><td>å‚ä¸è€…ä¸ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»</td><td align="center">å‚ä¸è€…å’Œç”¨ä¾‹é€šä¿¡</td><td align="center">-</td><td align="center">-</td><td align="center">å‘é€æ–¹æŒ‡å‘æ¥å—æ–¹</td></tr><tr><td align="center">æ³›åŒ–</td><td>å‚ä¸è€…ä¹‹é—´æˆ–ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»</td><td align="center">å­å…ƒç´ ç»§æ‰¿çˆ¶å…ƒç´ </td><td align="center">æ— </td><td align="center">ç›´æ¥</td><td align="center">å­å…ƒç´ æŒ‡å‘çˆ¶å…ƒç´ </td></tr><tr><td align="center">åŒ…å«</td><td>ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»</td><td align="center">å¤æ‚ç”¨ä¾‹æ‹†æˆç®€å•ç”¨ä¾‹</td><td align="center">æ— </td><td align="center">é—´æ¥</td><td align="center">å¤æ‚ç”¨ä¾‹æŒ‡å‘ç®€å•ç”¨ä¾‹</td></tr><tr><td align="center">æ‰©å±•</td><td>ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»</td><td align="center">åŸºç¡€ç”¨ä¾‹å¢åŠ é™„åŠ ç”¨ä¾‹</td><td align="center">æœ‰</td><td align="center">ç›´æ¥</td><td align="center">åŸºç¡€ç”¨ä¾‹æŒ‡å‘é™„åŠ ç”¨ä¾‹</td></tr></tbody></table><h3 id="ç”¨ä¾‹è¡¨"><a href="#ç”¨ä¾‹è¡¨" class="headerlink" title="ç”¨ä¾‹è¡¨"></a>ç”¨ä¾‹è¡¨</h3><ul><li><u>ç”¨ä¾‹è¡¨</u>ä¸€èˆ¬ç”±<strong>ç”¨ä¾‹ç¼–å·ã€ç”¨ä¾‹åç§°ã€å‚ä¸è€…ã€ç”¨ä¾‹æè¿°ã€å‰ç½®æ¡ä»¶ã€åç½®æ¡ä»¶ã€æ­£å¸¸æµç¨‹å’Œå¼‚å¸¸æµç¨‹</strong>æ„æˆã€‚</li></ul><table><thead><tr><th align="center">æ¡ç›®</th><th align="center">å†…å®¹</th></tr></thead><tbody><tr><td align="center">ç”¨ä¾‹ç¼–å·</td><td align="center"><code>[æ•°å­—]</code></td></tr><tr><td align="center">ç”¨ä¾‹åç§°</td><td align="center"><code>[åŠ¨å®¾ç»“æ„]</code></td></tr><tr><td align="center">å‚ä¸è€…</td><td align="center"><code>[ä¸»è¯­]</code></td></tr><tr><td align="center">ç”¨ä¾‹æè¿°</td><td align="center"><code>[ç›¸äº’ç‹¬ç«‹ï¼›å¯ä»¥è§‚æµ‹]</code></td></tr><tr><td align="center">å‰ç½®æ¡ä»¶</td><td align="center"><code>[åˆ†ç‚¹è¯´æ˜]</code></td></tr><tr><td align="center">åç½®æ¡ä»¶</td><td align="center"><code>[åˆ†ç‚¹è¯´æ˜]</code></td></tr><tr><td align="center">æ­£å¸¸æµç¨‹</td><td align="center"><code>[æ­£å¸¸æ“ä½œâ†’æ­£å¸¸ç»“æœ]</code></td></tr><tr><td align="center">å¼‚å¸¸æµç¨‹</td><td align="center"><code>[å¼‚å¸¸æ“ä½œâ†’å¼‚å¸¸ç»“æœ]</code></td></tr></tbody></table><h2 id="åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ"><a href="#åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ" class="headerlink" title="åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ"></a><strong>åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ</strong></h2><h3 id="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—ç”¨ä¾‹"><a href="#å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—ç”¨ä¾‹" class="headerlink" title="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—ç”¨ä¾‹"></a>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—ç”¨ä¾‹</h3><ul><li>ä¸‹å›¾ä¸º<u>å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—çš„ç”¨ä¾‹å›¾</u>ï¼Œå…¶å±•ç¤ºäº†åœ¨ç®¡ç†æ¨¡å—ä¸­ï¼Œç®¡ç†å‘˜ç”¨æˆ·ä½œä¸ºå‚ä¸è€…ä¸ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»ä»¥åŠä¸»ç”¨ä¾‹å’Œå­ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»ã€‚æ ¹æ®åˆ†æï¼Œç®¡ç†æ¨¡å—å…±æœ‰6ä¸ªä¸»è¦çš„ç”¨ä¾‹ï¼Œåˆ†åˆ«ä¸º<strong>ç”¨æˆ·ç™»å½•ã€ç”¨æˆ·ç™»å‡ºã€ç®¡ç†ç”¨æˆ·ã€ç®¡ç†æœåŠ¡ã€ç®¡ç†åº”ç”¨å’Œæ•°æ®ç»Ÿè®¡</strong>ã€‚</li></ul><p><img src="/images/admin_use_case.png" alt="å¾®æœåŠ¡APIç½‘å…³ç®¡ç†æ¨¡å—ç”¨ä¾‹å›¾"></p><h3 id="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”¨ä¾‹"><a href="#å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”¨ä¾‹" class="headerlink" title="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”¨ä¾‹"></a>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”¨ä¾‹</h3><ul><li>ä¸‹å›¾ä¸º<u>å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—çš„ç”¨ä¾‹å›¾</u>ï¼Œå…¶å±•ç¤ºäº†åœ¨æ ¸å¿ƒæ¨¡å—ä¸­ï¼Œæ™®é€šç”¨æˆ·ä½œä¸ºå‚ä¸è€…ä¸ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»ä»¥åŠä¸»ç”¨ä¾‹å’Œå­ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»ã€‚æ ¹æ®åˆ†æï¼Œæ ¸å¿ƒæ¨¡å—å…±æœ‰7ä¸ªä¸»è¦çš„ç”¨ä¾‹ï¼Œåˆ†åˆ«ä¸º<strong>åè®®æ¥å…¥ã€æƒé™è®¤è¯ã€æµé‡ç»Ÿè®¡ã€æµé‡æ§åˆ¶ã€è¯·æ±‚é‡å†™ã€è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†</strong>ã€‚</li></ul><p><img src="/images/core_use_case.png" alt="å¾®æœåŠ¡APIç½‘å…³æ ¸å¿ƒæ¨¡å—ç”¨ä¾‹å›¾"></p><h2 id="éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ"><a href="#éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ" class="headerlink" title="éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ"></a><strong>éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ</strong></h2><hr><h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><ul><li><strong>å¯¹äºç”¨æˆ·æ“ä½œè€Œè¨€</strong>ï¼šåº”ç”¨å£ä»¤å®‰å…¨è¦æ±‚å’Œä¼šè¯è¶…æ—¶æœºåˆ¶</li><li><strong>å¯¹äºè¯·æ±‚è®¿é—®è€Œè¨€</strong>ï¼šè®¾ç½® <code>JWT</code> æ ¡éªŒå’Œ <code>IP</code> æ ¡éªŒ</li><li><strong>å¯¹äºæ•°æ®ä¼ è¾“è€Œè¨€</strong>ï¼šå¯åŠ¨ <code>HTTPS</code> ç›‘å¬</li><li><strong>å¯¹äºæ•°æ®ä¿å­˜è€Œè¨€</strong>ï¼šæ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç›å€¼åŠ å¯†å¹¶ä»¥å¯†æ–‡æ–¹å¼å…¥åº“</li></ul><h3 id="é«˜æ€§èƒ½"><a href="#é«˜æ€§èƒ½" class="headerlink" title="é«˜æ€§èƒ½"></a>é«˜æ€§èƒ½</h3><ul><li>é€‰ç”¨æ€§èƒ½è¡¨ç°ä¼˜ç§€ã€åŠŸèƒ½æ”¯æŒé½å…¨çš„æ¡†æ¶ <code>Gin</code></li><li>å…ˆè®¿é—®ç¼“å­˜ <code>Redis</code> ä»£æ›¿ç›´æ¥è®¿é—®æ•°æ®åº“ <code>MySQL</code></li></ul><h3 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h3><ul><li><strong>æ•…éšœæ—¶ä»ç¨³å®šæœåŠ¡</strong>ï¼šè¿›è¡Œå¤šå®ä¾‹éƒ¨ç½²ï¼Œå‘¨æœŸæ¢æ´»å¹¶æ•…éšœé‡å¯</li><li><strong>å®¹æ˜“æ¨ªå‘æ‰©å±•å®ä¾‹</strong>ï¼šå¼¹æ€§ä¼¸ç¼©&amp;&amp;è´Ÿè½½å‡è¡¡</li></ul><h3 id="æ˜“ç”¨æ€§"><a href="#æ˜“ç”¨æ€§" class="headerlink" title="æ˜“ç”¨æ€§"></a>æ˜“ç”¨æ€§</h3><ul><li>ç»Ÿä¸€çš„ <code>RESTful API</code> æ¥å£</li><li>ç›´è§‚çš„ <code>Vue-Element-Admin</code> ç•Œé¢ </li></ul><h2 id="FAQs"><a href="#FAQs" class="headerlink" title="FAQs"></a><strong>FAQs</strong></h2><blockquote><p><strong>Qï¼š</strong>å¦‚ä½•æ§åˆ¶ç”¨ä¾‹çš„ç²’åº¦å‘¢ï¼Ÿ</p><p><strong>Aï¼š</strong>å‚è€ƒ<a href="https://www.cnblogs.com/HeroBeast/archive/2009/09/27/1575094.html" target="_blank" rel="noopener">ç”¨ä¾‹çš„ç±»å‹ä¸ç²’åº¦</a></p></blockquote><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a><strong>Refs</strong></h2><ul><li><a href="https://www.cnblogs.com/Yogurshine/archive/2013/01/14/2859248.html" target="_blank" rel="noopener">UMLç³»åˆ—-ç”¨ä¾‹å›¾</a></li><li><a href="https://www.jianshu.com/p/7ff70e28bb72" target="_blank" rel="noopener">è°ˆè°ˆéœ€æ±‚çš„æè¿°-ç”¨ä¾‹</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»&lt;u&gt;å¾®æœåŠ¡APIç½‘å…³&lt;/u&gt;çš„&lt;strong&gt;éœ€æ±‚åˆ†æ&lt;/strong&gt;ï¼Œåˆ†ä¸º&lt;strong&gt;ä¸¤ä¸ª&lt;/strong&gt;æ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ - &lt;strong&gt;ç”¨ä¾‹å›¾å’Œç”¨ä¾‹è¡¨&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Microservice" scheme="http://yoursite.com/categories/Microservice/"/>
    
    
    <category term="Microservice" scheme="http://yoursite.com/tags/Microservice/"/>
    
  </entry>
  
  <entry>
    <title>#Grpc# æ€ç»´å¯¼å›¾ï¼šGrpc Rpc Framework</title>
    <link href="http://yoursite.com/2021/05/04/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BGrpc/"/>
    <id>http://yoursite.com/2021/05/04/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E4%B9%8BGrpc/</id>
    <published>2021-05-03T23:00:21.000Z</published>
    <updated>2021-07-25T15:09:11.684Z</updated>
    
    <content type="html"><![CDATA[<p>å¤‡ä»½è®°å½• <code>Grpc</code> çš„<strong>æ€ç»´å¯¼å›¾</strong>å’Œ<strong>ç›¸å…³æ–‡æ¡£</strong>ã€‚</p><hr><a id="more"></a><h1 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a><strong>æ€ç»´å¯¼å›¾</strong></h1><p><img src="/images/Grpc.png" alt="Grpc Mindmap"></p><p><img src="/images/grpc_rest_gateway.png" alt="ç½‘å…³ç»“æ„å›¾ç¤º"></p><h1 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a><strong>ç›¸å…³æ–‡æ¡£</strong></h1><ul><li><a href="http://www.topgoer.com/%E5%BE%AE%E6%9C%8D%E5%8A%A1/gRPC/" target="_blank" rel="noopener">gRPC</a></li></ul><hr>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¤‡ä»½è®°å½• &lt;code&gt;Grpc&lt;/code&gt; çš„&lt;strong&gt;æ€ç»´å¯¼å›¾&lt;/strong&gt;å’Œ&lt;strong&gt;ç›¸å…³æ–‡æ¡£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;</summary>
    
    
    
    <category term="Mind Map" scheme="http://yoursite.com/categories/Mind-Map/"/>
    
    
    <category term="Golang" scheme="http://yoursite.com/tags/Golang/"/>
    
    <category term="Grpc" scheme="http://yoursite.com/tags/Grpc/"/>
    
  </entry>
  
</feed>
